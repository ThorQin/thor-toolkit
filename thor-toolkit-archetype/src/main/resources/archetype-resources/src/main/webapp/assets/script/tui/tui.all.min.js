var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());if(typeof Array.prototype.indexOf!=="function"){Array.prototype.indexOf=function(a,c){var d=(typeof c==="number"?c:0);for(var b=d;b<this.length;b++){if(this[b]===a){return b}}return -1}}var tui;(function(n){n.KEY_BACK=8;n.KEY_TAB=9;n.KEY_ENTER=13;n.KEY_SHIFT=16;n.KEY_CTRL=17;n.KEY_ALT=18;n.KEY_PAUSE=19;n.KEY_CAPS=20;n.KEY_ESC=27;n.KEY_SPACE=32;n.KEY_PRIOR=33;n.KEY_NEXT=34;n.KEY_END=35;n.KEY_HOME=36;n.KEY_LEFT=37;n.KEY_UP=38;n.KEY_RIGHT=39;n.KEY_DOWN=40;n.KEY_PRINT=44;n.KEY_INSERT=45;n.KEY_DELETE=46;n.CONTROL_KEYS={9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"Caps",27:"Escape",33:"Prior",34:"Next",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12"};n.undef=(function(Z){return typeof Z})();n.undefVal=(function(Z){return Z})();n.lang=(function(){return(navigator.language||navigator.browserLanguage||navigator.userLanguage).toLowerCase()})();var S={};function O(aa,Z){if(typeof Z==="function"){S[aa]=Z}else{if(typeof Z==="object"&&Z!==null){S[aa]=function(ab){return Z[ab]||ab}}}}n.registerTranslator=O;function G(ab,aa){if(!aa){if(!n.lang){return ab}else{aa=n.lang}}var Z=S[aa];if(typeof Z==="function"){return Z(ab)}else{return ab}}n.str=G;n.uuid=(function(){var Z=0;return function(){var aa="tuid"+Z++;return aa}})();var T=(function(){function Z(){this._events={}}Z.prototype.bind=function(ab,ae,ad){if(!ab){return}if(!this._events[ab]){this._events[ab]=[]}var aa=this._events[ab];for(var ac=0;ac<aa.length;ac++){if(aa[ac]===ae){return}}if(ad){aa.push(ae)}else{aa.splice(0,0,ae)}};Z.prototype.unbind=function(ab,ad){if(!ab){return}var aa=this._events[ab];if(ad){for(var ac=0;ac<aa.length;ac++){if(ad===aa[ac]){aa.splice(ac,1);return}}}else{aa.length=0}};Z.prototype.on=function(ab,af,ae){if(ae===void 0){ae=false}var ad=ab.split(/\s+/);for(var ac=0;ac<ad.length;ac++){var aa=ad[ac];this.bind(aa,af,ae)}};Z.prototype.once=function(aa,ac,ab){if(ab===void 0){ab=false}ac.isOnce=true;this.on(aa,ac,ab)};Z.prototype.off=function(ab,ae){var ad=ab.split(/\s+/);for(var ac=0;ac<ad.length;ac++){var aa=ad[ac];this.unbind(aa,ae)}};Z.prototype.fire=function(ab,af){var ah=this._events[ab];if(!ah){return}var ae=null;if(af){ae=af;ae.name=ab}else{ae={name:ab}}var aa=[];for(var ac=0;ac<ah.length;ac++){var ad=ah[ac];if(ad.isOnce){aa.push(ad)}var ag=ad.call(this,ae);if(typeof ag==="boolean"&&!ag){return false}}for(var ac=0;ac<aa.length;ac++){this.off(ab,aa[ac])}};return Z})();n.EventObject=T;var X=new T();function F(Z,ab,aa){if(aa===void 0){aa=false}X.on(Z,ab,aa)}n.on=F;function x(Z,ab,aa){if(aa===void 0){aa=false}X.once(Z,ab,aa)}n.once=x;function Q(Z,aa){X.off(Z,aa)}n.off=Q;function v(Z,aa){return T.prototype.fire.call(X,Z,aa)}n.fire=v;function h(Z){if(typeof Z===n.undef){return false}switch(String(Z).toLowerCase()){case"true":case"1":case"yes":case"y":return true;default:return false}}n.parseBoolean=h;function p(aa,Z){if(Z===void 0){Z=false}var ac=document.createElement("div");ac.innerHTML=$.trim(aa);if(Z){return ac}var ab=ac.firstChild;return ac.removeChild(ab)}n.toElement=p;function l(Z){Z.parentNode&&Z.parentNode.removeChild(Z)}n.removeNode=l;function R(ab,ac){if(typeof ab==="string"){ab=document.getElementById(ab)}if(ab){if(typeof ac!=="undefined"){ab.innerHTML="";ab.appendChild(document.createTextNode(ac));return ac}if(typeof ab.textContent!=="undefined"){return ab.textContent}var Z="";for(var aa=0;aa<ab.childNodes.length;aa++){var ad=ab.childNodes[aa];if(ad.nodeName.toLowerCase()==="#text"){Z+=ad.nodeValue}else{Z+=R(ad)}}return Z}else{return null}}n.elementText=R;function j(aa,ab){if(!ab.nodeName&&!ab.tagName){throw new Error("Offset parent must be an html element.")}var Z={x:aa.offsetLeft,y:aa.offsetTop};var ac=aa.offsetParent;while(ac){if(ac===ab){return Z}Z.x+=((ac.offsetLeft||0)+(ac.clientLeft||0)-(ac.scrollLeft||0));Z.y+=((ac.offsetTop||0)+(ac.clientTop||0)-(ac.scrollTop||0));if(ac.nodeName.toLowerCase()==="body"&&ac.offsetParent===null){ac=ac.parentElement}else{ac=ac.offsetParent}}return null}n.relativePosition=j;function m(aa){var Z=$(aa);var ab=Z.offset();var ac=$(document);return{x:ab.left-ac.scrollLeft(),y:ab.top-ac.scrollTop()}}n.fixedPosition=m;function s(Z){$(Z).mousedown(function(ab){var ac=n.fixedPosition(this);var aa=document.createElement("span");aa.style.backgroundColor="#ccc";aa.style.opacity="0.5";aa.style.display="inline-block";aa.style.position="fixed";aa.style.left=ac.x+"px";aa.style.top=ac.y+"px";aa.style.width=this.offsetWidth+"px";aa.style.height=this.offsetHeight+"px";document.body.appendChild(aa);$(aa).mouseup(function(ad){document.body.removeChild(aa)})})}n.debugElementPosition=s;function a(){var ab=document.createElement("div");ab.style.display="block";ab.style.position="fixed";ab.style.left="0";ab.style.top="0";ab.style.right="0";ab.style.bottom="0";ab.style.visibility="hidden";var aa=document.body||document.documentElement;aa.appendChild(ab);var Z={width:ab.offsetWidth,height:ab.offsetHeight};aa.removeChild(ab);return Z}n.windowSize=a;function J(){return top.document.body||top.document.getElementsByTagName("BODY")[0]}n.getTopBody=J;function r(Z){return Z.ownerDocument.defaultView||Z.ownerDocument.parentWindow}n.getWindow=r;function t(ad,ac){if(ad===null){return null}else{if(typeof ad===n.undef){return undefined}else{if(ad instanceof Array){var aa=[];for(var Z in ad){if(ad.hasOwnProperty(Z)&&ac.indexOf(Z)<0){aa.push(t(ad[Z],ac))}}return aa}else{if(typeof ad==="number"){return ad}else{if(typeof ad==="string"){return ad}else{if(typeof ad==="boolean"){return ad}else{if(typeof ad==="function"){return ad}else{var ab={};for(var Z in ad){if(ad.hasOwnProperty(Z)&&ac.indexOf(Z)<0){ab[Z]=t(ad[Z],ac)}}return ab}}}}}}}}function u(aa,Z){if(typeof Z==="string"&&$.trim(Z).length>0){return t(aa,[Z])}else{if(Z instanceof Array){return t(aa,Z)}else{return JSON.parse(JSON.stringify(aa))}}}n.clone=u;function P(aa){var Z=(typeof aa.which!=="undefined")?aa.which:aa.button;if(Z==1){return true}else{return false}}n.isLButton=P;function e(){function Z(ah){var ae=ah||window.event;var ag=ae.target||ae.srcElement;var ad=ag.type||ag.getAttribute("type");var af=ag.readOnly;var ac=ag.disabled;af=(typeof af===n.undef)?false:af;ac=(typeof ac===n.undef)?true:ac;var ab=ae.keyCode===8&&(ad==="password"||ad==="text"||ad==="textarea")&&(af||ac);var aa=ae.keyCode===8&&ad!=="password"&&ad!=="text"&&ad!=="textarea";if(aa||ab){return false}}$(document).bind("keypress",Z);$(document).bind("keydown",Z)}n.banBackspace=e;function V(Z){if(Z.preventDefault){Z.preventDefault()}else{Z.returnValue=false}return false}n.cancelDefault=V;function y(Z){if(Z&&Z.stopPropagation){Z.stopPropagation()}else{window.event.cancelBubble=true}return false}n.cancelBubble=y;function W(aa,Z){while(aa){if(aa===Z){return true}else{aa=aa.parentNode}}return false}n.isAncestry=W;function B(Z,aa){return W(aa,Z)}n.isPosterity=B;function f(aa,Z){var ab=Z.target||Z.srcElement;return B(aa,ab)}n.isFireInside=f;function I(Z){var aa=Z;while(aa){if(aa.nodeName.toUpperCase()==="HTML"){return true}aa=aa.parentElement}return false}n.isInDoc=I;function C(aa){var ac=[];for(var ab=1;ab<arguments.length;ab++){ac[ab-1]=arguments[ab]}var Z=/\{(\d+)\}/g;aa&&(typeof aa==="string")&&ac.length&&(aa=aa.replace(Z,function(ae,ad){return ac[ad]===null?"":ac[ad]}));return aa?aa:""}n.format=C;function o(ab,ac,aa,ad){if(ad===void 0){ad=false}var Z=Math.abs(ab)+"";while(Z.length<ac){Z="0"+Z}if(typeof aa==="number"&&Z.length>aa){if(ad){Z=Z.substr(0,aa)}else{Z=Z.substr(Z.length-aa,aa)}}if(ab<0){Z="-"+Z}return Z}n.paddingNumber=o;function d(Z,ab){ab=ab.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var ac=new RegExp("[\\?&]"+ab+"=([^&#]*)"),aa=ac.exec(Z);return aa===null?null:decodeURIComponent(aa[1].replace(/\+/g," "))}n.getParam=d;function L(aa){var Z=location.href.match("(#.+)(?:\\?.*)?");if(Z){Z=Z[1]}return Z}n.getAnchor=L;var H=(function(){function Z(ab){this.backupInfo=[];var aa=ab;while(aa&&aa!==document.body){aa=aa.parentElement;if(aa){this.backupInfo.push({obj:aa,left:aa.scrollLeft,top:aa.scrollTop})}}}Z.prototype.restore=function(){for(var aa=0;aa<this.backupInfo.length;aa++){var ab=this.backupInfo[aa];ab.obj.scrollLeft=ab.left;ab.obj.scrollTop=ab.top}};return Z})();n.BackupedScrollPosition=H;function i(Z){return new H(Z)}n.backupScrollPosition=i;function E(Z){setTimeout(function(){if(n.ieVer>0){Z.setActive()}else{if(n.ffVer>0){Z.focus()}else{var aa=n.backupScrollPosition(Z);Z.focus();aa.restore()}}},0)}n.focusWithoutScroll=E;function A(aa){var ab=aa;while(ab){var Z=ab.offsetParent;$(Z).animate({scrollTop:$(ab).offset().top},200);ab=Z}}n.scrollToElement=A;n.ieVer=(function(){var ab=-1;if(navigator.appName==="Microsoft Internet Explorer"||navigator.appName==="Netscape"){var Z=navigator.userAgent;var aa=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(aa.exec(Z)!==null){ab=parseFloat(RegExp.$1)}}if(ab===-1&&navigator.appName==="Netscape"){var Z=navigator.userAgent;var aa=new RegExp("Trident/([0-9]{1,}[.0-9]{0,})");if(aa.exec(Z)!==null){ab=parseFloat(RegExp.$1)}if(ab>=7){ab=11}}return ab})();n.ffVer=(function(){var ab=-1;if(navigator.appName==="Netscape"){var Z=navigator.userAgent;var aa=new RegExp("Firefox/([0-9]{1,}[.0-9]{0,})");if(aa.exec(Z)!==null){ab=parseFloat(RegExp.$1)}}return ab})();function N(ab,ad,Z,ag,ac,af){if(af===void 0){af=false}var aa=new Date();aa.setTime(aa.getTime());if(Z){Z=Z*1000*60*60*24}var ae=new Date(aa.getTime()+(Z));document.cookie=ab+"="+encodeURIComponent(JSON.stringify(ad))+((Z)?";expires="+ae.toUTCString():"")+((ag)?";path="+ag:"")+((ac)?";domain="+ac:"")+((af)?";secure":"")}n.saveCookie=N;function D(aa){var Z=document.cookie.match(new RegExp("(^| )"+aa+"=([^;]*)(;|$)"));if(Z!==null){return JSON.parse(decodeURIComponent(Z[2]))}else{return null}}n.loadCookie=D;function U(Z,ab,aa){if(D(Z)){document.cookie=Z+"="+((ab)?";path="+ab:"")+((aa)?";domain="+aa:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"}}n.deleteCookie=U;function q(aa,ab,Z){if(Z===void 0){Z=false}try{var ad=(Z===true?window.sessionStorage:window.localStorage);if(ad){ad.setItem(aa,JSON.stringify(ab))}else{N(aa,ab,365)}}catch(ac){}}n.saveData=q;function k(aa,Z){if(Z===void 0){Z=false}try{var ac=(Z===true?window.sessionStorage:window.localStorage);if(ac){return JSON.parse(ac.getItem(aa))}else{return D(aa)}}catch(ab){return null}}n.loadData=k;function z(aa,Z){if(Z===void 0){Z=false}try{var ac=(Z===true?window.sessionStorage:window.localStorage);if(ac){ac.removeItem(aa)}else{U(aa)}}catch(ab){}}n.deleteData=z;function g(){if(n.ieVer>0||n.ffVer>0){return window.document.documentElement}else{return window.document.body}}n.windowScrollElement=g;function K(Z,ac,aa,ad,ab){if(aa===void 0){aa=true}ad=ad?ad:"GET";$.ajax({type:ad,url:Z,async:aa,contentType:"application/json",data:(ad==="GET"?ab:JSON.stringify(ab)),complete:function(af,ae){if(typeof ac==="function"&&ac(ae,af)===false){return}},processData:(ad==="GET"?true:false)})}n.loadURL=K;var c={};var M={8:"Back",9:"Tab",13:"Enter",19:"Pause",20:"Caps",27:"Escape",32:"Space",33:"Prior",34:"Next",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"~",219:"[",220:"\\",221:"]",222:"'"};function b(ad){var aa=M[ad.keyCode];if(!aa){return}aa=aa.toUpperCase();var ac=(ad.ctrlKey?"CTRL":"");if(ad.altKey){if(ac.length>0){ac+="+"}ac+="ALT"}if(ad.shiftKey){if(ac.length>0){ac+="+"}ac+="SHIFT"}if(ad.metaKey){if(ac.length>0){ac+="+"}ac+="META"}if(ac.length>0){ac+="+"}ac+=aa;var Z=c[ac];if(Z){for(var ab=0;ab<Z.length;ab++){if(n.fire(Z[ab],{name:Z[ab],event:ad})===false){return}}}}function Y(aa,ab){aa=aa.toUpperCase();var Z=null;if(c.hasOwnProperty(aa)){Z=c[aa]}else{Z=[];c[aa]=Z}if(Z.indexOf(ab)<0){Z.push(ab)}}n.addAccelerate=Y;function w(aa,ac){aa=aa.toUpperCase();if(!c.hasOwnProperty(aa)){return}var Z=c[aa];var ab=Z.indexOf(ac);if(ab>=0){Z.splice(ab,1);if(Z.length<=0){delete c[aa]}}}n.deleteAccelerate=w;$(document).keydown(b)})(tui||(tui={}));var tui;(function(n){var g=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];var a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var c=["January","February","March","April","May","June","July","August","September","October","November","December"];function i(){return new Date()}n.today=i;function j(y,o){var v=["day","hour","minute","second"];var p=[];var x="",r="";var w=Math.floor(y/86400);p.push(w);y=y%86400;var u=Math.floor(y/3600);p.push(u);y=y%3600;var q=Math.floor(y/60);p.push(q);p.push(y%60);var t=0,s=3;while(t<4){if(p[t]>0){x.length&&(x+=" ");x+=p[t]+" "+n.str(p[t]>1?v[t]+"s":v[t],o);break}t++}while(t<s){if(p[s]>0){r.length&&(r+=" ");r+=p[s]+" "+n.str(p[s]>1?v[s]+"s":v[s],o);break}s--}t++;while(t<s){x.length&&(x+=" ");x+=p[t]+" "+n.str(p[t]>1?v[t]+"s":v[t],o);t++}return x+(x.length?" ":"")+r}n.timespan=j;function h(p,o,r){if(r===void 0){r="d"}var t=p.getTime();var q=o.getTime();var u=q-t;var s=u<0?-1:1;u=Math.abs(u);r=r.toLocaleLowerCase();if(r==="d"){return Math.floor(u/86400000)*s}else{if(r==="h"){return Math.floor(u/3600000)*s}else{if(r==="m"){return Math.floor(u/60000)*s}else{if(r==="s"){return Math.floor(u/1000)*s}else{if(r==="ms"){return u*s}else{return NaN}}}}}}n.dateDiff=h;function f(p,r,o){if(o===void 0){o="d"}var q=p.getTime();if(o==="d"){return new Date(q+r*86400000)}else{if(o==="h"){return new Date(q+r*3600000)}else{if(o==="m"){return new Date(q+r*60000)}else{if(o==="s"){return new Date(q+r*1000)}else{if(o==="ms"){return new Date(q+r)}else{return null}}}}}}n.dateAdd=f;function k(o){var q=o.getFullYear();var p=new Date(q,0,1);return h(p,o,"d")}n.dayOfYear=k;function d(q){var s=q.getFullYear();var o=q.getMonth();var r=new Date(s,o,1);if(o===11){s++;o=0}else{o++}var p=new Date(s,o,1);return h(r,p,"d")}n.totalDaysOfMonth=d;function l(N,G){if(!N||!G){return null}var x={};var M=0;var p=false;var o={};function F(P,Q,R){var O=N.match(new RegExp("^"+R.join("|"),"i"));if(O===null){return false}P=O[0].toLowerCase();P=P.substr(0,1).toUpperCase()+P.substr(1);o[Q]=R.indexOf(P);N=N.substr(P.length);return true}function D(R,U,T,Q){var P=R.length;var O=N.match("^[0-9]{1,"+P+"}");if(O===null){return false}R=O[0];var S=parseInt(R);if(S<T||S>Q){return false}U&&(o[U]=S);N=N.substr(R.length);return true}var u={"y+":function(O){if(!D(O,"year")){return false}if(o.year<100){o.year+=1900}return true},"M+":function(P){var O=P.length;if(O<3){if(!D(P,"month",1,12)){return false}o.month-=1;return true}else{if(O===3){return F(P,"month",e)}else{return F(P,"month",c)}}},"d+":function(O){return D(O,"date",1,31)},"D+":D,"h+":function(O){return D(O,"12hour",1,12)},"H+":function(O){return D(O,"hour",0,24)},"m+":function(O){return D(O,"minute",0,59)},"s+":function(O){return D(O,"second",0,59)},"[qQ]+":function(O){return D(O,null,1,4)},"S+":function(O){return D(O,"millisecond",0,999)},"E+":function(P){var O=P.length;if(O<3){if(!D(P,null,0,6)){return false}return true}else{if(O===3){return F(P,null,g)}else{return F(P,null,a)}}},"a|A":function D(Q){var P=Q.length;var O=N.match(/^(am|pm)/i);if(O===null){return false}Q=O[0];o.ampm=Q.toLowerCase();N=N.substr(Q.length);return true},"z+":function(Q){var P=Q.length;var O;if(P<=2){O=N.match(/^([\-+][0-9]{2})/i)}else{if(P===3){O=N.match(/^([\-+][0-9]{2})([0-9]{2})/i)}else{O=N.match(/^([\-+][0-9]{2}):([0-9]{2})/i)}}if(O===null){return false}Q=O[0];var R=parseInt(O[1]);if(Math.abs(R)<-11||Math.abs(R)>11){return false}R*=60;if(typeof O[2]!==n.undef){if(R>0){R+=parseInt(O[2])}else{R-=parseInt(O[2])}}o.tz=-R;N=N.substr(Q.length);return true},Z:function(O){if(N.substr(0,1)!=="Z"){return false}p=true;N=N.substr(1);return true},"\"[^\"]*\"|'[^']*'":function(O){O=O.substr(1,O.length-2);if(N.substr(0,O.length).toLowerCase()!==O.toLowerCase()){return false}N=N.substr(O.length);return true},"[^yMmdDhHsSqEaAzZ'\"]+":function(P){P=P.replace(/(.)/g,"\\$1");var O=N.match(new RegExp("^"+P));if(O===null){return false}P=O[0];N=N.substr(P.length);return true}};var s="";for(var E in u){if(!u.hasOwnProperty(E)){continue}if(s.length>0){s+="|"}s+="(^"+E+")";x[E]=++M}var y;while((y=G.match(s))!==null){for(var E in x){var z=y[x[E]];if(typeof z!==n.undef){if(u[E](z)===false){return null}break}}G=G.substr(y[0].length)}if(G.length>0||N.length>0){return null}var w=0;for(var E in o){if(!o.hasOwnProperty(E)){continue}w++}if(w<=0){return null}var q=new Date();var A=o.hasOwnProperty("year")?o.year:(p?q.getUTCFullYear():q.getFullYear());var L=o.hasOwnProperty("month")?o.month:(p?q.getUTCMonth():q.getMonth());var I=o.hasOwnProperty("date")?o.date:(p?q.getUTCDate():q.getDate());var B=o.hasOwnProperty("ampm")?o.ampm:"am";var t;if(o.hasOwnProperty("hour")){t=o.hour}else{if(o.hasOwnProperty("12hour")){var r=o["12hour"];if(B==="am"){if(r>=1&&r<=11){t=r}else{if(r===12){t=r-12}else{return null}}}else{if(r===12){t=r}else{if(r>=1&&r<=11){t=r+12}else{return null}}}}else{t=0}}var C=o.hasOwnProperty("minute")?o.minute:0;var K=o.hasOwnProperty("second")?o.second:0;var J=o.hasOwnProperty("millisecond")?o.millisecond:0;var H=o.hasOwnProperty("tz")?o.tz:q.getTimezoneOffset();q.setUTCFullYear(A);q.setUTCMonth(L);q.setUTCDate(I);q.setUTCHours(t);q.setUTCMinutes(C);q.setUTCSeconds(K);q.setUTCMilliseconds(J);if(!p){q.setTime(q.getTime()+H*60*1000)}return q}function b(o,q){if(typeof q==="string"){return l(o,q)}else{if(typeof q===n.undef){var p=new Date(o);if(!isNaN(p.getTime())){return p}p=l(o,"yyyy-MM-dd");if(p!==null){return p}p=l(o,"yyyy-MM-dd HH:mm:ss");if(p!==null){return p}p=l(o,"MMM dd, yyyy HH:mm:ss");if(p!==null){return p}p=l(o,"MMM dd, yyyy");if(p!==null){return p}p=l(o,"dd MMM yyyy HH:mm:ss");if(p!==null){return p}p=l(o,"dd MMM yyyy");if(p!==null){return p}}}return null}n.parseDate=b;function m(o,z){if(z===void 0){z="yyyy-MM-ddTHH:mm:sszzz"}var p=(z.indexOf("Z")>=0?true:false);var C=p?o.getUTCFullYear():o.getFullYear();var u=p?o.getUTCMonth():o.getMonth();var q=p?o.getUTCDate():o.getDate();var A=p?o.getUTCHours():o.getHours();var t=p?o.getUTCMinutes():o.getMinutes();var B=p?o.getUTCSeconds():o.getSeconds();var r=p?o.getUTCMilliseconds():o.getMilliseconds();var x=p?o.getUTCDay():o.getDay();var w={"y+":C,"M+":u+1,"d+":q,"D+":k(o)+1,"h+":(function(D){if(D===0){return D+12}else{if(D>=1&&D<=12){return D}else{if(D>=13&&D<=23){return D-12}}}})(A),"H+":A,"m+":t,"s+":B,"q+":Math.floor((u+3)/3),"S+":r,"E+":x,a:(function(D){if(D>=0&&D<=11){return"am"}else{return"pm"}})(p?o.getUTCHours():o.getHours()),A:(function(D){if(D>=0&&D<=11){return"AM"}else{return"PM"}})(A),"z+":o.getTimezoneOffset()};var y="";for(var s in w){if(!w.hasOwnProperty(s)){continue}if(y.length>0){y+="|"}y+=s}var v=new RegExp(y,"g");return z.replace(v,function(G,H,E){for(var D in w){if(G.match(D)!==null){if(D==="y+"){return n.paddingNumber(w[D],G.length,G.length)}else{if(D==="a"||D==="A"){return w[D]}else{if(D==="z+"){var F="";if(w[D]>=0){F+="-"}else{F+="+"}if(G.length<2){F+=Math.abs(Math.floor(w[D]/60))}else{F+=n.paddingNumber(Math.abs(Math.floor(w[D]/60)),2)}if(G.length===3){F+=n.paddingNumber(Math.abs(Math.floor(w[D]%60)),2)}else{if(G.length>3){F+=(":"+n.paddingNumber(Math.abs(Math.floor(w[D]%60)),2))}}return F}else{if(D==="E+"){if(G.length<3){return n.paddingNumber(w[D],G.length)}else{if(G.length===3){return g[w[D]]}else{return a[w[D]]}}}else{if(D==="M+"){if(G.length<3){return n.paddingNumber(w[D],G.length)}else{if(G.length===3){return e[w[D]-1]}else{return c[w[D]-1]}}}else{if(D==="S+"){return n.paddingNumber(w[D],G.length,G.length,true)}else{return n.paddingNumber(w[D],G.length)}}}}}}}}return G})}n.formatDate=m})(tui||(tui={}));var __extends=this.__extends||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}c.prototype=a.prototype;f.prototype=new c()};var tui;(function(tui){var mimeTypeMap={"application/java-archive":["jar"],"application/msword":["doc"],"application/pdf":["pdf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m"],"application/pkcs7-signature":["p7s"],"application/postscript":["ai"],"application/vnd.ms-excel":["xls"],"application/vnd.ms-powerpoint":["ppt"],"application/vnd.ms-project":["mpp"],"application/vnd.ms-visio.viewer":["vsd"],"application/vnd.ms-xpsdocument":["xps"],"application/vnd.oasis.opendocument.presentation":["odp"],"application/vnd.oasis.opendocument.spreadsheet":["ods"],"application/vnd.oasis.opendocument.text":["odt"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/x-7z-compressed":["7z"],"application/x-bzip2":["bz2"],"application/x-gzip":["gz"],"application/x-javascript":["js"],"application/x-msdownload":["exe"],"application/x-msmetafile":["wmf"],"application/x-pkcs12":["p12","pfx"],"application/x-pkcs7-certificates":["p7b"],"application/x-pkcs7-certreqresp":["p7r"],"application/x-rar-compressed":["rar"],"application/x-shockwave-flash":["swf"],"application/x-tar":["tar"],"application/x-x509-ca-cert":["cer"],"application/xhtml+xml":["xhtml"],"application/xml":["xml"],"application/zip":["zip"],"audio/mp4":["m4a"],"audio/mpeg":["mp3"],"audio/x-ms-wma":["wma"],"audio/x-pn-realaudio":["rm"],"image/bmp":["bmp"],"image/gif":["gif"],"image/jpeg":["jpeg"],"image/nbmp":["nbmp"],"image/png":["png"],"image/svg-xml":["svg"],"image/tiff":["tiff"],"image/x-icon":["ico"],"message/rfc822":["eml"],"text/css":["css"],"text/html":["html"],"text/plain":["txt"],"text/xml":["xml"],"video/3gpp":["3gp"],"video/3gpp2":["3gp2"],"video/avi":["avi"],"video/mp4":["mp4"],"video/mpeg":["mpeg"],"video/quicktime":["mov"]};function checkExtWithMimeType(ext,mimeType){var exts=mimeTypeMap[mimeType];if(typeof exts===tui.undef){return true}if(exts.indexOf(ext.toLowerCase())>=0){return true}else{return false}}tui.checkExtWithMimeType=checkExtWithMimeType;function getBox(el){var left,right,top,bottom;var offset=$(el).position();left=offset.left;top=offset.top;right=left+el.offsetWidth;bottom=top+el.offsetHeight;return{left:left,right:right,top:top,bottom:bottom}}function copyLayout(from,to){var box=getBox(from);$(to).css({position:"absolute",left:box.left+"px",top:box.top+"px",width:from.offsetWidth+"px",height:from.offsetHeight+"px"})}function fileFromPath(file){return file.replace(/.*(\/|\\)/,"")}function getExt(file){return(-1!==file.indexOf("."))?file.replace(/.*[.]/,""):""}function preventDefault(e){return e.preventDefault()}var UploadBinding=(function(_super){__extends(UploadBinding,_super);function UploadBinding(button,options){_super.call(this);this._settings={action:"upload",name:"userfile",multiple:false,autoSubmit:true,responseType:"auto",hoverClass:"tui-input-btn-hover",focusClass:"tui-input-btn-active",disabledClass:"tui-input-btn-disabled"};this._button=null;this._input=null;this._disabled=false;if(options){for(var i in options){if(options.hasOwnProperty(i)){this._settings[i]=options[i]}}}if(typeof button==="string"){if(/^#.*/.test(button)){button=button.slice(1)}button=document.getElementById(button)}if(!button||button.nodeType!==1){throw new Error("Please make sure that you're passing a valid element")}if(button.nodeName.toLowerCase()==="a"){$(button).on("click",preventDefault)}this._button=button;this._input=null;this._disabled=false;this.installBind()}UploadBinding.prototype.createIframe=function(){var id=tui.uuid();var iframe=tui.toElement('<iframe src="javascript:false;" name="'+id+'" />');iframe.setAttribute("id",id);iframe.style.display="none";document.body.appendChild(iframe);var doc=iframe.contentDocument?iframe.contentDocument:window.frames[iframe.id].document;doc.charset="utf-8";return iframe};UploadBinding.prototype.createForm=function(iframe){var settings=this._settings;var form=tui.toElement('<form method="post" enctype="multipart/form-data" accept-charset="UTF-8"></form>');form.setAttribute("accept-charset","UTF-8");if(settings.action){form.setAttribute("action",settings.action)}form.setAttribute("target",iframe.name);form.style.display="none";document.body.appendChild(form);for(var prop in settings.data){if(settings.data.hasOwnProperty(prop)){var el=document.createElement("input");el.setAttribute("type","hidden");el.setAttribute("name",prop);el.setAttribute("value",settings.data[prop]);form.appendChild(el)}}return form};UploadBinding.prototype.createInput=function(){var _this=this;var input=document.createElement("input");input.setAttribute("type","file");if(this._settings.accept){input.setAttribute("accept",this._settings.accept)}input.setAttribute("name",this._settings.name);if(this._settings.multiple){input.setAttribute("multiple","multiple")}if(tui.ieVer>0){input.title=""}else{input.title=" "}$(input).css({position:"absolute",right:0,margin:0,padding:0,fontSize:"480px",fontFamily:"sans-serif",cursor:"pointer"});var div=document.createElement("div");$(div).css({display:"block",position:"absolute",overflow:"hidden",margin:0,padding:0,opacity:0,direction:"ltr",zIndex:2147483583});if(div.style.opacity!=="0"){if(typeof(div.filters)==="undefined"){throw new Error("Opacity not supported by the browser")}div.style.filter="alpha(opacity=0)"}$(input).on("change",function(){if(!input||input.value===""){return}var file=fileFromPath(input.value);var fileExt=getExt(file);if(_this.fire("change",{file:file,ext:fileExt})===false){_this.clearInput();return}if(_this._settings.autoSubmit){_this.submit()}});$(input).on("mouseover",function(){$(_this._button).addClass(_this._settings.hoverClass)});$(input).on("mouseout",function(){$(_this._button).removeClass(_this._settings.hoverClass);$(_this._button).removeClass(_this._settings.focusClass);if(input.parentNode){input.parentNode.style.visibility="hidden"}});$(input).on("focus",function(){$(_this._button).addClass(_this._settings.focusClass)});$(input).on("blur",function(){$(_this._button).removeClass(_this._settings.focusClass)});div.appendChild(input);this._button.offsetParent.appendChild(div);this._input=input};UploadBinding.prototype.deleteInput=function(){if(!this._input){return}tui.removeNode(this._input.parentNode);this._input=null;$(this._button).removeClass(this._settings.hoverClass);$(this._button).removeClass(this._settings.focusClass)};UploadBinding.prototype.clearInput=function(){this.deleteInput();this.createInput()};UploadBinding.prototype.processResponse=function(iframe,file){var _this=this;var toDeleteFlag=false,settings=this._settings;$(iframe).on("load",function(){if(iframe.src==="javascript:'%3Chtml%3E%3C/html%3E';"||iframe.src==="javascript:'<html></html>';"){if(toDeleteFlag){setTimeout(function(){tui.removeNode(iframe)},0)}return}var doc=iframe.contentDocument?iframe.contentDocument:window.frames[iframe.id].document;if(doc.readyState&&doc.readyState!=="complete"){return}if(doc.body&&doc.body.innerHTML==="false"){return}var response;if(doc.XMLDocument){response=doc.XMLDocument}else{if(doc.body){response=doc.body.innerHTML;if(settings.responseType&&settings.responseType.toLowerCase()==="json"){if(doc.body.firstChild&&doc.body.firstChild.nodeName.toUpperCase()==="PRE"){doc.normalize&&doc.normalize();response=doc.body.firstChild.firstChild.nodeValue}if(response){try{response=eval("("+response+")")}catch(e){response=null}}else{response=null}}}else{response=doc}}_this.fire("complete",{file:file,ext:getExt(file),response:response});toDeleteFlag=true;iframe.src="javascript:'<html></html>';";tui.removeNode(iframe)})};UploadBinding.prototype.submit=function(exparams){if(!this._input||this._input.value===""){return}var file=fileFromPath(this._input.value);if(this.fire("submit",{file:file,ext:getExt(file)})===false){this.clearInput();return}var iframe=this.createIframe();var form=this.createForm(iframe);tui.removeNode(this._input.parentNode);$(this._button).removeClass(this._settings.hoverClass);$(this._button).removeClass(this._settings.focusClass);form.appendChild(this._input);var el=document.createElement("input");el.setAttribute("type","hidden");el.setAttribute("name","exparams");el.setAttribute("value",exparams);form.appendChild(el);form.submit();tui.removeNode(form);form=null;this.deleteInput();this.processResponse(iframe,file);this.createInput()};UploadBinding.prototype.disabled=function(val){if(typeof val==="boolean"){this._disabled=val;return this}else{return this._disabled}};UploadBinding.prototype.installBind=function(){$(this._button).on("mouseover",{self:this},UploadBinding.makeBind)};UploadBinding.prototype.uninstallBind=function(){this.deleteInput();$(this._button).off("mouseover",UploadBinding.makeBind)};UploadBinding.makeBind=(function(e){var self=e.data.self;if(self._disabled){return}if(!self._input){self.createInput()}var div=self._input.parentNode;copyLayout(self._button,div);div.style.visibility="visible"});return UploadBinding})(tui.EventObject);tui.UploadBinding=UploadBinding;function bindUpload(button,options){return new UploadBinding(button,options)}tui.bindUpload=bindUpload})(tui||(tui={}));var tui;(function(b){var c=(function(){function d(e){this._src=null;this._data=null;this._head=null;this._headCache={};this._mapping={};this._realKeyMap=null;if(e&&e instanceof Array){this._src=this._data=e}else{if(e&&e.data){this._src=this._data=e.data;if(e.head){this._head=e.head}else{this._head=null}}else{throw new Error("TUI Grid: Unsupported data format!")}}}d.prototype.length=function(){if(this._data){return this._data.length}else{return 0}};d.prototype.at=function(e){if(this._data){return this._data[e]}else{return null}};d.prototype.cell=function(e,f){var i=this.at(e);if(!i){return null}var h=this.columnKeyMap();var g=h[f];if(g!=null){return i[g]}else{return i[f]}};d.prototype.columnKeyMap=function(){if(this._realKeyMap!==null){return this._realKeyMap}if(this._head){var h={};for(var g=0;g<this._head.length;g++){h[this._head[g]]=g}for(var e in this._mapping){if(!this._mapping.hasOwnProperty(e)){continue}var f=this._mapping[e];if(h.hasOwnProperty(f)){h[e]=h[f]}else{h[e]=f}}this._realKeyMap=h;return h}else{this._realKeyMap=this._mapping;return this._mapping}};d.prototype.mapKey=function(e){var g=this.columnKeyMap();var f=g[e];if(f!=null){return f}else{return e}};d.prototype.addKeyMap=function(f,e){this._mapping[f]=e;this._realKeyMap=null};d.prototype.removeKeyMap=function(e){delete this._mapping[e];this._realKeyMap=null};d.prototype.sort=function(e,g,f){if(f===void 0){f=null}if(this._src){if(typeof f==="function"){this._data=this._src.concat();this._data.sort(f)}else{if(e===null&&f===null){this._data=this._src;return this}else{if(this._head&&typeof e==="string"){e=this._head.indexOf(e)}this._data=this._src.concat();this._data.sort(function(i,h){if(i[e]>h[e]){return g?-1:1}else{if(i[e]<h[e]){return g?1:-1}else{return 0}}})}}}else{this._data=null}return this};d.prototype.data=function(e){if(e){if(e instanceof Array){this._src=this._data=e;return this}else{if(e.data){this._src=this._data=e.data;if(e.head){this._head=e.head}else{this._head=null}return this}else{throw new Error("TUI Grid: Unsupported data format!")}}}else{return this._data}};d.prototype.src=function(){return this._src};d.prototype.process=function(e){this._data=e(this._src)};return d})();b.ArrayProvider=c;var a=(function(){function d(e){if(e===void 0){e=100}this._queryTimer=null;this._mapping={};this._realKeyMap=null;this._firstQuery=true;this._cacheSize=e;this._invalid=true;this._data=[];this._begin=0;this._length=0;this._sortKey=null}d.prototype.length=function(){if(this._invalid){this.doQuery(0)}return this._length};d.prototype.at=function(e){if(e<0||e>=this.length()){return null}else{if(this._invalid||e<this._begin||e>=this._begin+this._data.length){this.doQuery(e)}}if(e>=this._begin||e<this._begin+this._data.length){return this._data[e-this._begin]}else{return null}};d.prototype.cell=function(e,f){var i=this.at(e);if(!i){return null}var h=this.columnKeyMap();var g=h[f];if(g!=null){return i[g]}else{return i[f]}};d.prototype.addKeyMap=function(f,e){this._mapping[f]=e;this._realKeyMap=null};d.prototype.removeKeyMap=function(e){delete this._mapping[e];this._realKeyMap=null};d.prototype.columnKeyMap=function(){if(this._realKeyMap!==null){return this._realKeyMap}if(this._head){var h={};for(var g=0;g<this._head.length;g++){h[this._head[g]]=g}for(var e in this._mapping){if(!this._mapping.hasOwnProperty(e)){continue}var f=this._mapping[e];if(h.hasOwnProperty(f)){h[e]=h[f]}else{h[e]=f}}this._realKeyMap=h;return h}else{this._realKeyMap=this._mapping;return this._mapping}};d.prototype.mapKey=function(e){var g=this.columnKeyMap();var f=g[e];if(f!=null){return f}else{return e}};d.prototype.sort=function(e,g,f){if(f===void 0){f=null}this._sortKey=e;this._desc=g;this._invalid=true;return this};d.prototype.doQuery=function(g){var i=this;if(typeof this._queryCallback!=="function"){return}if(this._queryTimer!==null){clearTimeout(this._queryTimer)}var e=this;var h=g-Math.round(this._cacheSize/2);if(h<0){h=0}var f={begin:h,cacheSize:this._cacheSize,sortKey:this._sortKey,sortDesc:this._desc,update:function(j){e._data=j.data;e._length=j.length;e._begin=j.begin;e._invalid=false;if(typeof j.head!==b.undef){e._head=j.head}if(typeof e._updateCallback==="function"){e._updateCallback({length:e._length,begin:e._begin,data:e._data})}}};if(this._firstQuery){this._firstQuery=false;this._queryCallback(f)}else{this._queryTimer=setTimeout(function(){i._firstQuery=true;i._queryTimer=null;i._queryCallback(f)},100)}};d.prototype.onupdate=function(e){this._updateCallback=e};d.prototype.onquery=function(e){this._queryCallback=e};return d})();b.RemoteCursorProvider=a})(tui||(tui={}));var tui;(function(k){var a=document.createElement("div");a.className="tui-mask";a.setAttribute("unselectable","on");var h=(/Firefox/i.test(navigator.userAgent))?"DOMMouseScroll":"mousewheel";$(a).on(h,function(m){m.stopPropagation();m.preventDefault()});var j=document.createElement("span");j.className="tui-tooltip";j.setAttribute("unselectable","on");var d=null;function l(){document.body.appendChild(a);return a}k.mask=l;function f(){if(a.parentNode){a.parentNode.removeChild(a)}a.innerHTML="";a.style.cursor="";a.removeAttribute("tabIndex");a.removeAttribute("data-tooltip");a.removeAttribute("data-cursor-tooltip");return a}k.unmask=f;function b(o,n,m,p){if(o===d||o===j){j.style.left=m-17+"px";j.style.top=p+20+"px";j.innerHTML=n;return}document.body.appendChild(j);j.innerHTML=n;d=o;j.style.left=m-17+"px";j.style.top=p+20+"px"}k.showTooltipAtCursor=b;function i(n,m){if(n===d||n===j){return}document.body.appendChild(j);j.innerHTML=m;d=n;var o=k.fixedPosition(n);if(n.offsetWidth<20){j.style.left=(o.x+n.offsetWidth/2-17)+"px"}else{j.style.left=o.x+"px"}j.style.top=o.y+8+n.offsetHeight+"px"}k.showTooltip=i;function c(){if(j.parentNode){j.parentNode.removeChild(j)}j.innerHTML="";d=null}k.closeTooltip=c;function g(p,o){if(k.isAncestry(p,j)){return}var n=p;while(n){var m=n.getAttribute("data-tooltip");if(m){if(n.getAttribute("data-cursor-tooltip")==="true"){b(n,m,o.clientX,o.clientY)}else{i(n,m)}return}else{n=n.parentElement}}if(!n){c()}}k.whetherShowTooltip=g;function e(m){if(m!==d&&m!==j){c()}}k.whetherCloseTooltip=e})(tui||(tui={}));var tui;(function(a){var b;(function(g){var f=(function(k){__extends(j,k);function j(l,n,m){k.call(this);this._exposedEvents={};if(typeof m==="object"){this.elem(m)}else{this.elem(l,n)}if(this[0]){this[0]._ctrl=this}}j.prototype.elem=function(l,m){if(l&&l.nodeName||l===null){this[0]=l;this.bindMainElementEvent()}else{if(typeof l==="string"&&typeof m==="string"){this[0]=document.createElement(l);this[0].className=m;this.bindMainElementEvent()}}return this[0]};j.prototype.bindMainElementEvent=function(){if(!this[0]){return}var l=this;$(this[0]).focus(function(){l.addClass("tui-focus")});$(this[0]).blur(function(){l.removeClass("tui-focus")})};j.prototype.exposeEvents=function(m){if(this[0]){if(typeof m==="string"){m=m.split(/\s+/)}for(var l=0;l<m.length;l++){this._exposedEvents[m[l]]=true}}};j.prototype.bind=function(l,n,m){if(this._exposedEvents[l]){$(this[0]).on(l,n)}else{k.prototype.bind.call(this,l,n,m)}};j.prototype.unbind=function(l,m){if(this._exposedEvents[l]){$(this[0]).off(l,m)}else{k.prototype.unbind.call(this,l,m)}};j.prototype.id=function(l){if(typeof l==="string"){if(this[0]){this[0].id=l}return this}else{if(this[0]&&this[0].id){return this[0].id}else{return null}}};j.prototype.hasAttr=function(l){if(this[0]){return typeof $(this[0]).attr(l)==="string"}else{return false}};j.prototype.isAttrTrue=function(m){if(this.hasAttr(m)){var l=this.attr(m).toLowerCase();return l===""||l==="true"||l==="on"}else{return false}};j.prototype.attr=function(n,l){if(typeof n==="string"&&typeof l===a.undef){if(!this[0]){return null}else{var m=$(this[0]).attr(n);if(m===null||typeof m===a.undef){return null}else{return m}}}else{if(this[0]){$(this[0]).attr(n,l)}return this}};j.prototype.removeAttr=function(l){if(this[0]){$(this[0]).removeAttr(l)}return this};j.prototype.css=function(m,l){if(typeof m==="string"&&typeof l===a.undef){if(!this[0]){return null}else{return $(this[0]).css(m)}}else{if(this[0]){$(this[0]).css(m,l)}return this}};j.prototype.hasClass=function(l){if(this[0]){return $(this[0]).hasClass(l)}else{return false}};j.prototype.addClass=function(l){if(this[0]){$(this[0]).addClass(l)}return this};j.prototype.removeClass=function(l){if(this[0]){$(this[0]).removeClass(l)}return this};j.prototype.refresh=function(){};j.prototype.is=function(l,m){if(typeof m==="boolean"){if(m){this.attr(l,"true")}else{this.removeAttr(l)}if(this[0]&&a.ieVer>0&&a.ieVer<=8){this[0].className=this[0].className}return this}else{return this.isAttrTrue(l)}};j.prototype.hidden=function(l){if(typeof l==="boolean"){this.is("data-hidden",l);if(l){this.addClass("tui-hidden")}else{this.removeClass("tui-hidden")}return this}else{return this.is("data-hidden")}};j.prototype.checked=function(l){if(typeof l==="boolean"){this.is("data-checked",l);this.fire("check",{ctrl:this,checked:l});return this}else{return this.is("data-checked")}};j.prototype.actived=function(l){if(typeof l==="boolean"){this.is("data-actived",l);if(l){this.addClass("tui-actived")}else{this.removeClass("tui-actived")}return this}else{return this.is("data-actived")}};j.prototype.disabled=function(l){return this.is("data-disabled",l)};j.prototype.marked=function(l){return this.is("data-marked",l)};j.prototype.selectable=function(l){if(typeof l==="boolean"){if(!l){this.attr("unselectable","on")}else{this.removeAttr("unselectable")}return this}else{return !this.isAttrTrue("unselectable")}};j.prototype.form=function(l){if(typeof l==="string"){this.attr("data-form",l);return this}else{return this.attr("data-form")}};j.prototype.field=function(l){if(typeof l==="string"){this.attr("data-field",l);return this}else{return this.attr("data-field")}};j.prototype.blur=function(){if(this[0]){this[0].blur()}};j.prototype.focus=function(){var l=this;if(this[0]){setTimeout(function(){l[0].focus()},0)}};j.prototype.focusWithoutScroll=function(){var l=this;if(this[0]){setTimeout(function(){a.focusWithoutScroll(l[0])},0)}};j.prototype.isHover=function(){if(this[0]){return a.isAncestry(e,this[0])}else{return false}};j.prototype.isFocused=function(){if(this[0]){return a.isAncestry(document.activeElement,this[0])}else{return false}};j.prototype.isAncestry=function(l){return a.isAncestry(this[0],l)};j.prototype.isPosterity=function(l){return a.isPosterity(this[0],l)};j.prototype.autoRefresh=function(){return true};return j})(a.EventObject);g.Control=f;function h(m,j,l){var k=null;if(typeof m==="string"&&m){k=document.getElementById(m);if(!k){return null}if(k._ctrl){k._ctrl.autoRefresh()&&k._ctrl.refresh();return k._ctrl}else{if(typeof l!==a.undef){return new j(k,l)}else{return new j(k)}}}else{if(m&&m.nodeName){k=m;if(k._ctrl){k._ctrl.autoRefresh()&&k._ctrl.refresh();return k._ctrl}else{if(typeof l!==a.undef){return new j(k,l)}else{return new j(k)}}}else{if((typeof m===a.undef||m===null)&&j){if(typeof l!==a.undef){return new j(null,l)}else{return new j()}}else{return null}}}}g.control=h;var d={};function c(j,k){if(!d[j]){d[j]=k}}g.registerInitCallback=c;function i(j){for(var l in d){if(l){var k=d[l];$(j).find("."+l).each(function(m,n){k(n)})}}}g.initCtrls=i;var e;$(window.document).mousemove(function(j){e=j.target||j.toElement;if(j.button===0&&(j.which===1||j.which===0)){a.whetherShowTooltip(e,j)}});$(window).scroll(function(){a.closeTooltip()});$(window.document).ready(function(){i(document);a.fire("initialized",null)})})(b=a.ctrl||(a.ctrl={}))})(tui||(tui={}));var tui;(function(tui){var ctrl;(function(_ctrl){var FormAgent=(function(_super){__extends(FormAgent,_super);function FormAgent(el){_super.call(this,"span",FormAgent.CLASS,el);var parent=this[0].parentElement;while(parent){if($(parent).hasClass("tui-form")){this.form($(parent).attr("id"));break}else{parent=parent.parentElement}}if(!this.hasAttr("data-target-property")){this.targetProperty("value")}}FormAgent.prototype.validate=function(){var param={valid:true};if(this.fire("validate",param)===false){return param.valid}var target=this.target();var isGroup=this.isGroup();if(!target){return true}if(isGroup){var validator=this.groupValidator();if(!validator){return true}var controls=$("."+_ctrl.Radiobox.CLASS+"[data-group='"+target+"'],."+_ctrl.Checkbox.CLASS+"[data-group='"+target+"']");var values=[];controls.each(function(index,elem){if(tui.parseBoolean($(elem).attr("data-checked"))){values.push($(elem).attr("data-value"))}});var valid=true;for(var k in validator){if(k&&validator.hasOwnProperty(k)){if(k.substr(0,5)==="*max:"){var imax=parseFloat(k.substr(5));if(isNaN(imax)){throw new Error("Invalid validator: '*max:...' must follow a number")}var ival=values.length;if(ival>imax){valid=false}}else{if(k.substr(0,5)==="*min:"){var imin=parseFloat(k.substr(5));if(isNaN(imin)){throw new Error("Invalid validator: '*min:...' must follow a number")}var ival=values.length;if(ival<imin){valid=false}}else{valid=values.indexOf(k)>=0}}if(!valid){controls.each(function(index,elem){var ctrl=elem._ctrl;if(ctrl&&typeof ctrl.notify==="function"){ctrl.notify(validator[k])}});break}}}return valid}else{var elem=document.getElementById(target);if(elem&&elem._ctrl){var ctrl=elem._ctrl;if(typeof ctrl.validate==="function"){return ctrl.validate()}}return true}};FormAgent.prototype.target=function(val){if(typeof val!==tui.undef){this.attr("data-target",val);return this}else{return this.attr("data-target")}};FormAgent.prototype.targetProperty=function(val){if(typeof val!==tui.undef){this.attr("data-target-property",val);return this}else{return this.attr("data-target-property")}};FormAgent.prototype.groupValidator=function(val){if(typeof val==="object"&&val){this.attr("data-group-validator",JSON.stringify(val));return this}else{if(val===null){this.removeAttr("data-group-validator");return this}else{var strval=this.attr("data-group-validator");if(strval===null){return null}else{try{val=eval("("+strval+")");if(typeof val!=="object"){return null}else{return val}}catch(err){return null}}}}};FormAgent.prototype.isGroup=function(val){if(typeof val!==tui.undef){this.is("data-is-group",!!val);return this}else{return this.is("data-is-group")}};FormAgent.prototype.value=function(val){var property=this.targetProperty();var target=this.target();var isGroup=this.isGroup();if(typeof val!==tui.undef){var param={value:val};if(this.fire("setvalue",param)===false){return this}val=param.value;if(!target){this.attr("data-value",JSON.stringify(val));return this}if(isGroup){var controls=$("."+_ctrl.Radiobox.CLASS+"[data-group='"+target+"'],."+_ctrl.Checkbox.CLASS+"[data-group='"+target+"']");var values;if(val&&typeof val.length==="number"){values=val}else{if(val===null){values=[]}else{values=[val]}}controls.each(function(index,elem){var ctrl=elem._ctrl;if(typeof ctrl[property]==="function"){if(values.indexOf(ctrl[property]())>=0){ctrl.checked(true)}else{ctrl.checked(false)}}})}else{var elem=document.getElementById(target);if(elem&&elem._ctrl){var ctrl=elem._ctrl;if(typeof ctrl[property]==="function"){ctrl[property](val)}}else{if(elem){if(typeof elem[property]==="function"){elem[property](val)}else{elem[property]=val}}}}return this}else{var val=null;if(!target){var strval=this.attr("data-value");if(strval===null){val=null}else{try{val=eval("("+strval+")")}catch(err){val=null}}}else{if(isGroup){var controls=$("."+_ctrl.Radiobox.CLASS+"[data-group='"+target+"']");var values=[];if(controls.length>0){controls.each(function(index,elem){var ctrl=elem._ctrl;if(ctrl){if(typeof ctrl.checked==="function"&&ctrl.checked()&&typeof ctrl[property]==="function"){values.push(ctrl[property]())}}});if(values.length>0){val=values[0]}else{val=null}}else{controls=$("."+_ctrl.Checkbox.CLASS+"[data-group='"+target+"']");controls.each(function(index,elem){var ctrl=elem._ctrl;if(ctrl){if(typeof ctrl.checked==="function"&&ctrl.checked()&&typeof ctrl[property]==="function"){values.push(ctrl[property]())}}});val=values}}else{var elem=document.getElementById(target);if(elem&&elem._ctrl){var ctrl=elem._ctrl;if(typeof ctrl[property]==="function"){val=ctrl[property]()}}else{if(elem){if(typeof elem[property]==="function"){val=elem[property]()}else{val=elem[property]}}}}}var param={value:val};this.fire("getvalue",param);return param.value}};FormAgent.CLASS="tui-form-agent";return FormAgent})(_ctrl.Control);_ctrl.FormAgent=FormAgent;function formAgent(param){return tui.ctrl.control(param,FormAgent)}_ctrl.formAgent=formAgent;tui.ctrl.registerInitCallback(FormAgent.CLASS,formAgent)})(ctrl=tui.ctrl||(tui.ctrl={}))})(tui||(tui={}));var tui;(function(a){var b;(function(d){var c=(function(g){__extends(f,g);function f(l){g.call(this,"span",f.CLASS,l);if(!this.hasAttr("data-method")){this.method("POST")}if(!this.hasAttr("data-timeout")){this.timeout(60000)}if(!this.hasAttr("data-target-property")){this.targetProperty("value")}if(!this.hasAttr("data-show-error")){this.isShowError(true)}if(this.id()===null){this.id(a.uuid())}for(var j=0;j<this[0].childNodes.length;j++){if(this[0].childNodes[j].nodeName.toLowerCase()==="span"){var k=a.ctrl.formAgent(this[0].childNodes[j]);k.form(this.id())}}var h=this;if(this.isAutoSubmit()){a.on("initialized",function(){h.submit()})}}f.prototype.isAutoSubmit=function(h){if(typeof h!==a.undef){this.is("data-auto-submit",!!h);return this}else{return this.is("data-auto-submit")}};f.prototype.isShowError=function(h){if(typeof h!==a.undef){this.is("data-show-error",!!h);return this}else{return this.is("data-show-error")}};f.prototype.waiting=function(h){if(typeof h==="string"){this.attr("data-waiting",h);return this}else{return this.attr("data-waiting")}};f.prototype.action=function(h){if(typeof h==="string"){this.attr("data-action",h);return this}else{return this.attr("data-action")}};f.prototype.method=function(h){if(typeof h==="string"&&f.METHODS.indexOf(h.toUpperCase())>=0){this.attr("data-method",h.toUpperCase());return this}else{return this.attr("data-method").toUpperCase()}};f.prototype.timeout=function(h){if(typeof h==="number"){this.attr("data-timeout",Math.round(h)+"");return this}else{return parseInt(this.attr("data-timeout"),10)}};f.prototype.target=function(h){if(typeof h==="string"){this.attr("data-target",h);return this}else{return this.attr("data-target")}};f.prototype.targetProperty=function(h){if(typeof h==="string"){this.attr("data-target-property",h);return this}else{return this.attr("data-target-property")}};f.prototype.targetRedirect=function(h){if(typeof h==="string"){this.attr("data-target-redirect",h);return this}else{return this.attr("data-target-redirect")}};f.prototype.submitForm=function(h){if(typeof h==="string"){this.attr("data-submit-form",h);return this}else{return this.attr("data-submit-form")}};f.prototype.validate=function(){var i=this.id();if(!i){return true}var h=true;$("[data-form='"+i+"']").each(function(j,k){if(typeof this._ctrl.validate==="function"){if(!this._ctrl.validate()){h=false}}});return h};f.prototype.immediateValue=function(h){if(typeof h!==a.undef){this._immediateValue=h;return this}else{return this._immediateValue}};f.prototype.value=function(i){if(typeof i!==a.undef){var j=this.id();j&&$("[data-form='"+j+"']").each(function(k,l){var m;if(this._ctrl){m=this._ctrl.field();if(!m){return}else{if(m==="*"){if(typeof this._ctrl.value==="function"){this._ctrl.value(i)}}else{if(typeof this._ctrl.value==="function"&&typeof i[m]!==a.undef){this._ctrl.value(i[m])}}}}else{m=$(l).attr("data-field");if(!m){return}else{if(m==="*"){$(l).attr("data-value",JSON.stringify(i))}else{if(typeof i[m]!==a.undef){$(l).attr("data-value",JSON.stringify(i[m]))}}}}});return this}else{var h={};var j=this.id();j&&$("[data-form='"+j+"']").each(function(k,l){var n;var o;if(this._ctrl){n=this._ctrl.field();if(!n){return}if(this._ctrl.value){o=this._ctrl.value()}else{return}}else{n=$(l).attr("data-field");if(typeof n!=="string"){return}o=$(l).attr("data-value");if(typeof o!=="string"){return}try{o=JSON.parse(o)}catch(m){}}if(n==="*"){h=o}else{if(h){h[n]=o}}});return h}};f.prototype.clear=function(){this._immediateValue=a.undefVal;var h=this.id();h&&$("[data-form='"+h+"']").each(function(i,j){if(j._ctrl){if(typeof j._ctrl.value==="function"){j._ctrl.value(null)}}else{$(j).attr("data-value","");$(j).removeAttr("data-value")}})};f.prototype.submit=function(){if(!this.validate()){return}var k=this.action();if(!k){return}var l=this.id();if(!l){return}var j=this.immediateValue();if(typeof j===a.undef){j=this.value()}if(this.fire("submit",{id:this.id(),data:j})===false){return}var i=this;var h=null;if(this.waiting()){h=a.waitbox(a.str(this.waiting()))}$.ajax({type:this.method(),timeout:this.timeout(),url:k,contentType:"application/json",data:(this.method()==="GET"?j:JSON.stringify(j)),complete:function(u,r){h&&h.close();if(r==="success"){if(i.fire("success",{jqXHR:u,status:r})===false){return}}else{if(i.fire("error",{jqXHR:u,status:r})===false){return}}if(i.fire("complete",{jqXHR:u,status:r})===false){return}if(r==="success"){var s=i.targetRedirect();if(s){window.location.assign(s);return}var t=i.target();var w=i.targetProperty();if(t){var o=/^\s*application\/json\s*(;.+)?/i.test(u.getResponseHeader("content-type"));var v=(o?u.responseJSON:u.responseText);t=document.getElementById(t);if(t&&t._ctrl){var n=t._ctrl;if(typeof n[w]==="function"){n[w](v)}}else{if(t){if(typeof t[w]==="function"){t[w](v)}else{t[w]=v}}}}var q=i.submitForm();if(q){var p=a.ctrl.form(q);p&&p.submit()}}else{if(typeof f.defaultErrorProc==="function"){if(f.defaultErrorProc({jqXHR:u,status:r})===false){return}}if(i.isShowError()&&!(f.ignoreErrors&&f.ignoreErrors.indexOf(u.status)>=0)){var m=/^\s*text\/plain\s*(;.+)?/i.test(u.getResponseHeader("content-type"));if(m&&u.responseText){a.errbox(a.str(u.responseText),a.str("Failed"))}else{a.errbox(a.str(r)+" ("+u.status+")",a.str("Failed"))}}}},processData:(this.method()==="GET"?true:false)})};f.ignoreError=function(h){f.ignoreErrors=h};f.defaultError=function(h){f.defaultErrorProc=h};f.CLASS="tui-form";f.METHODS=["GET","POST","PUT","DELETE"];f.STATUS=["success","notmodified","error","timeout","abort","parsererror"];f.ignoreErrors=null;f.defaultErrorProc=null;return f})(d.Control);d.Form=c;function e(f){return a.ctrl.control(f,c)}d.form=e;a.ctrl.registerInitCallback(c.CLASS,e)})(b=a.ctrl||(a.ctrl={}))})(tui||(tui={}));var tui;(function(tui){var ctrl;(function(ctrl){var Button=(function(_super){__extends(Button,_super);function Button(el){var _this=this;_super.call(this,"a",Button.CLASS,el);this._data=null;this._columnKeyMap=null;this._isMenu=false;this.disabled(this.disabled());this.selectable(false);this.exposeEvents("mousedown mouseup mousemove mouseenter mouseleave keydown keyup");var self=this;function openMenu(){var pos=self.menuPos();if(self.isMenu()){var menu=tui.ctrl.menu(self._data);menu.show(self[0],pos||"Lb");menu.on("select",function(data){self.fire("select",data)});menu.on("close",function(){self.actived(false)});return}var pop=tui.ctrl.popup();var list=tui.ctrl.list();list.consumeMouseWheelEvent(true);list.rowcheckable(false);pop.on("close",function(){self.actived(false)});function doSelectItem(data){var item=list.activeItem();var link=item[self._linkColumnKey];if(link){pop.close();window.location.href=link;return}var action=item.action;if(typeof action!==tui.undef){if(typeof action==="function"){action()}pop.close();self.focus();self.fireClick(data.event);return}self.value(item[self._keyColumnKey]);var targetElem=self.menuBind();if(targetElem===null){self.text(item[self._valueColumnKey])}else{targetElem=document.getElementById(targetElem);if(targetElem){if(targetElem._ctrl){if(typeof targetElem._ctrl.text==="function"){targetElem._ctrl.text(item[self._valueColumnKey])}}else{targetElem.innerHTML=item[self._valueColumnKey]}}}pop.close();self.focus();self.fireClick(data.event)}list.on("rowclick",function(data){doSelectItem(data)});list.on("keydown",function(data){if(data.event.keyCode===13){doSelectItem(data)}});var testDiv=document.createElement("span");testDiv.className="tui-list-test-width-cell";document.body.appendChild(testDiv);var listWidth=self[0].offsetWidth;for(var i=0;i<self._data.length();i++){var item=self._data.at(i);testDiv.innerHTML=item[self._valueColumnKey];if(testDiv.offsetWidth+40>listWidth){listWidth=testDiv.offsetWidth+40}}document.body.removeChild(testDiv);list[0].style.width=listWidth+"px";list.data(self._data);pop.show(list[0],self[0],pos||"Rb");var items=self._data?self._data.length():0;if(items<1){items=1}else{if(items>15){items=15}}list[0].style.height=items*list.lineHeight()+4+"px";list.refresh();pop.refresh();var val=self.value();if(val&&val.length>0){list.activeRowByKey(val);list.scrollTo(list.activerow())}list.focus()}$(this[0]).on("mousedown",function(e){if(_this.disabled()){return}_this.actived(true);var self=_this;if(_this.data()){setTimeout(openMenu,50)}else{function releaseMouse(e){self.actived(false);if(tui.isFireInside(self[0],e)){self.fireClick(e)}$(document).off("mouseup",releaseMouse)}$(document).on("mouseup",releaseMouse)}});$(this[0]).on("keydown",function(e){if(_this.disabled()){return}if(e.keyCode===32){_this.actived(true);e.preventDefault()}if(e.keyCode===13){e.preventDefault();if(_this.data()){_this.actived(true);openMenu()}else{e.type="click";setTimeout(function(){_this.fireClick(e)},100)}}});$(this[0]).on("keyup",function(e){if(_this.disabled()){return}if(e.keyCode===32){if(_this.data()){openMenu()}else{_this.actived(false);e.type="click";setTimeout(function(){_this.fireClick(e)},50)}}});var predefined=this.attr("data-data");if(predefined){predefined=eval("("+predefined+")");this.data(predefined)}predefined=this.attr("data-menu");if(predefined){predefined=eval("("+predefined+")");this.menu(predefined)}}Button.prototype.fireClick=function(e){if(this.fire("click",{ctrl:this[0],event:e})===false){return}if(tui.fire(this.id(),{ctrl:this[0],event:e})===false){return}var formId=this.submitForm();if(formId){var form=tui.ctrl.form(formId);form&&form.submit()}};Button.prototype.submitForm=function(formId){if(typeof formId==="string"){this.attr("data-submit-form",formId);return this}else{return this.attr("data-submit-form")}};Button.prototype.value=function(val){if(typeof val!==tui.undef){this.attr("data-value",JSON.stringify(val));return this}else{val=this.attr("data-value");if(val===null){return null}else{try{return eval("("+val+")")}catch(err){return null}}}};Button.prototype.menuBind=function(val){if(typeof val!==tui.undef){this.attr("data-menu-bind",val);return this}else{return this.attr("data-menu-bind")}};Button.prototype.menuPos=function(val){if(typeof val!==tui.undef){this.attr("data-menu-pos",val);return this}else{return this.attr("data-menu-pos")}};Button.prototype.columnKey=function(key){var val=this._columnKeyMap[key];if(typeof val==="number"&&val>=0){return val}else{return key}};Button.prototype.isMenu=function(val){if(typeof val==="boolean"){this.is("data-is-menu",val);return this}else{return this.is("data-is-menu")}};Button.prototype.menu=function(data){if(data){this.isMenu(true);this.data(data)}else{if(this.isMenu()){return this._data}else{return null}}};Button.prototype.data=function(data){if(data){var self=this;if(data instanceof Array||data.data&&data.data instanceof Array){data=new tui.ArrayProvider(data)}if(typeof data.length!=="function"||typeof data.sort!=="function"||typeof data.at!=="function"||typeof data.columnKeyMap!=="function"){throw new Error("TUI Button: need a data provider.")}this._data=data;if(data){this._columnKeyMap=data.columnKeyMap()}else{this._columnKeyMap={}}this._keyColumnKey=this.columnKey("key");this._valueColumnKey=this.columnKey("value");this._childrenColumnKey=this.columnKey("children");this._linkColumnKey=this.columnKey("link");return this}else{return this._data}};Button.prototype.text=function(val){if(typeof val!==tui.undef){$(this[0]).html(val);return this}else{return $(this[0]).html()}};Button.prototype.html=function(val){return this.text(val)};Button.prototype.disabled=function(val){if(typeof val==="boolean"){this.is("data-disabled",val);if(val){this.removeAttr("tabIndex")}else{this.attr("tabIndex","0")}return this}else{return this.is("data-disabled")}};Button.CLASS="tui-button";return Button})(ctrl.Control);ctrl.Button=Button;function button(param){return tui.ctrl.control(param,Button)}ctrl.button=button;tui.ctrl.registerInitCallback(Button.CLASS,button)})(ctrl=tui.ctrl||(tui.ctrl={}))})(tui||(tui={}));var tui;(function(tui){var ctrl;(function(_ctrl){var Checkbox=(function(_super){__extends(Checkbox,_super);function Checkbox(el){var _this=this;_super.call(this,"a",Checkbox.CLASS,el);this.disabled(this.disabled());this.selectable(false);this.exposeEvents("mouseup mousedown mousemove mouseenter mouseleave keyup keydown");$(this[0]).on("mousedown",function(e){if(_this.disabled()){return}_this[0].focus();_this.actived(true);var self=_this;function releaseMouse(e){self.actived(false);if(tui.isFireInside(self[0],e)){self.checked(!self.checked());e.type="click";self.fireClick(e)}$(document).off("mouseup",releaseMouse)}$(document).on("mouseup",releaseMouse)});$(this[0]).on("keydown",function(e){if(_this.disabled()){return}if(e.keyCode===32){_this.actived(true);e.preventDefault()}if(e.keyCode===13){e.preventDefault();e.type="click";_this.checked(!_this.checked());setTimeout(function(){_this.fireClick(e)},100)}});$(this[0]).on("keyup",function(e){if(_this.disabled()){return}if(e.keyCode===32){_this.actived(false);_this.checked(!_this.checked());e.type="click";setTimeout(function(){_this.fireClick(e)},50)}})}Checkbox.prototype.fireClick=function(e){if(this.fire("click",{ctrl:this[0],event:e})===false){return}if(tui.fire(this.id(),{ctrl:this[0],event:e})===false){return}var formId=this.submitForm();if(formId){var form=tui.ctrl.form(formId);form&&form.submit()}};Checkbox.prototype.checked=function(val){if(typeof val===tui.undef){return _super.prototype.checked.call(this)}else{_super.prototype.checked.call(this,!!val);this.unNotifyGroup();return this}};Checkbox.prototype.triState=function(val){if(typeof val==="boolean"){this.is("data-tri-state",val)}else{return this.is("data-tri-state")}};Checkbox.prototype.text=function(val){if(typeof val!==tui.undef){$(this[0]).html(val);return this}else{return $(this[0]).html()}};Checkbox.prototype.group=function(val){if(typeof val!==tui.undef){this.attr("data-group",val);return this}else{return this.attr("data-group")}};Checkbox.prototype.value=function(val){if(typeof val!==tui.undef){this.attr("data-value",JSON.stringify(val));return this}else{val=this.attr("data-value");if(val===null){return null}else{try{return eval("("+val+")")}catch(err){return null}}}};Checkbox.prototype.unNotifyGroup=function(){var groupName=this.group();if(groupName){$("."+Checkbox.CLASS+"[data-group='"+groupName+"']").each(function(index,elem){var ctrl=elem._ctrl;if(ctrl&&typeof ctrl.notify==="function"){ctrl.notify(null)}})}};Checkbox.prototype.notify=function(message){if(typeof message==="string"){this.attr("data-tooltip",message);this.addClass("tui-notify")}else{if(message===null){this.attr("data-tooltip","");this.removeAttr("data-tooltip");this.removeClass("tui-notify")}}};Checkbox.prototype.disabled=function(val){if(typeof val==="boolean"){this.is("data-disabled",val);if(val){this.removeAttr("tabIndex")}else{this.attr("tabIndex","0")}return this}else{return this.is("data-disabled")}};Checkbox.prototype.submitForm=function(formId){if(typeof formId==="string"){this.attr("data-submit-form",formId);return this}else{return this.attr("data-submit-form")}};Checkbox.CLASS="tui-checkbox";return Checkbox})(_ctrl.Control);_ctrl.Checkbox=Checkbox;function checkbox(param){return tui.ctrl.control(param,Checkbox)}_ctrl.checkbox=checkbox;tui.ctrl.registerInitCallback(Checkbox.CLASS,checkbox)})(ctrl=tui.ctrl||(tui.ctrl={}))})(tui||(tui={}));var tui;(function(tui){var ctrl;(function(_ctrl){var Radiobox=(function(_super){__extends(Radiobox,_super);function Radiobox(el){var _this=this;_super.call(this,"a",Radiobox.CLASS,el);this.disabled(this.disabled());this.selectable(false);this.exposeEvents("mouseup mousedown mousemove mouseenter mouseleave keyup keydown");$(this[0]).on("mousedown",function(e){if(_this.disabled()){return}_this[0].focus();_this.actived(true);var self=_this;function releaseMouse(e){self.actived(false);if(tui.isFireInside(self[0],e)){self.checked(true);e.type="click";self.fireClick(e)}$(document).off("mouseup",releaseMouse)}$(document).on("mouseup",releaseMouse)});$(this[0]).on("keydown",function(e){if(_this.disabled()){return}if(e.keyCode===32){_this.actived(true);e.preventDefault()}if(e.keyCode===13){e.preventDefault();e.type="click";_this.checked(true);setTimeout(function(){_this.fireClick(e)},100)}});$(this[0]).on("keyup",function(e){if(_this.disabled()){return}if(e.keyCode===32){_this.actived(false);_this.checked(true);e.type="click";setTimeout(function(){_this.fireClick(e)},50)}})}Radiobox.prototype.fireClick=function(e){if(this.fire("click",{ctrl:this[0],event:e})===false){return}if(tui.fire(this.id(),{ctrl:this[0],event:e})===false){return}var formId=this.submitForm();if(formId){var form=tui.ctrl.form(formId);form&&form.submit()}};Radiobox.prototype.text=function(val){if(typeof val!==tui.undef){$(this[0]).html(val);return this}else{return $(this[0]).html()}};Radiobox.prototype.checked=function(val){if(typeof val===tui.undef){return _super.prototype.checked.call(this)}else{val=(!!val);if(val){var groupName=this.group();if(groupName){$("."+Radiobox.CLASS+"[data-group='"+groupName+"']").each(function(index,elem){var ctrl=elem._ctrl;if(ctrl&&typeof ctrl.checked==="function"){ctrl.checked(false)}})}}_super.prototype.checked.call(this,val);this.unNotifyGroup();return this}};Radiobox.prototype.group=function(val){if(typeof val!==tui.undef){this.attr("data-group",val);return this}else{return this.attr("data-group")}};Radiobox.prototype.value=function(val){if(typeof val!==tui.undef){this.attr("data-value",JSON.stringify(val));return this}else{val=this.attr("data-value");if(val===null){return null}else{try{return eval("("+val+")")}catch(err){return null}}}};Radiobox.prototype.unNotifyGroup=function(){var groupName=this.group();if(groupName){$("."+Radiobox.CLASS+"[data-group='"+groupName+"']").each(function(index,elem){var ctrl=elem._ctrl;if(ctrl&&typeof ctrl.notify==="function"){ctrl.notify(null)}})}};Radiobox.prototype.notify=function(message){if(typeof message==="string"){this.attr("data-tooltip",message);this.addClass("tui-notify")}else{if(message===null){this.attr("data-tooltip","");this.removeAttr("data-tooltip");this.removeClass("tui-notify")}}};Radiobox.prototype.disabled=function(val){if(typeof val==="boolean"){this.is("data-disabled",val);if(val){this.removeAttr("tabIndex")}else{this.attr("tabIndex","0")}return this}else{return this.is("data-disabled")}};Radiobox.prototype.submitForm=function(formId){if(typeof formId==="string"){this.attr("data-submit-form",formId);return this}else{return this.attr("data-submit-form")}};Radiobox.CLASS="tui-radiobox";return Radiobox})(_ctrl.Control);_ctrl.Radiobox=Radiobox;function radiobox(param){return tui.ctrl.control(param,Radiobox)}_ctrl.radiobox=radiobox;tui.ctrl.registerInitCallback(Radiobox.CLASS,radiobox)})(ctrl=tui.ctrl||(tui.ctrl={}))})(tui||(tui={}));var tui;(function(a){var b;(function(d){function c(g,h){if(g<0){g=0}if(g>h){g=h}if(g<10){return"0"+g}else{return g+""}}var f=(function(g){__extends(h,g);function h(l){var w=this;g.call(this,"div",h.CLASS,l);this._time=a.today();var v=this;this.attr("tabIndex","0");this.selectable(false);this[0].innerHTML="";this._tb=this[0].appendChild(document.createElement("table"));this._tb.cellPadding="0";this._tb.cellSpacing="0";this._tb.border="0";var m=this._tb.insertRow(-1);this._prevMonth=m.insertCell(-1);this._prevMonth.className="tui-prev-month-btn";this._prevYear=m.insertCell(-1);this._prevYear.className="tui-prev-year-btn";this._yearCell=m.insertCell(-1);this._yearCell.colSpan=3;this._nextYear=m.insertCell(-1);this._nextYear.className="tui-next-year-btn";this._nextMonth=m.insertCell(-1);this._nextMonth.className="tui-next-month-btn";for(var y=0;y<7;y++){var p=this._tb.insertRow(-1);for(var x=0;x<7;x++){var k=p.insertCell(-1);if(y===0){k.className="tui-week";this.setText(y+1,x,a.str(h._week[x]))}}}function B(i){return document.createElement(i)}var s=B("div");this._timeDiv=s;s.className="tui-calendar-timebar";s.style.display="none";var n=B("input");this._hourBox=n;n.type="text";n.className="tui-calendar-timebox";n._maxValue=23;n.maxLength=2;n._type="hour";var E=B("input");this._minuteBox=E;E.type="text";E.className="tui-calendar-timebox";E._maxValue=59;E.maxLength=2;E._type="minute";var q=B("input");this._secondBox=q;q.type="text";q.className="tui-calendar-timebox";q._maxValue=59;q.maxLength=2;q._type="second";function t(H){var I=H.srcElement||H.target;a.cancelBubble(H);var G=I._maxValue;var F=I._type;var j=H.keyCode;if(j===37){if(I===E){n.focus()}else{if(I===q){E.focus()}}}else{if(j===39){if(I===E){q.focus()}else{if(I===n){E.focus()}}}else{if(j===38){var i=parseInt(I.value);i++;if(i>G){i=0}I.value=c(i,G);if(F==="hour"){v.hours(parseInt(I.value))}else{if(F==="minute"){v.minutes(parseInt(I.value))}else{v.seconds(parseInt(I.value))}}I.select()}else{if(j===40){var i=parseInt(I.value);i--;if(i<0){i=G}I.value=c(i,G);I.select();if(F==="hour"){v.hours(parseInt(I.value))}else{if(F==="minute"){v.minutes(parseInt(I.value))}else{v.seconds(parseInt(I.value))}}I.select()}else{if(j>=48&&j<=57){var i=j-48;var u=a.today().getTime();if(I._lastInputTime&&(u-I._lastInputTime)<1000){I.value=c(parseInt(I.value.substr(1,1))*10+i,G)}else{I.value=c(i,G)}I._lastInputTime=u;I.select();if(F==="hour"){v.hours(parseInt(I.value))}else{if(F==="minute"){v.minutes(parseInt(I.value))}else{v.seconds(parseInt(I.value))}}I.select()}else{if(j==13){v.fire("picked",{ctrl:v[0],event:H,time:v.time()})}}}}}}if(j!==9){return a.cancelDefault(H)}}function C(i){var j=i.srcElement||i.target;setTimeout(function(){j.select()},0)}$(n).on("keydown",t);$(E).on("keydown",t);$(q).on("keydown",t);$(n).on("focus mousedown mouseup",C);$(E).on("focus mousedown mouseup",C);$(q).on("focus mousedown mouseup",C);$(n).on("contextmenu",a.cancelDefault);$(E).on("contextmenu",a.cancelDefault);$(q).on("contextmenu",a.cancelDefault);function A(j){var i=B("span");i.style.verticalAlign="middle";i.style.margin="2px";i.innerHTML=j;return i}var o=A(a.str("Choose Time"));s.appendChild(o);s.appendChild(n);s.appendChild(A(":"));s.appendChild(E);s.appendChild(A(":"));s.appendChild(q);var r=A("<a class='tui-calendar-update'></a>");$(r).mousedown(function(u){var i=a.today();var j=new Date(v.year(),v.month()-1,v.day(),i.getHours(),i.getMinutes(),i.getSeconds());v.time(j);return a.cancelBubble(u)});s.appendChild(r);this[0].appendChild(s);$(this[0]).on("mousedown",function(u){if(a.ffVer>0){w.focus()}if(u.target.nodeName.toLowerCase()!=="td"){return}var j=u.target;if($(j).hasClass("tui-prev-month-btn")){w.prevMonth()}else{if($(j).hasClass("tui-prev-year-btn")){w.prevYear()}else{if($(j).hasClass("tui-next-year-btn")){w.nextYear()}else{if($(j).hasClass("tui-next-month-btn")){w.nextMonth()}else{if(typeof j.offsetMonth==="number"){var G=parseInt(j.innerHTML,10);var F=j.offsetMonth;if(F<0){var H=w.year();var i=w.month();if(i===1){H--;i=12}else{i--}w.onPicked(H,i,G)}else{if(F>0){var H=w.year();var i=w.month();if(i===12){H++;i=1}else{i++}w.onPicked(H,i,G)}else{if(F===0){w.onPicked(w.year(),w.month(),G)}}}}}}}}});$(this[0]).on("click",function(j){if(j.target.nodeName.toLowerCase()!=="td"){return}var i=j.target;if(typeof i.offsetMonth==="number"){v.fire("picked",{ctrl:w[0],event:j,time:w.time()})}});$(this[0]).on("dblclick",function(j){if(j.target.nodeName.toLowerCase()!=="td"){return}var i=j.target;if(typeof i.offsetMonth==="number"){v.fire("dblpicked",{ctrl:w[0],event:j,time:w.time()})}});$(this[0]).on("keydown",function(u){var j=u.keyCode;if([13,33,34,37,38,39,40].indexOf(j)>=0){if(j===37){var i=a.dateAdd(w._time,-1);v.time(i)}else{if(j===38){var i=a.dateAdd(w._time,-7);v.time(i)}else{if(j===39){var i=a.dateAdd(w._time,1);v.time(i)}else{if(j===40){var i=a.dateAdd(w._time,7);v.time(i)}else{if(j===33){w.prevMonth()}else{if(j===34){w.nextMonth()}}}}}}v.fire("picked",{ctrl:w[0],event:u,time:w.time()});return u.preventDefault()}});var D=this.attr("data-value");if(D===null){this.update()}else{var z=a.parseDate(D);if(z==null){this.update()}else{this.time(z)}}}h.prototype.setText=function(j,k,l){var i=(this._tb.rows[j].cells[k]);if(a.ieVer>0&&a.ieVer<9){i.innerText=l}else{i.innerHTML=l}};h.prototype.year=function(i){if(typeof i==="number"){if(this._time.getFullYear()!==i){this._time.setFullYear(i);this.update();this.fire("change",{ctrl:this[0],time:this.time()})}return this}else{return this._time.getFullYear()}};h.prototype.day=function(i){if(typeof i==="number"){if(this._time.getDate()!==i){this._time.setDate(i);this.update();this.fire("change",{ctrl:this[0],time:this.time()})}return this}else{return this._time.getDate()}};h.prototype.month=function(i){if(typeof i==="number"){if(this._time.getMonth()!==i-1){this._time.setMonth(i-1);this.update();this.fire("change",{ctrl:this[0],time:this.time()})}return this}else{return this._time.getMonth()+1}};h.prototype.hours=function(i){if(typeof i==="number"){if(this._time.getHours()!==i){this._time.setHours(i);this.update();this.fire("change",{ctrl:this[0],time:this.time()})}return this}else{return this._time.getHours()}};h.prototype.minutes=function(i){if(typeof i==="number"){if(this._time.getMinutes()!==i){this._time.setMinutes(i);this.update();this.fire("change",{ctrl:this[0],time:this.time()})}return this}else{return this._time.getMinutes()}};h.prototype.seconds=function(i){if(typeof i==="number"){if(this._time.getSeconds()!==i){this._time.setSeconds(i);this.update();this.fire("change",{ctrl:this[0],time:this.time()})}return this}else{return this._time.getSeconds()}};h.prototype.time=function(i){if(i instanceof Date&&i){var j=false;if(Math.floor(this._time.getTime()/1000)!==Math.floor(i.getTime()/1000)){j=true}this._time=i;this.update();j&&this.fire("change",{ctrl:this[0],time:this.time()});return this}else{if(this.timepart()){return new Date(this._time.getTime())}else{return new Date(this._time.getFullYear(),this._time.getMonth(),this._time.getDate())}}};h.prototype.value=function(i){if(i===null){this.time(a.today());return this}return this.time(i)};h.prototype.prevMonth=function(){var l=this.year(),i=this.month(),k=this.day();if(i===1){l--;i=12}else{i--}var j=new Date(l,i-1,1);if(k>a.totalDaysOfMonth(j)){k=a.totalDaysOfMonth(j)}this.onPicked(l,i,k)};h.prototype.nextMonth=function(){var l=this.year(),i=this.month(),k=this.day();if(i===12){l++;i=1}else{i++}var j=new Date(l,i-1,1);if(k>a.totalDaysOfMonth(j)){k=a.totalDaysOfMonth(j)}this.onPicked(l,i,k)};h.prototype.prevYear=function(){var l=this.year(),i=this.month(),k=this.day();l--;var j=new Date(l,i-1,1);if(k>a.totalDaysOfMonth(j)){k=a.totalDaysOfMonth(j)}this.onPicked(l,i,k)};h.prototype.nextYear=function(){var l=this.year(),i=this.month(),k=this.day();l++;var j=new Date(l,i-1,1);if(k>a.totalDaysOfMonth(j)){k=a.totalDaysOfMonth(j)}this.onPicked(l,i,k)};h.prototype.timepart=function(i){if(typeof i==="boolean"){this.is("data-timepart",i);this.refresh();return this}else{return this.is("data-timepart")}};h.prototype.onPicked=function(l,i,k){var j=new Date(l,i-1,k,this.hours(),this.minutes(),this.seconds());this.time(j)};h.prototype.firstDay=function(j){var k=j.getFullYear();var i=j.getMonth();return new Date(k,i,1)};h.prototype.update=function(){var m=a.today();var q=this.firstDay(this._time).getDay();var p=a.totalDaysOfMonth(this._time);var l=0;this._yearCell.innerHTML=this.year()+" - "+this.month();for(var o=0;o<6;o++){for(var n=0;n<7;n++){var k=this._tb.rows[o+2].cells[n];k.className="";if(l===0){if(n===q){l=1;k.innerHTML=l+"";k.offsetMonth=0}else{var r=new Date(this.firstDay(this._time).valueOf()-((q-n)*1000*24*60*60));k.innerHTML=r.getDate()+"";k.offsetMonth=-1;$(k).addClass("tui-prev-month")}}else{l++;if(l<=p){k.innerHTML=l+"";k.offsetMonth=0}else{k.innerHTML=(l-p)+"";k.offsetMonth=1;$(k).addClass("tui-next-month")}}if(l===this.day()){$(k).addClass("tui-actived")}if(n===0||n===6){$(k).addClass("tui-weekend")}if(this.year()===m.getFullYear()&&this.month()===(m.getMonth()+1)&&l===m.getDate()){$(k).addClass("tui-today")}}}if(this.timepart()){this._timeDiv.style.display="";this._hourBox.value=c(this.hours(),23);this._minuteBox.value=c(this.minutes(),59);this._secondBox.value=c(this.seconds(),59)}else{this._timeDiv.style.display="none"}};h.prototype.refresh=function(){this.update()};h.CLASS="tui-calendar";h._week=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return h})(d.Control);d.Calendar=f;function e(g){return a.ctrl.control(g,f)}d.calendar=e;a.ctrl.registerInitCallback(f.CLASS,e)})(b=a.ctrl||(a.ctrl={}))})(tui||(tui={}));var tui;(function(a){var b;(function(g){var c=null;function e(){var i=c;while(i){if(i.parent()){i=i.parent()}else{i.close();i=c}}}var f=(function(i){__extends(j,i);function j(){i.call(this,"div",j.CLASS,null);this._position=null;this._bindElem=null;this._body=document.body||document.getElementsByTagName("BODY")[0];this._parent=null;this._parentPopup=null;this._childPopup=null;this._checkInterval=null;this._showing=false;this._owner=null}j.prototype.getParentPopup=function(l){var k=c;while(k){if(k.isPosterity(l)){return k}else{k=k.parent()}}return k};j.prototype.isShowing=function(){return this._showing};j.prototype.owner=function(k){if(k){this._owner=k;return this}else{return this._owner}};j.prototype.show=function(m,n,l){var p=this;if(this._showing){return}this._showing=true;if(typeof n==="string"){n=document.getElementById(n)}var k=null;if(n&&n.nodeName&&typeof l==="string"){k=this.elem("div",j.CLASS);this._bindElem=n;this._bindType=l}else{if(n&&typeof n.x==="number"&&typeof n.y==="number"){k=this.elem("div",j.CLASS);this._position=n;this._bindType="LT"}else{if(typeof n===a.undef){k=this.elem("div",j.CLASS);this._position={x:0,y:0};this._bindType="LT"}}}if(k){if(this._bindElem){this._parentPopup=this.getParentPopup(this._bindElem);if(this._parentPopup){this._parentPopup.closeChild();this._parentPopup.child(this);this.parent(this._parentPopup);this._parent=this._parentPopup[0]}else{e();this._parent=this._body}}else{e();this._parent=this._body}c=this;k.setAttribute("tabIndex","-1");this._parent.appendChild(k);if(this.owner()){this.owner().focus()}else{k.focus()}if(typeof m==="string"){k.innerHTML=m}else{if(m&&m.nodeName){k.appendChild(m)}}a.ctrl.initCtrls(k);this.refresh();if(this._bindElem){var o=a.fixedPosition(this._bindElem);this._checkInterval=setInterval(function(){var q=a.fixedPosition(p._bindElem);if(q.x!==o.x||q.y!==o.y){p.close()}},100)}}};j.prototype.close=function(){if(!this._showing){return}this.closeChild();if(this._checkInterval){clearInterval(this._checkInterval);this._checkInterval=null}try{this._parent.removeChild(this[0])}catch(k){}c=this.parent();this.parent(null);if(c){c.child(null)}this.fire("close",{});this._showing=false};j.prototype.closeChild=function(){if(this._childPopup){this._childPopup.close();this._childPopup=null}};j.prototype.parent=function(k){if(typeof k!==a.undef){this._parentPopup=k}return this._parentPopup};j.prototype.child=function(k){if(typeof k!==a.undef){this._childPopup=k}return this._childPopup};j.prototype.refresh=function(){if(!this[0]){return}var p=this[0];var l=a.windowSize().width;var n=a.windowSize().height;var k=p.offsetWidth;var m=p.offsetHeight;var o={x:0,y:0,w:0,h:0};var r={x:0,y:0};if(this._position){o=this._position;o.w=0;o.h=0}else{if(this._bindElem){o=a.fixedPosition(this._bindElem);o.w=this._bindElem.offsetWidth;o.h=this._bindElem.offsetHeight}}var q={l:function(){r.x=o.x-k;if(r.x<2){r.x=o.x+o.w}},r:function(){r.x=o.x+o.w;if(r.x+k>l-2){r.x=o.x-k}},t:function(){r.y=o.y-m;if(r.y<2){r.y=o.y+o.h}},b:function(){r.y=o.y+o.h;if(r.y+m>n-2){r.y=o.y-m}},L:function(){r.x=o.x;if(r.x+k>l-2){r.x=o.x+o.w-k}},R:function(){r.x=o.x+o.w-k;if(r.x<2){r.x=o.x}},T:function(){r.y=o.y;if(r.y+m>n-2){r.y=o.y+o.h-m}},B:function(){r.y=o.y+o.h-m;if(r.y<2){r.y=o.y}}};q[this._bindType.substring(0,1)]();q[this._bindType.substring(1,2)]();if(r.x>l-2){r.x=l-2}if(r.x<2){r.x=2}if(r.y>n-2){r.y=n-2}if(r.y<2){r.y=2}p.style.left=r.x+"px";p.style.top=r.y+"px"};j.CLASS="tui-popup";return j})(g.Control);g.Popup=f;function h(i){setTimeout(function(){var j=document.activeElement;while(c){if(c.isPosterity(j)||c.owner()===j){return}else{c.close()}}},30)}g.checkPopup=h;$(document).on("focus mousedown keydown",h);a.on("#tui.check.popup",h);$(window).scroll(function(){e()});function d(){return new f()}g.popup=d})(b=a.ctrl||(a.ctrl={}))})(tui||(tui={}));var tui;(function(j){var a;(function(k){var t=[];var r=document.createElement("div");r.className="tui-dialog-mask";r.setAttribute("unselectable","on");var s=(/Firefox/i.test(navigator.userAgent))?"DOMMouseScroll":"mousewheel";$(r).on(s+" selectstart",function(u){u.stopPropagation();u.preventDefault()});function l(){if(r.parentNode!==null){r.parentNode.removeChild(r)}if(t.length>0){document.body.insertBefore(r,t[t.length-1].elem())}else{}}function q(u){t.push(u);document.body.appendChild(u.elem());l()}function n(v){var u=t.indexOf(v);if(u>=0){t.splice(u,1)}document.body.removeChild(v.elem());l()}function m(v){var u=t.indexOf(v);if(u>0){t[u-1]}else{return null}}var p=(function(v){__extends(u,v);function u(){v.call(this,"div",u.CLASS,null);this._resourceElement=null;this._placeHolder=null;this._hiddenOriginal=false;this._isMoved=false;this._isInitialize=true;this._titleText=null;this._noRefresh=false;this._useEsc=true;this._sizeTimer=null;this._originScrollHeight=null;this._originScrollWidth=null}u.prototype.showContent=function(x,y,w){if(this[0]){return this}this._resourceElement=null;this._placeHolder=null;return this.showElement(j.toElement(x,true),y,w)};u.prototype.showResource=function(z,y,x){if(this[0]){return this}var w=document.getElementById(z);if(!w){throw new Error("Resource id not found: "+z)}return this.showContent(w.innerHTML,y,x)};u.prototype.showElement=function(A,C,z){var D=this;if(this[0]){return this}if(typeof A==="string"){var B=A;A=document.getElementById(A)}if(!A){throw new Error("Invalid element!")}this._resourceElement=A;if($(A).hasClass("tui-hidden")){this._hiddenOriginal=true}else{this._hiddenOriginal=false}if(A.parentNode!==null){this._placeHolder=document.createElement("span");this._placeHolder.className="tui-hidden";A.parentNode.insertBefore(this._placeHolder,A)}else{this._placeHolder=null}this._noRefresh=true;this.elem("div",u.CLASS);this.attr("tabIndex","-1");this._titleDiv=document.createElement("div");this._titleDiv.className="tui-dlg-title-bar";this._titleDiv.setAttribute("unselectable","on");this._titleDiv.onselectstart=function(){return false};this[0].appendChild(this._titleDiv);this._closeIcon=document.createElement("span");this._closeIcon.className="tui-dlg-close";this._titleDiv.appendChild(this._closeIcon);this._contentDiv=document.createElement("div");this[0].appendChild(this._contentDiv);this._buttonDiv=document.createElement("div");this._buttonDiv.className="tui-dlg-btn-bar";this[0].appendChild(this._buttonDiv);var y="";if(typeof C==="string"){y=C}else{if(A.title){y=A.title}}this.title(y);this._contentDiv.appendChild(A);$(A).removeClass("tui-hidden");var w=this;if(z&&typeof z.length==="number"){for(var x=0;x<z.length;x++){this.insertButton(z[x])}}else{this.insertButton({name:j.str("Ok"),func:function(E){w.close()}})}q(this);j.ctrl.initCtrls(A);this._isInitialize=true;this._isMoved=false;$(this._closeIcon).on("click",function(){D.close()});$(this._titleDiv).on("mousedown",function(H){if(H.target===D._closeIcon){return}var F=D[0].offsetLeft;var L=D[0].offsetTop;var E=H.clientX;var K=H.clientY;var G={width:r.offsetWidth,height:r.offsetHeight};j.mask();function I(M){j.unmask();$(document).off("mousemove",J);$(document).off("mouseup",I)}function J(O){var M=F+O.clientX-E;var N=L+O.clientY-K;if(M>G.width-w[0].offsetWidth){M=G.width-w[0].offsetWidth}if(M<0){M=0}if(N>G.height-w[0].offsetHeight){N=G.height-w[0].offsetHeight}if(N<0){N=0}w[0].style.left=M+"px";w[0].style.top=N+"px";w._isMoved=true}$(document).on("mousemove",J);$(document).on("mouseup",I)});$(this[0]).on(s,function(E){E.stopPropagation();E.preventDefault()});this._noRefresh=false;this[0].style.left="0px";this[0].style.top="0px";this.limitSize();this.refresh();this[0].focus();this.fire("open");this._sizeTimer=setInterval(function(){if(w._contentDiv.scrollHeight!==w._originScrollHeight||w._contentDiv.scrollWidth!==w._originScrollWidth){w.refresh();w._originScrollHeight=w._contentDiv.scrollHeight;w._originScrollWidth=w._contentDiv.scrollWidth}},100);return this};u.prototype.limitSize=function(){var w=this;setTimeout(function(){w._contentDiv.style.maxHeight="";w[0].style.maxWidth=r.offsetWidth+"px";w[0].style.maxHeight=r.offsetHeight+"px";w._contentDiv.style.maxHeight=r.offsetHeight-w._titleDiv.offsetHeight-w._buttonDiv.offsetHeight-$(w._contentDiv).outerHeight()+$(w._contentDiv).height()+"px";w._contentDiv.style.maxWidth=r.offsetWidth-$(w._contentDiv).outerWidth()+$(w._contentDiv).width()+"px";w.refresh()},0)};u.prototype.insertButton=function(y,w){if(!this[0]){return null}var x=j.ctrl.button();x.text(y.name);y.id&&x.id(y.id);y.cls&&x.addClass(y.cls);y.func&&x.on("click",y.func);if(typeof w==="number"&&!isNaN(w)){var z=this._buttonDiv.childNodes[w];if(z){this._buttonDiv.insertBefore(x.elem(),z)}else{this._buttonDiv.appendChild(x.elem())}}else{this._buttonDiv.appendChild(x.elem())}this.refresh();return x};u.prototype.removeButton=function(w){if(!this[0]){return}var x;if(typeof w==="number"){x=this._buttonDiv.childNodes[w]}else{if(w instanceof k.Button){x=w.elem()}}this._buttonDiv.removeChild(x)};u.prototype.button=function(w){if(!this[0]){return null}var x=this._buttonDiv.childNodes[w];if(x){return j.ctrl.button(x)}else{return null}};u.prototype.removeAllButtons=function(){if(!this[0]){return}this._buttonDiv.innerHTML=""};u.prototype.useesc=function(w){if(typeof w==="boolean"){this._useEsc=w;this.title(this.title())}else{return this._useEsc}};u.prototype.title=function(w){if(typeof w==="string"){if(!this[0]){return this}if(this._closeIcon.parentNode){this._closeIcon.parentNode.removeChild(this._closeIcon)}this._titleDiv.innerHTML=w;if(this._useEsc){this._titleDiv.appendChild(this._closeIcon)}this._titleText=w;this.refresh();return this}else{if(!this[0]){return null}return this._titleText}};u.prototype.close=function(){if(!this[0]){return}clearInterval(this._sizeTimer);n(this);this.elem(null);this._titleDiv=null;this._contentDiv=null;this._buttonDiv=null;this._closeIcon=null;this._titleText=null;if(this._placeHolder){this._placeHolder.parentNode&&this._placeHolder.parentNode.insertBefore(this._resourceElement,this._placeHolder);j.removeNode(this._placeHolder);this._placeHolder=null;if(this._hiddenOriginal){$(this._resourceElement).addClass("tui-hidden")}this._resourceElement=null}this.fire("close")};u.prototype.refresh=function(){if(!this[0]){return}if(this._noRefresh){return}var w={width:r.offsetWidth,height:r.offsetHeight};var A={left:this[0].offsetLeft,top:this[0].offsetTop,width:this[0].offsetWidth,height:this[0].offsetHeight};if(this._isInitialize){var z=m(this);var y,x;if(z){var B=z.elem();y=B.offsetLeft+B.offsetWidth/2;x=B.offsetTop+B.offsetHeight/2;this._isMoved=true}else{y=w.width/2;x=w.height/2;this._isMoved=false}A.left=y-A.width/2;A.top=x-A.height/2;this._isInitialize=false}else{if(!this._isMoved){A.left=(w.width-A.width)/2;A.top=(w.height-A.height)/2}}if(A.left+A.width>w.width){A.left=w.width-A.width}if(A.top+A.height>w.height){A.top=w.height-A.height}if(A.left<0){A.left=0}if(A.top<0){A.top=0}this[0].style.left=A.left+"px";this[0].style.top=A.top+"px"};u.CLASS="tui-dialog";return u})(k.Control);k.Dialog=p;function o(){return j.ctrl.control(null,p)}k.dialog=o;$(document).on("keydown",function(v){var u=v.keyCode;if(t.length<=0){return}var w=t[t.length-1];if(u===27){w.useesc()&&w.close()}else{if(u===9){setTimeout(function(){if(!w.isPosterity(document.activeElement)){w.focus()}},0)}}});$(window).resize(function(){for(var u=0;u<t.length;u++){t[u].limitSize();t[u].refresh()}})})(a=j.ctrl||(j.ctrl={}));function b(l,n){var m=j.ctrl.dialog();var k=document.createElement("div");k.className="tui-dlg-msg";k.innerHTML=l;m.showElement(k,n);return m}j.msgbox=b;function e(l,n){var m=j.ctrl.dialog();var k=document.createElement("div");k.className="tui-dlg-warp tui-dlg-info";k.innerHTML=l;m.showElement(k,n);return m}j.infobox=e;function i(l,n){var m=j.ctrl.dialog();var k=document.createElement("div");k.className="tui-dlg-warp tui-dlg-ok";k.innerHTML=l;m.showElement(k,n);return m}j.okbox=i;function h(l,n){var m=j.ctrl.dialog();var k=document.createElement("div");k.className="tui-dlg-warp tui-dlg-err";k.innerHTML=l;m.showElement(k,n);return m}j.errbox=h;function d(l,n){var m=j.ctrl.dialog();var k=document.createElement("div");k.className="tui-dlg-warp tui-dlg-warn";k.innerHTML=l;m.showElement(k,n);return m}j.warnbox=d;function f(m,o,p){var n=j.ctrl.dialog();var l=document.createElement("div");l.className="tui-dlg-warp tui-dlg-ask";l.innerHTML=m;var k=false;n.showElement(l,o,[{name:j.str("Ok"),func:function(){k=true;n.close()}},{name:j.str("Cancel"),func:function(){n.close()}}]);n.on("close",function(){if(typeof p==="function"){p(k)}});return n}j.askbox=f;function g(l,m){if(m===void 0){m=null}var n=j.ctrl.dialog();var k=document.createElement("div");k.className="tui-dlg-warp tui-dlg-wait";k.innerHTML=l;if(typeof m==="function"){n.showElement(k,null,[{name:j.str("Cancel"),func:function(){n.close();m()}}])}else{n.showElement(k,null,[])}n.useesc(false);return n}j.waitbox=g;function c(k,m,o,l,p,n){if(l===void 0){l=true}j.loadURL(k,function(r,s){if(typeof o==="function"&&o(r,s)===false){return}if(r==="success"){var q=/<body[^>]*>((?:.|[\r\n])*)<\/body>/gim.exec(s.responseText);if(q!=null){m.innerHTML=q[1]}else{m.innerHTML=s.responseText}j.ctrl.initCtrls(m)}else{j.errbox(j.str(r)+" ("+s.status+")",j.str("Failed"))}},l,p,n)}j.loadHTML=c})(tui||(tui={}));var tui;(function(a){var b;(function(c){var e=(function(f){__extends(g,f);function g(l){var r=this;f.call(this,"span",g.CLASS,l);this._btnThumb=null;this._btnHead=null;this._btnFoot=null;var w=this;this.attr("unselectable","on");this[0].innerHTML="";this._btnHead=document.createElement("span");this._btnHead.className="tui-scroll-head";this[0].appendChild(this._btnHead);this._btnThumb=document.createElement("span");this._btnThumb.className="tui-scroll-thumb";$(this._btnThumb).attr("unselectable","on");this[0].appendChild(this._btnThumb);this._btnFoot=document.createElement("span");this._btnFoot.className="tui-scroll-foot";this[0].appendChild(this._btnFoot);var p=null;var q=null;var n=null;function j(){if(p){clearTimeout(p);p=null}if(q){clearInterval(q);q=null}}function h(){var z=w.value();var x=w.total();var y=false;n.pos=Math.round(n.pos);n.step=Math.round(n.step);if(z===n.pos){return}if(!n.isIncrease){z-=n.step;if(z-(n.isPage?n.step/2:0)<=n.pos||z<=0){y=true;if(z<0){z=0}j()}w.value(z)}else{z+=n.step;if(z+(n.isPage?n.step/2:0)>=n.pos||z>=x){y=true;if(z>x){z=x}j()}w.value(z)}w.fire("scroll",{value:w.value(),type:"mousedown"});return y}function v(x){j();$(w._btnHead).removeClass("tui-actived");$(w._btnFoot).removeClass("tui-actived");$(a.unmask()).off("mouseup",v);$(document).off("mouseup",v)}$(this[0]).mousedown(function(B){a.fire("#tui.check.popup");if(!a.isLButton(B)){return}var A=B.target;if(A!==w[0]){B.stopPropagation();B.preventDefault();return}if(r.total()<=0){return}var y=w.direction();var C,z;if(y==="vertical"){C=(typeof B.offsetY==="number"?B.offsetY:B.originalEvent.layerY);z=r._btnThumb.offsetHeight}else{C=(typeof B.offsetX==="number"?B.offsetX:B.originalEvent.layerX);z=r._btnThumb.offsetWidth}var x=r.posToValue(C-z/2);n={pos:x,step:w.page(),isIncrease:x>w.value(),isPage:true};if(!h()){p=setTimeout(function(){p=null;q=setInterval(h,20)},300);$(a.mask()).on("mouseup",v);$(document).on("mouseup",v)}B.stopPropagation();B.preventDefault();return false});$(this._btnHead).mousedown(function(x){if(!a.isLButton(x)){return}if(w.total()<=0){return}$(w._btnHead).addClass("tui-actived");n={pos:0,step:w.step(),isIncrease:false,isPage:false};if(!h()){p=setTimeout(function(){p=null;q=setInterval(h,20)},300);$(a.mask()).on("mouseup",v);$(document).on("mouseup",v)}});$(this._btnFoot).mousedown(function(x){if(!a.isLButton(x)){return}if(w.total()<=0){return}$(w._btnFoot).addClass("tui-actived");n={pos:w.total(),step:w.step(),isIncrease:true,isPage:false};if(!h()){p=setTimeout(function(){p=null;q=setInterval(h,20)},300);$(a.mask()).on("mouseup",v);$(document).on("mouseup",v)}});var u=(/Firefox/i.test(navigator.userAgent))?"DOMMouseScroll":"mousewheel";$(this[0]).on(u,function(A){var z=A.originalEvent;var B=z.detail?z.detail*(-120):z.wheelDelta;var y=(Math.round(w.page()/2)>w.step()?Math.round(w.page()/2):w.step());var x=w.value();if(B<=-120){w.value(w.value()+y)}else{w.value(w.value()-y)}if(x!==w.value()){w.fire("scroll",{value:w.value(),type:"mousewheel"})}A.stopPropagation();A.preventDefault()});var k=0,i=0,o=0,s=0;function t(z){var y=0;var x=w.value();var A;if(w.direction()==="vertical"){y=z.clientY-i;A=s+y}else{y=z.clientX-k;A=o+y}w.value(w.posToValue(A));if(x!==w.value()){w.fire("scroll",{value:w.value(),type:"drag"})}}function m(x){$(a.unmask()).off("mousemove",t);$(document).off("mouseup",m);$(w._btnThumb).removeClass("tui-actived");w.fire("dragend",{value:w.value()})}$(this._btnThumb).mousedown(function(x){if(!a.isLButton(x)){return}k=x.clientX;i=x.clientY;o=w._btnThumb.offsetLeft;s=w._btnThumb.offsetTop;$(w._btnThumb).addClass("tui-actived");$(a.mask()).on("mousemove",t);$(document).on("mouseup",m);w.fire("dragbegin",{value:w.value()})});this.refresh()}g.prototype.total=function(h){if(typeof h==="number"){if(h<0){h=0}h=Math.round(h);this.attr("data-total",h);if(this.value()>h){this.value(h)}else{this.refresh()}return this}else{var h=parseInt(this.attr("data-total"),10);if(h===null||isNaN(h)){return 0}else{return h}}};g.prototype.value=function(h){if(typeof h==="number"){h=Math.round(h);if(h<0){h=0}if(h>this.total()){h=this.total()}this.attr("data-value",h);this.refresh();return this}else{var h=parseInt(this.attr("data-value"),10);if(h===null||isNaN(h)){return 0}else{return h}}};g.prototype.step=function(h){if(typeof h==="number"){h=Math.round(h);if(h<1){h=1}if(h>this.total()){h=this.total()}this.attr("data-step",h);if(h>this.page()){this.page(h)}else{this.refresh()}return this}else{var h=parseInt(this.attr("data-step"),10);if(h===null||isNaN(h)){return this.total()>0?1:0}else{return h}}};g.prototype.page=function(h){if(typeof h==="number"){h=Math.round(h);if(h<1){h=1}if(h>this.total()){h=this.total()}this.attr("data-page",h);if(h<this.step()){this.step(h)}else{this.refresh()}return this}else{var h=parseInt(this.attr("data-page"),10);if(h===null||isNaN(h)){return this.total()>0?1:0}else{return h}}};g.prototype.direction=function(i){if(typeof i==="string"){if(["horizontal","vertical"].indexOf(i)>=0){this.attr("data-direction",i);this.refresh()}return this}else{var h=this.attr("data-direction");if(h===null){return"vertical"}else{return h}}};g.prototype.logicLenToRealLen=function(i){var h=0;var j=this.total();if(j<=0){return 0}if(this.direction()==="vertical"){h=this[0].clientHeight-this._btnHead.offsetHeight-this._btnFoot.offsetHeight-this._btnThumb.offsetHeight}else{h=this[0].clientWidth-this._btnHead.offsetWidth-this._btnFoot.offsetWidth-this._btnThumb.offsetWidth}return i/j*h};g.prototype.posToValue=function(k){var i=this.total();if(i<=0){return 0}var h=0;var j=0;if(this.direction()==="vertical"){h=this[0].clientHeight-this._btnHead.offsetHeight-this._btnFoot.offsetHeight-this._btnThumb.offsetHeight;j=(k-this._btnHead.offsetHeight)/h*i}else{h=this[0].clientWidth-this._btnHead.offsetWidth-this._btnFoot.offsetWidth-this._btnThumb.offsetWidth;j=(k-this._btnHead.offsetWidth)/h*i}j=Math.round(j);return j};g.prototype.valueToPos=function(p){var o=this.total();var i=this.step();var m=this.page();var k=(this.direction()==="vertical");var h=(k?this._btnHead.offsetHeight:this._btnHead.offsetWidth);if(o<=0){return{pos:0,thumbLen:0}}var l=(k?this[0].clientHeight-this._btnHead.offsetHeight-this._btnFoot.offsetHeight:this[0].clientWidth-this._btnHead.offsetWidth-this._btnFoot.offsetWidth);var q=Math.round(m/o*l);if(q<h){q=h}if(q>l-10){q=l-10}var j=(p/o);if(j<0){j=0}if(j>1){j=1}var n=h+Math.round(j*(l-q))-1;return{pos:n,thumbLen:q}};g.prototype.refresh=function(){var i=this.valueToPos(this.value());var h=(this.direction()==="vertical");if(h){this._btnThumb.style.height=(i.thumbLen>0?i.thumbLen:0)+"px";this._btnThumb.style.top=i.pos+"px";this._btnThumb.style.left="";this._btnThumb.style.width=""}else{this._btnThumb.style.width=(i.thumbLen>0?i.thumbLen:0)+"px";this._btnThumb.style.left=i.pos+"px";this._btnThumb.style.top="";this._btnThumb.style.height=""}};g.CLASS="tui-scrollbar";return g})(c.Control);c.Scrollbar=e;function d(f){return a.ctrl.control(f,e)}c.scrollbar=d;a.ctrl.registerInitCallback(e.CLASS,d)})(b=a.ctrl||(a.ctrl={}))})(tui||(tui={}));var tui;(function(tui){var ctrl;(function(ctrl){var Table=(function(_super){__extends(Table,_super);function Table(el){_super.call(this,"table",ctrl.Grid.CLASS,el);this._splitters=[];this._columns=[];this._data=null;var self=this;this.addClass(Table.CLASS);this._columns=[];var noHead=this.noHead();var headLine=this.headLine();var headKeys=[];if(headLine){for(var i=0;i<headLine.cells.length;i++){var cell=headLine.cells[i];var colKey=$(cell).attr("data-key");if(!noHead){var col={name:cell.innerHTML,key:colKey?colKey:i};headKeys.push(colKey?colKey:i);this._columns.push(col)}else{headKeys.push(i);this._columns.push({name:"",key:i})}}}else{if(!this.hasAttr("data-columns")){this._columns=[]}}var data={head:headKeys,data:[]};for(var i=noHead?0:1;i<this[0].rows.length;i++){var row=this[0].rows[i];var rowData=[];for(var j=0;j<this._columns.length;j++){rowData.push(row.cells[j].innerHTML)}data.data.push(rowData)}this.data(data)}Table.prototype.headLine=function(){var tb=this[0];if(!tb){return null}return tb.rows[0]};Table.prototype.createSplitters=function(){var self=this;this._splitters.length=0;var tb=this[0];if(!tb){return}var headLine=this.headLine();if(!headLine){return}if(this.noHead()){return}for(var i=0;i<this._splitters.length;i++){tui.removeNode(this._splitters[i])}if(this.resizable()){for(var i=0;i<headLine.cells.length;i++){var cell=headLine.cells[i];var splitter=document.createElement("span");splitter.colIndex=i;splitter.className="tui-table-splitter";if(typeof this._columns[i].width!=="number"){this._columns[i].width=$(cell).width()}$(splitter).attr("unselectable","on");headLine.cells[i].appendChild(splitter);this._splitters.push(splitter);$(splitter).mousedown(function(e){var target=e.target;var l=target.offsetLeft;var srcX=e.clientX;target.style.height=self[0].clientHeight+"px";target.style.bottom="";$(target).addClass("tui-splitter-move");var mask=tui.mask();mask.style.cursor="col-resize";function onDragEnd(e){$(document).off("mousemove",onDrag);$(document).off("mouseup",onDragEnd);$(target).removeClass("tui-splitter-move");tui.unmask();var colIndex=target.colIndex;var tmpWidth=self._columns[colIndex].width+e.clientX-srcX;if(tmpWidth<0){tmpWidth=0}self._columns[colIndex].width=tmpWidth;self._columns[colIndex].important=true;self.refresh();self.fire("resizecolumn",colIndex)}function onDrag(e){target.style.left=l+e.clientX-srcX+"px"}$(document).mousemove(onDrag);$(document).mouseup(onDragEnd)})}}};Table.prototype.noHead=function(val){if(typeof val==="boolean"){this.is("data-no-head",val);this.data(this.data());return this}else{return this.is("data-no-head")}};Table.prototype.columns=function(val){if(val){this._columns=val;this.data(this.data());return this}else{if(!this._columns){var valstr=this.attr("data-columns");this._columns=eval("("+valstr+")")}return this._columns}};Table.prototype.value=function(data){if(data===null){return this.data([])}else{if(data){return this.data(data)}else{var result=[];var dt=this.data();for(var i=0;i<dt.length();i++){result.push(dt.at(i))}return result}}};Table.prototype.data=function(data){if(data){var self=this;if(data instanceof Array||data.data&&data.data instanceof Array){data=new tui.ArrayProvider(data)}if(typeof data.length!=="function"||typeof data.sort!=="function"||typeof data.at!=="function"||typeof data.columnKeyMap!=="function"){throw new Error("TUI Table: need a data provider.")}var tb=this[0];while(tb.rows.length>0){tb.deleteRow(0)}if(!this.noHead()){var row=tb.insertRow(-1);for(var j=0;j<this._columns.length;j++){var cell=row.insertCell(-1);cell.className="tui-table-head";if(["center","left","right"].indexOf(this._columns[j].headAlign)>=0){cell.style.textAlign=this._columns[j].headAlign}var contentDiv=cell.appendChild(document.createElement("div"));contentDiv.innerHTML=this._columns[j].name}}for(var i=0;i<data.length();i++){var rowData=data.at(i);var row=tb.insertRow(-1);for(var j=0;j<this._columns.length;j++){var cell=row.insertCell(-1);if(["center","left","right"].indexOf(this._columns[j].align)>=0){cell.style.textAlign=this._columns[j].align}var contentDiv=cell.appendChild(document.createElement("div"));var key;if(this._columns[j].key){key=this._columns[j].key}else{key=j}contentDiv.innerHTML=rowData[key]}}this.createSplitters();this.refresh();return this}else{return this._data}};Table.prototype.resizable=function(val){if(typeof val==="boolean"){this.is("data-resizable",val);this.createSplitters();this.refresh();return this}else{return this.is("data-resizable")}};Table.prototype.refresh=function(){if(!this.resizable()){return}var tb=this[0];if(!tb){return}var headLine=tb.rows[0];if(!headLine){return}var cellPadding=headLine.cells.length>0?$(headLine.cells[0]).outerWidth()-$(headLine.cells[0]).width():0;var defaultWidth=Math.floor(tb.offsetWidth/(headLine.cells.length>0?headLine.cells.length:1)-cellPadding);var totalWidth=0;var computeWidth=tb.offsetWidth-cellPadding*(headLine.cells.length>0?headLine.cells.length:1);for(var i=0;i<this._columns.length;i++){if(typeof this._columns[i].width!=="number"){this._columns[i].width=defaultWidth;totalWidth+=defaultWidth}else{if(!this._columns[i].important){totalWidth+=this._columns[i].width}else{if(this._columns[i].width>computeWidth){this._columns[i].width=computeWidth}if(this._columns[i].width<1){this._columns[i].width=1}computeWidth-=this._columns[i].width}}}for(var i=0;i<this._columns.length;i++){if(!this._columns[i].important){if(totalWidth===0){this._columns[i].width=0}else{this._columns[i].width=Math.floor(this._columns[i].width/totalWidth*computeWidth)}if(this._columns[i].width<1){this._columns[i].width=1}}else{this._columns[i].important=false}if(tb.rows.length>0){var row=tb.rows[0];$(row.cells[i]).css("width",this._columns[i].width+"px")}}var headLine=this.headLine();for(var i=0;i<this._splitters.length;i++){var splitter=this._splitters[i];var cell=headLine.cells[i];splitter.style.left=cell.offsetLeft+cell.offsetWidth-Math.round(splitter.offsetWidth/2)+"px";splitter.style.height=headLine.offsetHeight+"px"}};Table.CLASS="tui-table";return Table})(ctrl.Control);ctrl.Table=Table;function table(param){return tui.ctrl.control(param,Table)}ctrl.table=table;tui.ctrl.registerInitCallback(Table.CLASS,table)})(ctrl=tui.ctrl||(tui.ctrl={}))})(tui||(tui={}));var tui;(function(tui){var ctrl;(function(ctrl){var Grid=(function(_super){__extends(Grid,_super);function Grid(el){_super.call(this,"div",Grid.CLASS,el);this._tableId=tui.uuid();this._gridStyle=null;this._columns=null;this._emptyColumns=[];this._data=null;this._emptyData=new tui.ArrayProvider([]);this._splitters=[];this._scrollTop=0;this._scrollLeft=0;this._bufferedLines=[];this._bufferedBegin=0;this._bufferedEnd=0;this._dispLines=0;this._selectrows=[];this._activerow=null;this._noRefresh=false;this._initialized=false;this._drawingTimer=null;this._delayDrawing=true;var self=this;this.attr("tabIndex","0");this[0].innerHTML="";if(document.createStyleSheet){this._gridStyle=document.createStyleSheet()}else{this._gridStyle=document.createElement("style");document.head.appendChild(this._gridStyle)}this._headline=document.createElement("div");this._headline.className="tui-grid-head";this[0].appendChild(this._headline);this._hscroll=tui.ctrl.scrollbar();this._hscroll.direction("horizontal");this[0].appendChild(this._hscroll[0]);this._vscroll=tui.ctrl.scrollbar();this._vscroll.direction("vertical");this[0].appendChild(this._vscroll[0]);this._space=document.createElement("span");this._space.className="tui-scroll-space";this[0].appendChild(this._space);var scrollTimeDelay=(tui.ieVer>8?100:50);this._vscroll.on("scroll",function(data){if(!self._delayDrawing){self._scrollTop=data.value;self.drawLines()}else{var diff=Math.abs(data.value-self._scrollTop);self._scrollTop=data.value;if(diff<3*self._lineHeight&&self._drawingTimer===null){self.drawLines()}else{self.drawLines(true);clearTimeout(self._drawingTimer);self._drawingTimer=setTimeout(function(){self.clearBufferLines();self.drawLines();self._drawingTimer=null},scrollTimeDelay)}}});this._hscroll.on("scroll",function(data){self._scrollLeft=data.value;self.drawLines()});var mousewheelevt=(/Firefox/i.test(navigator.userAgent))?"DOMMouseScroll":"mousewheel";$(this[0]).on(mousewheelevt,function(ev){var e=ev.originalEvent;var delta=e.detail?e.detail*(-120):e.wheelDelta;var step=Math.round(self._vscroll.page()/2);var scrollSize=step>self._vscroll.step()?step:self._vscroll.step();if(delta<=-120){if(self._vscroll.value()<self._vscroll.total()){self._vscroll.value(self._vscroll.value()+scrollSize);self._scrollTop=self._vscroll.value();self.drawLines();ev.stopPropagation();ev.preventDefault()}else{if(self.consumeMouseWheelEvent()){ev.stopPropagation();ev.preventDefault()}}}else{if(self._vscroll.value()>0){self._vscroll.value(self._vscroll.value()-scrollSize);self._scrollTop=self._vscroll.value();self.drawLines();ev.stopPropagation();ev.preventDefault()}else{if(self.consumeMouseWheelEvent()){ev.stopPropagation();ev.preventDefault()}}}});$(this[0]).mousedown(function(e){tui.focusWithoutScroll(self[0]);e.preventDefault()});$(this[0]).keyup(function(e){self.fire("keyup",{event:e})});$(this[0]).on("contextmenu",function(e){return self.fire("contextmenu",{event:e})});$(this[0]).keydown(function(e){if(self.fire("keydown",{event:e})===false){return}var data=self.myData();var k=e.keyCode;if([33,34,37,38,39,40].indexOf(k)>=0){if(k===37){!self._hscroll.hidden()&&self._hscroll.value(self._hscroll.value()-self._hscroll.step());self._scrollLeft=self._hscroll.value();self.drawLines()}else{if(k===38){if(!self.rowselectable()||data.length()<=0){!self._vscroll.hidden()&&self._vscroll.value(self._vscroll.value()-self._vscroll.step());self._scrollTop=self._vscroll.value();self.drawLines()}else{if(self._activerow===null){self.activerow(0);self.scrollTo(self._activerow)}else{if(self._activerow>0){self.activerow(self._activerow-1)}self.scrollTo(self._activerow)}}}else{if(k===39){!self._hscroll.hidden()&&self._hscroll.value(self._hscroll.value()+self._hscroll.step());self._scrollLeft=self._hscroll.value();self.drawLines()}else{if(k===40){if(!self.rowselectable()||data.length()<=0){!self._vscroll.hidden()&&self._vscroll.value(self._vscroll.value()+self._vscroll.step());self._scrollTop=self._vscroll.value();self.drawLines()}else{if(self._activerow===null){self.activerow(0);self.scrollTo(self._activerow)}else{if(self._activerow<data.length()-1){self.activerow(self._activerow+1)}self.scrollTo(self._activerow)}}}else{if(k===33){if(!self.rowselectable()||data.length()<=0){!self._vscroll.hidden()&&self._vscroll.value(self._vscroll.value()-self._vscroll.page());self._scrollTop=self._vscroll.value();self.drawLines()}else{if(self._activerow===null){self.activerow(0);self.scrollTo(self._activerow)}else{if(self._activerow>0){self.activerow(self._activerow-self._dispLines)}self.scrollTo(self._activerow)}}}else{if(k===34){if(!self.rowselectable()||data.length()<=0){!self._vscroll.hidden()&&self._vscroll.value(self._vscroll.value()+self._vscroll.page());self._scrollTop=self._vscroll.value();self.drawLines()}else{if(self._activerow===null){self.activerow(self._dispLines);self.scrollTo(self._activerow)}else{if(self._activerow<data.length()-1){self.activerow(self._activerow+self._dispLines)}self.scrollTo(self._activerow)}}}}}}}}e.preventDefault();e.stopPropagation();if(tui.ieVer>0){self[0].setActive()}}else{if(k===tui.KEY_TAB){if((e.target||e.srcElement)===self[0]){var rowIndex;if(self.rowselectable()){rowIndex=self.activerow()}else{rowIndex=self._bufferedBegin}if(self.editRow(rowIndex)){e.preventDefault()}}}}});if(this.hasAttr("data-delay-drawing")){this._delayDrawing=this.is("data-delay-drawing")}var predefined=this.attr("data-data");if(predefined){predefined=eval("("+predefined+")")}if(predefined){this.data(predefined)}else{this.refresh()}}Grid.prototype.myData=function(){return this._data||this._emptyData};Grid.prototype.myColumns=function(){return this.columns()||this._emptyColumns};Grid.prototype.headHeight=function(){if(!this.noHead()){return this._headHeight}else{return 0}};Grid.colSize=function(size,def){if(typeof size==="number"&&!isNaN(size)){if(size<0){return 0}else{return Math.round(size)}}else{return def}};Grid.prototype.computeVScroll=function(mark){var hScrollbarHeight=this._hscroll.hidden()?0:this._hscroll[0].offsetHeight;var contentHeight=this._contentHeight;var innerHeight=this._boxHeight-hScrollbarHeight;var totalHeight=contentHeight+this.headHeight();this._dispLines=Math.ceil((innerHeight-this.headHeight())/this._lineHeight);var vHidden=this._vscroll.hidden();if(totalHeight>innerHeight){this._vscroll.hidden(false);this._vscroll[0].style.bottom=hScrollbarHeight+"px";this._vscroll.total(totalHeight-innerHeight).value(this._scrollTop).step(this._lineHeight).page(innerHeight/totalHeight*(totalHeight-innerHeight))}else{this._vscroll.hidden(true);this._vscroll.total(0)}this._scrollTop=this._vscroll.value();if(vHidden!==this._vscroll.hidden()){this.computeHScroll(mark);this.computeColumns()}};Grid.prototype.computeHScroll=function(mark){mark.isHScrollComputed=true;var columns=this.myColumns();var vScrollbarWidth=this._vscroll.hidden()?0:this._vscroll[0].offsetWidth;var innerWidth=this._boxWidth-vScrollbarWidth;var hHidden=this._hscroll.hidden();if(this.hasHScroll()){this._contentWidth=0;var cols=(columns.length<1?1:columns.length);var defaultWidth=Math.floor((innerWidth-this._borderWidth*cols)/cols);if(defaultWidth<100){defaultWidth=100}for(var i=0;i<columns.length;i++){this._contentWidth+=Grid.colSize(columns[i].width,defaultWidth)+this._borderWidth}if(this._contentWidth>innerWidth){this._hscroll.hidden(false);this._hscroll[0].style.right=vScrollbarWidth+"px";this._hscroll.total(this._contentWidth-innerWidth).value(this._scrollLeft).step(10).page(innerWidth/this._contentWidth*(this._contentWidth-innerWidth))}else{this._hscroll.hidden(true);this._hscroll.total(0)}}else{this._contentWidth=innerWidth;this._hscroll.hidden(true);this._hscroll.total(0)}this._scrollLeft=this._hscroll.value();if(hHidden!==this._hscroll.hidden()){this.computeVScroll(mark)}};Grid.prototype.computeScroll=function(){this._boxWidth=this[0].clientWidth;this._boxHeight=this[0].clientHeight;var cell=document.createElement("span");cell.className="tui-grid-cell";var line=document.createElement("span");line.className="tui-grid-line";line.appendChild(cell);cell.innerHTML="a";this[0].appendChild(line);this._lineHeight=$(line).outerHeight();this._borderWidth=$(cell).outerWidth()-$(cell).width();cell.className="tui-grid-head-cell";line.className="tui-grid-head";this._headHeight=line.offsetHeight;this[0].removeChild(line);this._contentHeight=this._lineHeight*this.myData().length();var mark={isHScrollComputed:false};this._hscroll.hidden(true);this._vscroll.hidden(true);this.computeVScroll(mark);if(!mark.isHScrollComputed){this.computeHScroll(mark);this.computeColumns()}if(!this._hscroll.hidden()&&!this._vscroll.hidden()){this._space.style.display=""}else{this._space.style.display="none"}};Grid.prototype.computeColumns=function(){var columns=this.myColumns();var vScrollbarWidth=this._vscroll.hidden()?0:this._vscroll[0].offsetWidth;var innerWidth=this._boxWidth-vScrollbarWidth;var cols=(columns.length<1?1:columns.length);var defaultWidth=Math.floor((innerWidth-this._borderWidth*cols)/cols);if(this.hasHScroll()){if(defaultWidth<100){defaultWidth=100}for(var i=0;i<columns.length;i++){delete columns[i]["_important"];columns[i].width=Grid.colSize(columns[i].width,defaultWidth)}}else{var totalNoBorderWidth=this._contentWidth-this._borderWidth*cols;totalNoBorderWidth+=(vScrollbarWidth===0?1:0);var totalNoFixedWidth=totalNoBorderWidth;var totalNeedComputed=0;var totalNeedComputedCount=0;var totalImportantWidth=0;var important=[];for(var i=0;i<columns.length;i++){if(columns[i]["fixed"]){if(typeof columns[i].width!=="number"||isNaN(columns[i].width)){columns[i].width=defaultWidth}totalNoFixedWidth-=columns[i].width}}if(totalNoFixedWidth<0){totalNoFixedWidth=0}var totalNoImportantWidth=totalNoFixedWidth;for(var i=0;i<columns.length;i++){if(typeof columns[i].width!=="number"||isNaN(columns[i].width)){columns[i].width=defaultWidth}else{if(columns[i].width<0){columns[i].width=0}}if(columns[i]["fixed"]){}else{if(columns[i]["_important"]){important.push(i);delete columns[i]["_important"];columns[i].width=Math.round(columns[i].width);if(columns[i].width>totalNoFixedWidth){columns[i].width=totalNoFixedWidth}totalImportantWidth+=columns[i].width;totalNoImportantWidth-=columns[i].width}else{totalNeedComputed+=Math.round(columns[i].width);totalNeedComputedCount++}}}if(totalNeedComputedCount>0&&totalNeedComputed===0){for(var i=0;i<columns.length;i++){if(important.indexOf(i)<0&&!columns[i]["fixed"]){columns[i].width=Math.floor(totalNoImportantWidth/totalNeedComputedCount)}}}else{for(var i=0;i<columns.length;i++){if(important.indexOf(i)<0&&!columns[i]["fixed"]){if(totalNeedComputed===0){columns[i].width=0}else{columns[i].width=Math.floor(Math.round(columns[i].width)/totalNeedComputed*totalNoImportantWidth)}}}}var total=0;for(var i=0;i<columns.length;i++){total+=columns[i].width}if(total<totalNoBorderWidth&&columns.length>0){for(var i=0;i<columns.length;i++){if(!columns[i].fixed){columns[i].width+=totalNoBorderWidth-total;break}}}}var cssText="";for(var i=0;i<columns.length;i++){var wd=columns[i].width;cssText+=(".tui-grid-"+this._tableId+"-"+i+"{width:"+wd+"px}")}if(document.createStyleSheet){this._gridStyle.cssText=cssText}else{this._gridStyle.innerHTML=cssText}};Grid.prototype.bindSplitter=function(cell,col,colIndex){var self=this;var splitter=document.createElement("span");splitter.className="tui-grid-splitter";splitter.setAttribute("unselectable","on");$(splitter).mousedown(function(e){var l=splitter.offsetLeft;var srcX=e.clientX;splitter.style.height=self[0].clientHeight+"px";splitter.style.bottom="";$(splitter).addClass("tui-splitter-move");var mask=tui.mask();mask.style.cursor="col-resize";function onDragEnd(e){$(document).off("mousemove",onDrag);$(document).off("mouseup",onDragEnd);tui.unmask();splitter.style.bottom="0";splitter.style.height="";$(splitter).removeClass("tui-splitter-move");col.width=col.width+e.clientX-srcX;col._important=true;var currentTime=tui.today().getTime();if(col._lastClickTime){if(currentTime-col._lastClickTime<500){self.autofitColumn(colIndex,false,true);self.fire("resizecolumn",{col:colIndex});return}}col._lastClickTime=currentTime;self.refresh();self.fire("resizecolumn",{col:colIndex})}function onDrag(e){splitter.style.left=l+e.clientX-srcX+"px"}$(document).on("mousemove",onDrag);$(document).on("mouseup",onDragEnd)});this._splitters.push(splitter);return splitter};Grid.prototype.bindSort=function(cell,col,colIndex){var self=this;if(col.sort){$(cell).addClass("tui-grid-sortable");$(cell).mousedown(function(event){if(!tui.isLButton(event)){return}if(self._sortColumn!==colIndex){self.sort(colIndex)}else{if(!self._sortDesc){self.sort(colIndex,true)}else{self.sort(null)}}})}if(self._sortColumn===colIndex){if(self._sortDesc){$(cell).addClass("tui-grid-cell-sort-desc")}else{$(cell).addClass("tui-grid-cell-sort-asc")}}};Grid.prototype.moveSplitter=function(){for(var i=0;i<this._splitters.length;i++){var splitter=this._splitters[i];var cell=this._headline.childNodes[i];splitter.style.left=cell.offsetLeft+cell.offsetWidth-Math.round(splitter.offsetWidth/2)+"px"}};Grid.prototype.drawCell=function(cell,contentSpan,col,colKey,value,row,rowIndex,colIndex){if(rowIndex>=0){if(["center","left","right"].indexOf(col.align)>=0){cell.style.textAlign=col.align}}else{if(["center","left","right"].indexOf(col.headAlign)>=0){cell.style.textAlign=col.headAlign}}if(value===null||typeof value===tui.undef){contentSpan.innerHTML=""}else{if(typeof value==="object"&&value.nodeName){contentSpan.innerHTML="";contentSpan.appendChild(value)}else{contentSpan.innerHTML=value}}if(typeof col.format==="function"){col.format.call(this,{cell:cell,value:value,row:row,col:col,colKey:colKey,rowIndex:rowIndex,colIndex:colIndex,isRowActived:rowIndex===this._activerow,grid:this})}if(this._sortColumn===colIndex){$(cell).addClass("tui-grid-sort-cell")}else{$(cell).removeClass("tui-grid-sort-cell")}};Grid.prototype.drawHead=function(){if(this.noHead()){$(this._headline).addClass("tui-hidden");return}$(this._headline).removeClass("tui-hidden");var columns=this.myColumns();this._headline.innerHTML="";this._splitters.length=0;for(var i=0;i<columns.length;i++){var col=columns[i];var key=null;if(typeof col.key!==tui.undef&&col.key!==null){key=this.myData().mapKey(col.key);if(typeof key===tui.undef){key=col.key}}var cell=document.createElement("span");cell.setAttribute("unselectable","on");cell.className="tui-grid-head-cell tui-grid-"+this._tableId+"-"+i;this._headline.appendChild(cell);var contentSpan=document.createElement("span");contentSpan.className="tui-grid-cell-content";cell.appendChild(contentSpan);this.drawCell(cell,contentSpan,col,key,col.name,null,-1,i);this.bindSort(cell,col,i);if(this.resizable()){var splitter=this.bindSplitter(cell,col,i);if(typeof columns[i].fixed==="boolean"&&columns[i].fixed){$(splitter).addClass("tui-hidden")}}}for(var i=0;i<this._splitters.length;i++){var splitter=this._splitters[i];this._headline.appendChild(splitter)}this.moveSplitter()};Grid.prototype.isRowSelected=function(rowIndex){return this._selectrows.indexOf(rowIndex)>=0};Grid.prototype.drawLine=function(line,index,empty){var columns=this.myColumns();if(line.childNodes.length!==columns.length){line.innerHTML="";var rowSel=this.rowselectable();for(var i=0;i<columns.length;i++){var cell=document.createElement("span");if(rowSel){cell.setAttribute("unselectable","on")}cell.className="tui-grid-cell tui-grid-"+this._tableId+"-"+i;line.appendChild(cell)}}if(empty){return}var self=this;var data=this.myData();var rowData=data.at(index);for(var i=0;i<line.childNodes.length;i++){var cell=line.childNodes[i];cell.innerHTML="";var contentSpan=document.createElement("span");contentSpan.className="tui-grid-cell-content";cell.appendChild(contentSpan);var col=columns[i];var key=null;if(typeof col.key!==tui.undef){key=data.mapKey(col.key)}var value=(key!==null&&rowData?rowData[key]:"");this.drawCell(cell,contentSpan,col,key,value,rowData,index,i)}var jqLine=$(line);jqLine.on("contextmenu",function(e){return self.fire("rowcontextmenu",{event:e,index:index,row:line})});var dragIndex=null;var mouseDownPt=null;jqLine.mousedown(function(e){if(self.rowselectable()){self.activerow(index);self.scrollTo(index)}if(self.fire("rowmousedown",{event:e,index:index,row:line})===false){return}if(self.rowdraggable()&&tui.isLButton(e)){mouseDownPt={x:e.clientX,y:e.clientY};dragIndex=null;function testdrag(e){if(mouseDownPt===null||dragIndex!==null){return}if(Math.abs(e.clientX-mouseDownPt.x)<5&&Math.abs(e.clientY-mouseDownPt.y)<5){return}if(self.fire("rowdragstart",{event:e,index:index,row:line})===false){return}jqLine.addClass("tui-grid-line-drag");dragIndex=index;var m=tui.mask();m.setAttribute("data-cursor-tooltip","true");self.focus();var upTimer=null;var downTimer=null;var firstScroll=true;var lineHeight=self.lineHeight();var headHeight=self.headHeight();var targetBox=document.createElement("div");var targetIndex=null;var position=null;targetBox.className="tui-grid-line-drop";function fireBefore(targetLine){if(self.fire("rowdragover",{event:e,index:dragIndex,targetIndex:targetIndex,position:"before"})!==false){targetBox.style.top=targetLine.offsetTop-2+"px";targetBox.style.height="3px";targetBox.className="tui-grid-line-drop-before";m.setAttribute("data-tooltip","<i class='fa fa-level-up'></i> Move before ...");position="before";return true}else{return false}}function fireAfter(targetLine){if(self.fire("rowdragover",{event:e,index:dragIndex,targetIndex:targetIndex,position:"after"})!==false){targetBox.style.top=targetLine.offsetTop+targetLine.offsetHeight-2+"px";targetBox.style.height="3px";targetBox.className="tui-grid-line-drop-after";m.setAttribute("data-tooltip","<i class='fa fa-level-down'></i> Move after ...");position="after";return true}else{return false}}function fireInside(targetLine){if(self.fire("rowdragover",{event:e,index:dragIndex,targetIndex:targetIndex,position:"inside"})!==false){targetBox.style.top=targetLine.offsetTop-2+"px";targetBox.style.height=targetLine.clientHeight+"px";targetBox.className="tui-grid-line-drop";m.setAttribute("data-tooltip","<i class='fa fa-arrow-right'></i> Move into ...");position="inside";return true}else{return false}}function move(e){if(!tui.isLButton(e)){targetIndex=null;position=null;release(e,true);return}var x=e.clientX;var y=e.clientY;var pos=tui.fixedPosition(self[0]);if(x<pos.x||x>pos.x+self[0].offsetWidth||y<pos.y||y>pos.y+self[0].offsetHeight){m.style.cursor="not-allowed"}else{m.style.cursor="move"}if(y<pos.y+headHeight){clearInterval(downTimer);downTimer=null;upTimer===null&&(upTimer=setInterval(function(){if(firstScroll){self.scrollTo(self._bufferedBegin)}else{if(self._bufferedBegin>0){self.scrollTo(self._bufferedBegin-1)}}firstScroll=false},80))&&(firstScroll=true);tui.removeNode(targetBox);targetIndex=null;position=null;m.removeAttribute("data-tooltip")}else{if(y>pos.y+self[0].offsetHeight){clearInterval(upTimer);upTimer=null;downTimer===null&&(downTimer=setInterval(function(){if(firstScroll){self.scrollTo(self._bufferedEnd-1)}else{if(self._bufferedEnd<=self._data.length()){self.scrollTo(self._bufferedEnd-1)}}firstScroll=false},80))&&(firstScroll=true);tui.removeNode(targetBox);targetIndex=null;position=null;m.removeAttribute("data-tooltip")}else{clearInterval(downTimer);clearInterval(upTimer);downTimer=null;upTimer=null;var base=headHeight-self._scrollTop%lineHeight;targetIndex=Math.floor((y-(pos.y+base))/lineHeight);var targetLine=self._bufferedLines[targetIndex];if(!targetLine){targetIndex=self._bufferedEnd-1;return}else{targetIndex+=self._bufferedBegin}if(targetIndex===dragIndex){tui.removeNode(targetBox);targetIndex=null;return}pos=tui.fixedPosition(targetLine);targetBox.style.left=targetLine.offsetLeft-2+"px";targetBox.style.width=targetLine.offsetWidth+"px";if(y-pos.y<=12){if(!fireBefore(targetLine)){fireInside(targetLine)}}else{if(pos.y+targetLine.offsetHeight-y<=12){if(!fireAfter(targetLine)){fireInside(targetLine)}}else{if(!fireInside(targetLine)){if(y-pos.y<=lineHeight/2){fireBefore(targetLine)}else{fireAfter(targetLine)}}}}self[0].appendChild(targetBox)}}}function release(env,canceled){jqLine.removeClass("tui-grid-line-drag");console.debug("mouse release");mouseDownPt=null;clearInterval(downTimer);clearInterval(upTimer);downTimer=null;upTimer=null;tui.removeNode(targetBox);$(m).off("mousemove",move);$(m).off("mouseup",release);$(document).off("mouseup",release);$(self[0]).off("keydown",keydown);tui.unmask();tui.closeTooltip();self.fire("rowdragend",{event:env,index:dragIndex,targetIndex:targetIndex,position:position,canceled:!!canceled});dragIndex=null}function keydown(e){if(e.keyCode===tui.KEY_ESC){targetIndex=null;position=null;release(e,true);e.stopPropagation()}}$(m).on("mousemove",move);$(m).on("mouseup",release);$(document).on("mouseup",release);$(self[0]).on("keydown",keydown)}function release(){mouseDownPt=null;$(document).off("mouseup",release);$(document).off("mousemove",testdrag)}$(document).on("mouseup",release);$(document).on("mousemove",testdrag)}});jqLine.mouseenter(function(e){self.fire("rowmouseenter",{event:e,index:index,row:line})});jqLine.mouseleave(function(e){self.fire("rowmouseleave",{event:e,index:index,row:line})});jqLine.mouseup(function(e){self.fire("rowmouseup",{event:e,index:index,row:line})});jqLine.on("click",function(e){self.fire("rowclick",{event:e,index:index,row:line})});jqLine.on("dblclick",function(e){self.fire("rowdblclick",{event:e,index:index,row:line})})};Grid.prototype.moveLine=function(line,index,base){line.style.top=(base+index*this._lineHeight)+"px";line.style.left=-this._scrollLeft+"px"};Grid.prototype.drawLines=function(empty){if(empty===void 0){empty=false}this._headline.style.left=-this._scrollLeft+"px";var base=this.headHeight()-this._scrollTop%this._lineHeight;var begin=Math.floor(this._scrollTop/this._lineHeight);var newBuffer=[];var data=this.myData();for(var i=begin;i<begin+this._dispLines+1&&i<data.length();i++){if(i>=this._bufferedBegin&&i<this._bufferedEnd){var line=this._bufferedLines[i-this._bufferedBegin];this.moveLine(line,i-begin,base);newBuffer.push(line)}else{var line=document.createElement("div");line.className="tui-grid-line";this[0].appendChild(line);newBuffer.push(line);line._rowIndex=i;this.drawLine(line,i,empty);this.moveLine(line,i-begin,base)}if(this.isRowSelected(i)){$(line).addClass("tui-grid-line-selected")}else{$(line).removeClass("tui-grid-line-selected")}}var end=i;for(var i=this._bufferedBegin;i<this._bufferedEnd;i++){if(i<begin||i>=end){this[0].removeChild(this._bufferedLines[i-this._bufferedBegin])}}this._bufferedLines=newBuffer;this._bufferedBegin=begin;this._bufferedEnd=end};Grid.prototype.clearBufferLines=function(){if(!this[0]){return}for(var i=0;i<this._bufferedLines.length;i++){var l=this._bufferedLines[i];this[0].removeChild(l)}this._bufferedLines=[];this._bufferedEnd=this._bufferedBegin=0};Grid.prototype.lineHeight=function(){if(typeof this._lineHeight!==tui.undef){return this._lineHeight}else{var grid=document.createElement("div");grid.className=this[0].className;var line=document.createElement("div");line.className="tui-grid-line";grid.appendChild(line);document.body.appendChild(grid);var lineHeight=line.offsetHeight;document.body.removeChild(grid);return lineHeight}};Grid.prototype.select=function(rows){if(rows&&typeof rows.length==="number"&&rows.length>=0){this._selectrows.length=0;for(var i=0;i<rows.length;i++){this._selectrows.push(rows[i])}this.drawLines()}return this._selectrows};Grid.prototype.activerow=function(rowIndex){if(typeof rowIndex==="number"||rowIndex===null){if(rowIndex<0){rowIndex=0}if(rowIndex>=this.myData().length()){rowIndex=this.myData().length()-1}this._activerow=rowIndex;if(rowIndex===null){this.select([])}else{this.select([rowIndex])}}return this._activerow};Grid.prototype.activeItem=function(rowItem){var data=this.myData();if(typeof rowItem!==tui.undef){if(rowItem===null){this.activerow(null)}else{for(var i=0;i<data.length();i++){if(data.at(i)===rowItem){this.activerow(i);break}}}}if(this._activerow!==null){return data.at(this._activerow)}else{return null}};Grid.prototype.sort=function(colIndex,desc){if(desc===void 0){desc=false}var columns=this.myColumns();if(colIndex===null){this._sortColumn=null;this.myData().sort(null,desc);this._sortDesc=false}else{if(typeof colIndex==="number"&&!isNaN(colIndex)&&colIndex>=0&&colIndex<columns.length&&columns[colIndex].sort){this._sortColumn=colIndex;this._sortDesc=desc;if(typeof columns[colIndex].sort==="function"){this.myData().sort(columns[colIndex].key,this._sortDesc,columns[colIndex].sort)}else{this.myData().sort(columns[colIndex].key,this._sortDesc)}}}this._sortDesc=!!desc;this._scrollTop=0;this.activerow(null);this._initialized=false;this.refresh();return{colIndex:this._sortColumn,desc:this._sortDesc}};Grid.prototype.autofitColumn=function(columnIndex,expandOnly,displayedOnly){if(expandOnly===void 0){expandOnly=false}if(displayedOnly===void 0){displayedOnly=true}if(typeof(columnIndex)!=="number"){return}var columns=this.myColumns();if(columnIndex<0&&columnIndex>=columns.length){return}var col=columns[columnIndex];var maxWidth=0;if(expandOnly){maxWidth=col.width||0}var cell=document.createElement("span");cell.className="tui-grid-cell";cell.style.position="absolute";cell.style.visibility="hidden";cell.style.width="auto";document.body.appendChild(cell);var data=this.myData();var key=null;if(typeof col.key!==tui.undef&&col.key!==null){key=data.mapKey(col.key);if(typeof key===tui.undef){key=col.key}}var begin=displayedOnly?this._bufferedBegin:0;var end=displayedOnly?this._bufferedEnd:data.length();for(var i=begin;i<end;i++){var rowData=data.at(i);var v=rowData[key];if(typeof v==="object"&&v.nodeName){cell.innerHTML="";cell.appendChild(v)}else{cell.innerHTML=v}if(typeof col.format==="function"){col.format({cell:cell,value:v,row:rowData,col:col,colKey:key,rowIndex:i,colIndex:columnIndex,isRowActived:i===this._activerow,grid:this})}if(maxWidth<cell.offsetWidth-this._borderWidth){maxWidth=cell.offsetWidth-this._borderWidth}}document.body.removeChild(cell);col.width=maxWidth;col._important=true;this._initialized=false;this.refresh()};Grid.prototype.delayDrawing=function(val){if(typeof val==="boolean"){this.is("data-delay-drawing",val);this._delayDrawing=val;return this}else{return this._delayDrawing}};Grid.prototype.hasHScroll=function(val){if(typeof val==="boolean"){this.is("data-has-hscroll",val);this._initialized=false;this.refresh();return this}else{return this.is("data-has-hscroll")}};Grid.prototype.noHead=function(val){if(typeof val==="boolean"){this.is("data-no-head",val);this._initialized=false;this.refresh();return this}else{return this.is("data-no-head")}};Grid.prototype.columns=function(val){if(val){this._columns=val;this._initialized=false;this.refresh();return this}else{if(!this._columns){var valstr=this.attr("data-columns");this._columns=eval("("+valstr+")")}return this._columns}};Grid.prototype.rowselectable=function(val){if(typeof val==="boolean"){this.is("data-rowselectable",val);this._initialized=false;this.refresh();return this}else{return this.is("data-rowselectable")}};Grid.prototype.rowdraggable=function(val){if(typeof val==="boolean"){this.is("data-rowdraggable",val);return this}else{return this.is("data-rowdraggable")}};Grid.prototype.scrollTo=function(rowIndex){if(typeof rowIndex!=="number"||isNaN(rowIndex)||rowIndex<0||rowIndex>=this.myData().length()){return}var v=this._vscroll.value();if(v>rowIndex*this._lineHeight){this._vscroll.value(rowIndex*this._lineHeight);this._scrollTop=this._vscroll.value();this.drawLines()}else{var h=(rowIndex-this._dispLines+1)*this._lineHeight;var diff=(this._boxHeight-this.headHeight()-this._hscroll[0].offsetHeight-this._dispLines*this._lineHeight);if(v<h-diff){this._vscroll.value(h-diff);this._scrollTop=this._vscroll.value();this.drawLines()}}};Grid.prototype.editCell=function(rowIndex,colIndex){if(typeof rowIndex!=="number"||rowIndex<0||rowIndex>=this.myData().length()){return false}if(typeof colIndex!=="number"||colIndex<0||colIndex>=this.columns().length){return false}if(this.rowselectable()){this.activerow(rowIndex)}this.scrollTo(rowIndex);var line=this._bufferedLines[rowIndex-this._bufferedBegin];var cell=line.childNodes[colIndex];if(cell.childNodes[1]&&cell.childNodes[1]["_ctrl"]){cell.childNodes[1]["_ctrl"].focus();return true}else{if(cell.childNodes[0]&&cell.childNodes[0].childNodes[0]&&cell.childNodes[0].childNodes[0]["_ctrl"]){cell.childNodes[0].childNodes[0]["_ctrl"].focus();return true}else{return false}}};Grid.prototype.editRow=function(rowIndex){if(typeof rowIndex!=="number"||rowIndex<0||rowIndex>=this.myData().length()){return false}for(var i=0;i<this._columns.length;i++){if(this.editCell(rowIndex,i)){return true}}return false};Grid.prototype.resizable=function(val){if(typeof val==="boolean"){this.is("data-resizable",val);this._initialized=false;this.refresh();return this}else{return this.is("data-resizable")}};Grid.prototype.value=function(data){if(data===null){return this.data([])}else{if(data){return this.data(data)}else{var result=[];var dt=this.data();for(var i=0;i<dt.length();i++){result.push(dt.at(i))}return result}}};Grid.prototype.data=function(data){var _this=this;if(data){var self=this;if(data instanceof Array||data.data&&data.data instanceof Array){data=new tui.ArrayProvider(data)}if(typeof data.length!=="function"||typeof data.sort!=="function"||typeof data.at!=="function"||typeof data.columnKeyMap!=="function"){this._initialized=false;this.refresh();throw new Error("TUI Grid: need a data provider.")}this._data&&this._data.onupdate&&this._data.onupdate(null);this._data=data;typeof this._data.onupdate==="function"&&this._data.onupdate(function(updateInfo){var b=updateInfo.begin;var e=b+updateInfo.data.length;_this._initialized=false;self.refresh()});this._initialized=false;this.refresh();return this}else{return this.myData()}};Grid.prototype.consumeMouseWheelEvent=function(val){if(typeof val==="boolean"){this.is("data-consume-mwe",val);return this}else{return this.is("data-consume-mwe")}};Grid.prototype.noRefresh=function(val){if(typeof val==="boolean"){this._noRefresh=val;return this}else{return this._noRefresh}};Grid.prototype.refreshHead=function(){this.drawHead()};Grid.prototype.refresh=function(){if(this._noRefresh){return}if(!this[0]||this[0].parentElement===null){return}if(this[0].offsetWidth===0||this[0].offsetHeight===0){return}this._initialized=true;this.computeScroll();this.clearBufferLines();this.drawHead();this.drawLines()};Grid.prototype.autoRefresh=function(){return !this._initialized};Grid.menu=function(itemMenu,func,menuPos){if(menuPos===void 0){menuPos="Rb"}return function(data){if(data.rowIndex<0){return}var tb=data.grid;var array=data.grid.data().src();data.cell.firstChild.innerHTML="";var btnMenu=tui.ctrl.button();btnMenu.addClass("tui-grid-menu-button");btnMenu.text("<i class='fa fa-bars'></i>");if(typeof itemMenu==="function"){btnMenu.menu(itemMenu(data))}else{btnMenu.menu(itemMenu)}btnMenu.menuPos(menuPos);data.cell.firstChild.appendChild(btnMenu[0]);btnMenu.on("select",function(d){func&&func(d.item,data)});$(btnMenu[0]).mousedown(function(e){data.grid.editCell(data.rowIndex,data.colIndex);e.stopPropagation();tui.fire("#tui.check.popup")});$(btnMenu[0]).keydown(function(e){handleKeyDownEvent(e,data,"button")})}};Grid.button=function(text,func){return function(data){if(data.rowIndex<0){return}var tb=data.grid;var array=data.grid.data().src();data.cell.firstChild.innerHTML="";var btnMenu=tui.ctrl.button();btnMenu.text(text);data.cell.firstChild.appendChild(btnMenu[0]);btnMenu.on("click",function(){func&&func(data)});$(btnMenu[0]).mousedown(function(e){data.grid.editCell(data.rowIndex,data.colIndex);e.stopPropagation();tui.fire("#tui.check.popup")});$(btnMenu[0]).keydown(function(e){handleKeyDownEvent(e,data,"button")})}};Grid.checkbox=function(withHeader){if(withHeader===void 0){withHeader=true}return function(data){if(data.rowIndex<0){if(withHeader){var headCheck=tui.ctrl.checkbox();data.cell.firstChild.innerHTML="";data.cell.firstChild.appendChild(headCheck[0]);data.cell.style.textAlign="center";var dataSet=data.grid.data();var totalLen=dataSet.length();var checkedCount=0;var uncheckCount=0;for(var i=0;i<totalLen;i++){if(dataSet.at(i)[data.colKey]){checkedCount++}else{uncheckCount++}}if(totalLen===uncheckCount){headCheck.checked(false);headCheck.triState(false)}else{if(totalLen===checkedCount){headCheck.checked(true);headCheck.triState(false)}else{headCheck.triState(true)}}headCheck.on("click",function(){if(typeof data.colKey!==tui.undef){for(var i=0;i<totalLen;i++){dataSet.at(i)[data.colKey]=headCheck.checked()}}data.value=headCheck.checked();data.grid.refresh()})}return}else{data.cell.firstChild.innerHTML="";var chk=tui.ctrl.checkbox();data.cell.firstChild.appendChild(chk[0]);data.cell.style.textAlign="center";chk.checked(data.value);chk.on("click",function(){if(typeof data.colKey!==tui.undef){data.row[data.colKey]=chk.checked()}data.value=chk.checked();data.grid.refreshHead()});$(chk[0]).keydown(function(e){handleKeyDownEvent(e,data,"checkbox")})}}};Grid.textEditor=function(listData){return createInputFormatter("text",listData)};Grid.selector=function(listData){return createInputFormatter("select",listData)};Grid.fileSelector=function(address,accept){return createInputFormatter("file",address,accept)};Grid.calendarSelector=function(){return createInputFormatter("calendar")};Grid.customSelector=function(func,icon){if(icon===void 0){icon="fa-ellipsis-h"}return createInputFormatter("custom-select",func,icon)};Grid.CLASS="tui-grid";return Grid})(ctrl.Control);ctrl.Grid=Grid;function handleKeyDownEvent(e,data,type){var k=e.keyCode;var col,row;if(k===tui.KEY_DOWN){if(data.rowIndex<data.grid.data().length()-1){data.grid.editCell(data.rowIndex+1,data.colIndex)}e.stopPropagation();e.preventDefault()}else{if(k===tui.KEY_UP){if(data.rowIndex>0){data.grid.editCell(data.rowIndex-1,data.colIndex)}e.stopPropagation();e.preventDefault()}else{if(k===tui.KEY_LEFT){if(type!=="text"||e.ctrlKey){col=data.colIndex-1;while(col>=0){if(data.grid.editCell(data.rowIndex,col--)){break}}}e.stopPropagation()}else{if(k===tui.KEY_RIGHT){if(type!=="text"||e.ctrlKey){col=data.colIndex+1;while(col<data.grid.columns().length){if(data.grid.editCell(data.rowIndex,col++)){break}}}e.stopPropagation()}else{if(k===tui.KEY_TAB&&e.shiftKey){col=data.colIndex;row=data.rowIndex;while(row>=0&&col>=0){col--;if(col<0){col=data.grid.columns().length-1;row--}if(data.grid.editCell(row,col)){break}}e.preventDefault();e.stopPropagation()}else{if(k===tui.KEY_TAB){col=data.colIndex;row=data.rowIndex;while(row<data.grid.data().length()&&col<data.grid.columns().length){col++;if(col>=data.grid.columns().length){col=0;row++}if(data.grid.editCell(row,col)){break}}e.preventDefault();e.stopPropagation()}else{if(type==="text"){data.grid.editCell(data.rowIndex,data.colIndex)}}}}}}}}function createInputFormatter(type,param1,param2){return function(data){if(data.rowIndex<0){return}var editor=tui.ctrl.input(null,type);editor.useLabelClick(false);editor.addClass("tui-grid-editor");editor.on("select change",function(){if(typeof data.colKey!==tui.undef){data.row[data.colKey]=editor.value()}data.value=editor.value()});if(type==="text"){if(param1){editor.data(param1)}}else{if(type==="select"){editor.data(param1)}else{if(type==="custom-select"){editor.on("btnclick",param1);editor.icon(param2)}else{if(type==="calendar"){}else{if(type==="file"){editor.uploadUrl(param1);editor.accept(param2)}}}}}$(editor[0]).mousedown(function(e){data.grid.editCell(data.rowIndex,data.colIndex);e.stopPropagation();tui.fire("#tui.check.popup")});$(editor[0]).keydown(function(e){handleKeyDownEvent(e,data,type)});editor[0].style.width=$(data.cell).innerWidth()-1+"px";editor[0].style.height=$(data.cell).innerHeight()-1+"px";data.cell.appendChild(editor[0]);editor.value(data.value)}}function grid(param){return tui.ctrl.control(param,Grid)}ctrl.grid=grid;tui.ctrl.registerInitCallback(Grid.CLASS,grid)})(ctrl=tui.ctrl||(tui.ctrl={}))})(tui||(tui={}));var tui;(function(a){var b;(function(f){var c;(function(g){g[g.Unchecked=0]="Unchecked";g[g.Checked=1]="Checked";g[g.HalfChecked=2]="HalfChecked"})(c||(c={}));var d=(function(h){__extends(g,h);function g(k){var l=this;h.call(this,"div",g.CLASS,null);var i=this;this._grid=f.grid(k);this._grid.noRefresh(true);this[0]=this._grid[0];this[0]._ctrl=this;this.addClass(g.CLASS);var j=this._grid.columns();if(j===null){this._grid.columns([{key:"value",format:function(q){if(q.rowIndex<0){return}var y=l.rowcheckable();var z=q.cell.firstChild;var u=q.row[l._iconColumnKey];var m=!!q.row[l._expandColumnKey];var x=(typeof q.row[l._checkedColumnKey]!==a.undef);var r=!!q.row[l._checkedColumnKey];var s=!!q.row[l._childrenColumKey]&&q.row[l._childrenColumKey].length>0;var o=(l.triState()&&q.row[l._checkedColumnKey]===2);var A=document.createElement("span");A.className="tui-list-space";var t=document.createElement("span");t.className="tui-list-fold";if(s){if(m){$(t).addClass("tui-list-fold-expand");$(t).mousedown(function(B){l.onFoldRow(q.row,q.rowIndex,B)})}else{$(t).addClass("tui-list-fold-unexpand");$(t).mousedown(function(B){l.onExpandRow(q.row,q.rowIndex,B)})}}if(typeof u==="string"){var w=document.createElement("i");w.className="fa "+u;w.style.marginRight="4px";z.insertBefore(w,z.firstChild)}if(x&&y){var p=document.createElement("span");p.className="tui-list-checkbox";if(r){if(o){$(p).addClass("tui-half-checked")}else{$(p).addClass("tui-checked")}}z.insertBefore(p,z.firstChild);$(p).mouseup(function(B){l.onCheckRow(q.row,q.rowIndex,B)})}z.insertBefore(t,z.firstChild);z.insertBefore(A,z.firstChild);var v=A.offsetWidth;var n=q.row[l._levelColumnKey];A.style.width=v*(typeof n==="number"?n:0)+"px"}}])}this._grid.on("rowclick",function(m){return l.fire("rowclick",m)});this._grid.on("rowdblclick",function(m){return l.fire("rowdblclick",m)});this._grid.on("rowmousedown",function(m){return l.fire("rowmousedown",m)});this._grid.on("rowdragstart",function(m){return l.fire("rowdragstart",m)});this._grid.on("rowdragover",function(m){return l.fire("rowdragover",m)});this._grid.on("rowdragend",function(m){return l.fire("rowdragend",m)});this._grid.on("rowmouseup",function(m){return l.fire("rowmouseup",m)});this._grid.on("rowmouseenter",function(m){return l.fire("rowmouseenter",m)});this._grid.on("rowmouseleave",function(m){return l.fire("rowmouseleave",m)});this._grid.on("rowcontextmenu",function(m){return l.fire("rowcontextmenu",m)});this._grid.on("resizecolumn",function(m){return l.fire("resizecolumn",m)});this._grid.on("contextmenu",function(m){return l.fire("contextmenu",m)});this._grid.on("keydown",function(o){if(l.fire("keydown",o)===false){return false}var p=o.event.keyCode;if(p===32){var q=i._grid.activerow();if(q>=0){o.event.preventDefault();o.event.stopPropagation()}}else{if(p===37){var q=i._grid.activerow();var n=i._grid.activeItem();if(n){var m=n[i._childrenColumKey];if(m&&m.length>0&&n[i._expandColumnKey]){l.onFoldRow(n,q,o.event)}else{if(n.__parent){i.activeItem(n.__parent);i.scrollTo(i.activerow());i.refresh()}}o.event.preventDefault();o.event.stopPropagation()}}else{if(p===39){var n=i._grid.activeItem();if(n){var m=n[i._childrenColumKey];if(m&&m.length>0&&!n[i._expandColumnKey]){l.onExpandRow(n,q,o.event)}o.event.preventDefault();o.event.stopPropagation()}}}}});this._grid.on("keyup",function(m){if(m.event.keyCode===32){var o=i._grid.activerow();if(o>=0){var n=i._grid.data().at(o);l.onCheckRow(n,o,m.event)}}return l.fire("keyup",m)});if(!this.hasAttr("data-no-head")){this.noHead(true)}if(!this.hasAttr("data-delay-drawing")){this.delayDrawing(false)}if(!this.hasAttr("data-rowselectable")){this.rowselectable(true)}if(!this.hasAttr("data-rowcheckable")){this.rowcheckable(true)}if(this._grid.data()){this._grid.noRefresh(false);this.data(this._grid.data())}else{this._grid.noRefresh(false);this.refresh()}}g.prototype.checkChildren=function(l,m){for(var k=0;k<l.length;k++){if(!l[k]){continue}if(typeof l[k][this._checkedColumnKey]!==a.undef){l[k][this._checkedColumnKey]=m}var j=l[k][this._childrenColumKey];j&&j.length>0&&this.checkChildren(j,m)}};g.prototype.checkParent=function(m){var l=m[this._childrenColumKey];var k=0,n=0;for(var j=0;j<l.length;j++){var o=l[j];if(!o){continue}if(typeof o[this._checkedColumnKey]===a.undef){continue}else{if(o[this._checkedColumnKey]===2){n++;k++;break}else{if(!!o[this._checkedColumnKey]){k++}else{n++}}}}if(typeof m[this._checkedColumnKey]!==a.undef){if(k===0){m[this._checkedColumnKey]=0}else{if(n===0){m[this._checkedColumnKey]=1}else{m[this._checkedColumnKey]=2}}}m.__parent&&this.checkParent(m.__parent)};g.prototype.checkRow=function(l,k){if(typeof l[this._checkedColumnKey]!==a.undef){l[this._checkedColumnKey]=k}if(this.triState()){var i=l[this._childrenColumKey];i&&i.length>0&&this.checkChildren(i,k);var j=l.__parent;j&&this.checkParent(j)}};g.prototype.onCheckRow=function(k,l,j){var i;if(this.triState()){i=k[this._checkedColumnKey];if(i===2||!i){i=1}else{i=0}}else{i=!k[this._checkedColumnKey]}this.checkRow(k,i);this.fire("rowcheck",{event:j,checked:k[this._checkedColumnKey],row:k,index:l});this.refresh()};g.prototype.expandRow=function(j){var i=this.data().at(j);i[this._expandColumnKey]=true;this.formatData();this.fire("rowexpand",{row:i,index:j})};g.prototype.onExpandRow=function(j,k,i){j[this._expandColumnKey]=true;this.formatData();this.fire("rowexpand",{event:i,row:j,index:k})};g.prototype.foldRow=function(j){var i=this.data().at(j);i[this._expandColumnKey]=false;this.formatData();this.fire("rowfold",{row:i,index:j})};g.prototype.onFoldRow=function(j,k,i){j[this._expandColumnKey]=false;this.formatData();this.fire("rowfold",{event:i,row:j,index:k})};g.prototype.initData=function(m){if(m===void 0){m=false}var j=this;var l=this._grid.data();if(l&&typeof l.process==="function"){function i(n,s){var p=0,q=0;for(var o=0;o<n.length;o++){var t=n[o];if(!t){continue}if(m){if(t[j._childrenColumKey]&&t[j._childrenColumKey].length>0){var r=i(t[j._childrenColumKey],t);t[j._checkedColumnKey]=r}if(t[j._checkedColumnKey]===2){q++;p++}else{if(!!t[j._checkedColumnKey]){p++}else{q++}}}else{if(t[j._childrenColumKey]&&t[j._childrenColumKey].length>0){i(t[j._childrenColumKey],t)}}t.__parent=s}if(m){if(p===0){return 0}else{if(q===0){return 1}else{return 2}}}}function k(n){i(n,null);return n}l.process(k)}};g.prototype.initTriState=function(){this.initData(true)};g.prototype.formatData=function(){var j=this;var l=this._grid.data();if(l&&typeof l.process==="function"){function i(n,m,q){for(var o=0;o<n.length;o++){var p=n[o];if(!p){continue}m.push(p);p[j._levelColumnKey]=q;if(!!p[j._expandColumnKey]&&p[j._childrenColumKey]&&p[j._childrenColumKey].length>0){i(p[j._childrenColumKey],m,q+1)}}}function k(n){var m=[];i(n,m,0);return m}l.process(k)}this.refresh()};g.prototype.select=function(i){return this._grid.select(i)};g.prototype.activerow=function(i){return this._grid.activerow(i)};g.prototype.activeItem=function(j){if(typeof j!==a.undef){if(j){var i=j.__parent;while(i){i[this._expandColumnKey]=true;i=i.__parent}this.formatData()}}return this._grid.activeItem(j)};g.prototype.activeRowByKey=function(l){var j=this;var k=null;function i(o){for(var n=0;n<o.length;n++){if(!o[n]){continue}if(o[n][j._keyColumKey]===l){k=o[n];return true}var p=o[n][j._childrenColumKey];if(p&&p.length>0){if(i(p)){return true}}}}var m=this._grid.data();if(typeof m.src==="function"){if(i(m.src())){return this.activeItem(k)}else{return this.activeItem(null)}}else{return null}};g.prototype.doCheck=function(n,m){var k=this;var p={};if(n){for(var l=0;l<n.length;l++){p[n[l]]=true}}function j(s,r){for(var q=0;q<r.length;q++){if(!r[q]){continue}if(s===null||p[r[q][k._keyColumKey]]){k.checkRow(r[q],m)}var t=r[q][k._childrenColumKey];if(t&&t.length>0){j(s,t)}}}var o=this._grid.data();if(o&&typeof o.src==="function"){j(n,o.src());this.refresh()}};g.prototype.checkItems=function(i){this.doCheck(i,1);return this};g.prototype.checkAllItems=function(){this.doCheck(null,1);return this};g.prototype.uncheckItems=function(i){this.doCheck(i,0);return this};g.prototype.uncheckAllItems=function(){this.doCheck(null,0);return this};g.prototype.checkedItems=function(){var k=this;var i=[];function j(n){for(var m=0;m<n.length;m++){if(!n[m]){continue}if(!!n[m][k._checkedColumnKey]){i.push(n[m])}var o=n[m][k._childrenColumKey];if(o&&o.length>0){j(o)}}}var l=this._grid.data();if(l&&typeof l.src==="function"){j(l.src())}return i};g.prototype.allKeys=function(m){var j=this;var k=[];function i(p){for(var o=0;o<p.length;o++){if(!p[o]){continue}var n=p[o][j._keyColumKey];if((m&&typeof p[o][j._checkedColumnKey]!==a.undef||!m)&&typeof n!==a.undef&&n!==null){k.push(n)}var q=p[o][j._childrenColumKey];if(q&&q.length>0){i(q)}}}var l=this._grid.data();if(l&&typeof l.src==="function"){i(l.src())}return k};g.prototype.enumerate=function(l){var j=this;var i=[];function k(o){for(var n=0;n<o.length;n++){l(o[n]);if(!o[n]){continue}var p=o[n][j._childrenColumKey];if(p&&p.length>0){k(p)}}}var m=this._grid.data();if(m&&typeof m.src==="function"){k(m.src())}};g.prototype.autofitColumn=function(j,k,i){if(k===void 0){k=false}if(i===void 0){i=true}this._grid.autofitColumn(j,k,i)};g.prototype.delayDrawing=function(i){return this._grid.delayDrawing(i)};g.prototype.noHead=function(i){return this._grid.noHead(i)};g.prototype.hasHScroll=function(i){return this._grid.hasHScroll(i)};g.prototype.columns=function(i){return this._grid.columns(i)};g.prototype.rowdraggable=function(i){return this._grid.rowdraggable(i)};g.prototype.rowselectable=function(i){return this._grid.rowselectable(i)};g.prototype.rowcheckable=function(i){if(typeof i==="boolean"){this.is("data-rowcheckable",i);this.refresh();return this}else{return this.is("data-rowcheckable")}};g.prototype.consumeMouseWheelEvent=function(i){return this._grid.consumeMouseWheelEvent(i)};g.prototype.triState=function(i){if(typeof i==="boolean"){this.is("data-tri-state",i);this.refresh();return this}else{return this.is("data-tri-state")}};g.prototype.scrollTo=function(i){this._grid.scrollTo(i)};g.prototype.value=function(m){if(typeof m!==a.undef){this.uncheckAllItems();if(m!=null){this.checkItems(m)}return this}else{var k=this.checkedItems();var j=[];for(var l=0;l<k.length;l++){if(typeof k[l][this._keyColumKey]!==a.undef){j.push(k[l][this._keyColumKey])}}return j}};g.prototype.data=function(j){if(typeof j!==a.undef){var k=this._grid.noRefresh();this._grid.noRefresh(true);this._grid.data(j);var i=this._grid.data();this._keyColumKey=i.mapKey("key");this._childrenColumKey=i.mapKey("children");this._checkedColumnKey=i.mapKey("checked");this._levelColumnKey=i.mapKey("level");this._valueColumnKey=i.mapKey("value");this._expandColumnKey=i.mapKey("expand");this._iconColumnKey=i.mapKey("icon");if(this.triState()){this.initTriState()}else{this.initData()}this._grid.noRefresh(k);this.formatData();return this}else{return this._grid.data()}};g.prototype.lineHeight=function(){if(!this._grid){return 0}return this._grid.lineHeight()};g.prototype.refresh=function(){if(!this._grid){return}this._grid.refresh()};g.CLASS="tui-list";return g})(f.Control);f.List=d;function e(g){return a.ctrl.control(g,d)}f.list=e;a.ctrl.registerInitCallback(d.CLASS,e)})(b=a.ctrl||(a.ctrl={}))})(tui||(tui={}));var tui;(function(tui){var ctrl;(function(ctrl){function validText(t){if(typeof t===tui.undef||t===null){return""}else{return t+""}}function getKeys(items){var keys=[];for(var i=0;i<items.length;i++){var key=items[i]["key"];if(typeof key!==tui.undef){keys.push(key)}}return keys}var Input=(function(_super){__extends(Input,_super);function Input(el,type){var _this=this;_super.call(this,"span",Input.CLASS,el===null?undefined:el);this._fileId=null;this._binding=null;this._invalid=false;this._message="";this._data=null;this._columnKeyMap=null;this._initialized=false;this._suggestionList=null;this._suggestionPopup=null;this._suggestionText=null;this.openPopup=(function(){var self=_this;return function(e){if(self.type()==="calendar"){self.showCalendar()}else{if(self.type()==="select"){self.showSingleSelect()}else{if(self.type()==="multi-select"){self.showMultiSelect()}else{if(self.type()==="file"){}else{self.fire("btnclick",{ctrl:self[0],event:e})}}}}}})();var self=this;this._button=document.createElement("span");this._label=document.createElement("label");this._notify=document.createElement("div");this[0].innerHTML="";this[0].appendChild(this._label);this[0].appendChild(this._button);this[0].appendChild(this._notify);this[1]=this._label;this[2]=this._button;if(typeof type!==tui.undef){this.type(type)}else{this.type(this.type())}$(this._button).on("click",this.openPopup);$(this._label).on("mousedown",function(e){if(!_this.useLabelClick()){return}if(!_this.disabled()&&(_this.type()==="text"||_this.type()==="password"||_this.type()==="custom-text")){setTimeout(function(){_this._textbox.focus()},0)}else{if(_this.type()==="select"||_this.type()==="multi-select"||_this.type()==="calendar"){_this.openPopup(e)}else{if(_this.type()==="file"){}}}});$(this[0]).on("keydown",function(e){if(e.keyCode!==32){return}if(_this.type()==="select"||_this.type()==="multi-select"||_this.type()==="calendar"){e.preventDefault();e.stopPropagation()}});$(this[0]).on("keyup",function(e){if(e.keyCode!==32){return}if(_this.type()==="select"||_this.type()==="multi-select"||_this.type()==="calendar"){_this.openPopup(e);e.preventDefault();e.stopPropagation()}});if(this.type()==="text"||this.type()==="custom-text"||this.type()==="select"||this.type()==="multi-select"){var predefined=this.attr("data-data");if(predefined){predefined=eval("("+predefined+")")}if(predefined){this.data(predefined)}}if(!this.hasAttr("data-label-click")){this.useLabelClick(true)}if(!this.hasAttr("data-empty-suggestion")){this.emptySuggestion(true)}this.value(this.value())}Input.prototype.doSubmit=function(){var formId=this.submitForm();if(formId){var form=tui.ctrl.form(formId);form&&form.submit()}};Input.prototype.createTextbox=function(){var _this=this;var self=this;var type=this.type();if(this._textbox){this[0].removeChild(this._textbox)}this._textbox=document.createElement("input");this[3]=this._textbox;if(type==="password"){this._textbox.type="password"}else{this._textbox.type="text"}this[0].insertBefore(this._textbox,this._button);$(this._textbox).on("focus",function(){$(_this[0]).addClass("tui-focus")});$(this._textbox).on("blur",function(){$(_this[0]).removeClass("tui-focus")});$(this._textbox).on("propertychange",function(e){if(e.originalEvent.propertyName!=="value"){return}setTimeout(function(){if(_this.text()!==_this._textbox.value){_this.text(_this._textbox.value);self.openSuggestion(self._textbox.value);self.fire("change",{ctrl:_this[0],event:e,text:_this.text()})}},0)});$(this._textbox).on("change",function(e){if(_this.text()!==_this._textbox.value){_this.text(_this._textbox.value);self.openSuggestion(self._textbox.value);_this.fire("change",{ctrl:_this[0],event:e,text:_this.text()})}});$(this._textbox).on("input",function(e){setTimeout(function(){if(_this.text()!==_this._textbox.value){_this.text(_this._textbox.value);self.openSuggestion(self._textbox.value);self.fire("change",{ctrl:self[0],event:e,text:self.text()})}},0)});$(this._textbox).keydown(function(e){if(self._suggestionList){var list=self._suggestionList;if(e.keyCode===tui.KEY_DOWN){var r=list.activerow();if(r===null||r>=list.data().length()-1){list.activerow(0)}else{list.activerow(r+1)}if(list.activeItem()){list.scrollTo(list.activerow());self.value(list.activeItem().key)}e.preventDefault();e.stopPropagation()}else{if(e.keyCode===tui.KEY_UP){var r=list.activerow();if(r===null||r<=0){list.activerow(list.data().length()-1)}else{list.activerow(r-1)}if(list.activeItem()){list.scrollTo(list.activerow());self.value(list.activeItem().key)}e.preventDefault();e.stopPropagation()}else{if(e.keyCode===tui.KEY_ENTER){if(self.readonly()){self._suggestionPopup.close();self._textbox.focus();return false}if(list.activeItem()){self.value(list.activeItem().key);self._suggestionPopup.close();self._textbox.focus();self.fire("change",{ctrl:self[0],event:e,text:self.text()})}}}}}if(e.keyCode===tui.KEY_ENTER){self.fire("enter",{ctrl:self[0],event:e,text:self.text()});_this.doSubmit()}})};Input.prototype.showCalendar=function(){var self=this;var pop=tui.ctrl.popup();var calendar=tui.ctrl.calendar();calendar.timepart(this.timepart());calendar.time(self.value());calendar.on("picked",function(e){if(self.readonly()){pop.close();self.focus();return false}self.value(e.time);pop.close();self.focus();if(self.fire("select",{ctrl:self[0],type:self.type(),time:e.time})===false){return}self.doSubmit()});var calbox=document.createElement("div");calbox.appendChild(calendar[0]);var todayLink=document.createElement("a");todayLink.innerHTML="<i class='fa fa-clock-o'></i> "+tui.str("Today")+": "+tui.formatDate(tui.today(),"yyyy-MM-dd");todayLink.href="javascript:void(0)";$(todayLink).click(function(e){if(self.readonly()){pop.close();self.focus();return false}self.value(tui.today());pop.close();self.focus();if(self.fire("select",{ctrl:self[0],type:self.type(),time:e.time})===false){return}self.doSubmit()});var todayLine=document.createElement("div");todayLine.appendChild(todayLink);todayLine.className="tui-input-select-bar";if(self.clearable()){var space=document.createElement("span");space.className="bar-space";var clearLink=document.createElement("a");clearLink.innerHTML="<i class='fa fa-trash-o'></i>";clearLink.href="javascript:void(0)";$(clearLink).click(function(e){if(self.readonly()){pop.close();self.focus();return false}self.value(null);pop.close();self.focus();if(self.fire("select",{ctrl:self[0],type:self.type(),time:e.time})===false){return}self.doSubmit()});todayLine.appendChild(space);todayLine.appendChild(clearLink)}calbox.appendChild(todayLine);pop.show(calbox,self[0],"Rb");calendar.focus()};Input.prototype.showSingleSelect=function(){var self=this;var pop=tui.ctrl.popup();var list=tui.ctrl.list();list.consumeMouseWheelEvent(true);list.rowcheckable(false);list.on("rowclick",function(data){if(self.readonly()){pop.close();self.focus();return false}self.selectValue(self.getKeyValue([list.activeItem()]));pop.close();self.focus();if(self.fire("select",{ctrl:self[0],type:self.type(),item:list.activeItem()})===false){return}self.doSubmit()});list.on("keydown",function(data){if(data.event.keyCode===13){if(self.readonly()){pop.close();self.focus();return false}if(list.activeItem()){self.selectValue(self.getKeyValue([list.activeItem()]))}else{self.selectValue(null)}pop.close();self.focus();if(self.fire("select",{ctrl:self[0],type:self.type(),item:list.activeItem()})===false){return}self.doSubmit()}});list[0].style.width=self[0].offsetWidth-2+"px";list.data(self._data);var calbox=document.createElement("div");calbox.appendChild(list[0]);if(self.clearable()){var bar=document.createElement("div");bar.className="tui-input-select-bar";var clearLink=document.createElement("a");clearLink.innerHTML="<i class='fa fa-trash-o'></i> "+tui.str("Clear");clearLink.href="javascript:void(0)";$(clearLink).click(function(e){if(self.readonly()){pop.close();self.focus();return false}self.selectValue(null);pop.close();self.focus();if(self.fire("select",{ctrl:self[0],type:self.type(),item:list.activeItem()})===false){return}self.doSubmit()});bar.appendChild(clearLink);calbox.appendChild(bar)}pop.show(calbox,self[0],"Rb");var items=self._data?self._data.length():0;if(items<1){items=1}else{if(items>8){items=8}}list[0].style.height=items*list.lineHeight()+4+"px";list.refresh();pop.refresh();var val=this.selectValue();if(val&&val.length>0){list.activeRowByKey(val[0].key);list.scrollTo(list.activerow())}list.focus()};Input.prototype.showMultiSelect=function(){var self=this;var pop=tui.ctrl.popup();var list=tui.ctrl.list();list.consumeMouseWheelEvent(true);var calbox=document.createElement("div");calbox.appendChild(list[0]);list[0].style.width=self[0].offsetWidth-2+"px";list.data(self._data);var allKeys=list.allKeys(true);list.uncheckAllItems();var keys=getKeys(this.selectValue());list.checkItems(keys);calbox.appendChild(list[0]);var bar=document.createElement("div");bar.className="tui-input-select-bar";calbox.appendChild(bar);var selAll=tui.ctrl.checkbox();selAll.text("All");selAll.on("click",function(){if(selAll.checked()){list.checkAllItems()}else{list.uncheckAllItems()}});var okLink=document.createElement("a");okLink.innerHTML="<i class='fa fa-check'></i> "+tui.str("Accept");okLink.href="javascript:void(0)";$(okLink).click(function(e){if(self.readonly()){pop.close();self.focus();return false}self.selectValue(self.getKeyValue(list.checkedItems()));pop.close();self.focus();if(self.fire("select",{ctrl:self[0],type:self.type(),checkedItems:list.checkedItems()})===false){return}self.doSubmit()});function isAllChecked(){if(list.checkedItems().length>=allKeys.length){selAll.checked(true)}else{selAll.checked(false)}}isAllChecked();list.on("rowcheck",function(data){isAllChecked()});list.on("keydown",function(data){if(data.event.keyCode===13){if(self.readonly()){pop.close();self.focus();return false}self.selectValue(self.getKeyValue(list.checkedItems()));pop.close();self.focus();if(self.fire("select",{ctrl:self[0],type:self.type(),checkedItems:list.checkedItems()})===false){return}self.doSubmit()}});bar.appendChild(selAll[0]);var space=document.createElement("span");space.className="bar-space";bar.appendChild(space);bar.appendChild(okLink);pop.show(calbox,self[0],"Rb");var items=self._data?self._data.length():0;if(items<1){items=1}else{if(items>8){items=8}}list[0].style.height=items*list.lineHeight()+4+"px";list.refresh();pop.refresh();list.focus()};Input.prototype.makeFileUpload=function(){var _this=this;if(this._binding){return}this._binding=tui.bindUpload(this._button,{action:this.uploadUrl(),name:"file",autoSubmit:true,accept:this.accept(),responseType:"json"});this._binding.on("change",function(data){_this.focus();var result=_this.validate(data.file);if(!result){_this.value(null);_this._invalid=true;_this.refresh()}return result});this._binding.on("complete",function(data){data.ctrl=_this[0];if(_this.fire("complete",data)===false){return}var response=data.response;if(response){response.file=data.file;_this.value(response);if(_this.fire("select",{ctrl:_this[0],type:_this.type(),file:response})===false){return}}else{tui.errbox(tui.str("Upload failed, please check file type!"),tui.str("Error"))}})};Input.prototype.unmakeFileUpload=function(){if(this._binding){this._binding.uninstallBind();this._binding=null}};Input.prototype.formatSelectText=function(val){var text="";for(var i=0;i<val.length;i++){if(text.length>0){text+="; "}text+=validText(val[this._valueColumnKey])}return text};Input.prototype.formatSelectTextByData=function(val){var self=this;var map={};function buildMap(children){for(var i=0;i<children.length;i++){if(!children[i]){continue}var k=children[i][self._keyColumKey];map[k]=children[i][self._valueColumnKey];var myChildren=children[i][self._childrenColumKey];if(myChildren&&myChildren.length>0){buildMap(myChildren)}}}var data=this._data;data&&typeof data.src==="function"&&buildMap(data.src());var text="";for(var i=0;i<val.length;i++){if(text.length>0){text+=", "}var t=map[val[i].key];if(typeof t===tui.undef){t=validText(val[i].value)}else{t=validText(t)}text+=t}return text};Input.prototype.columnKey=function(key){var val=this._columnKeyMap[key];if(typeof val==="number"&&val>=0){return val}else{if(typeof val==="string"){return val}else{return key}}};Input.prototype.getKeyValue=function(value){var result=[];for(var i=0;i<value.length;i++){if(typeof value[i][this._keyColumKey]!==tui.undef){var item={key:value[i][this._keyColumKey]};if(typeof value[i][this._valueColumnKey]!==tui.undef){item.value=value[i][this._valueColumnKey]}result.push(item)}}return result};Input.prototype.openSuggestion=function(text){if(this.type()!=="text"&&this.type()!=="custom-text"){this._suggestionPopup&&this._suggestionPopup.close();return}if(!this._data||(!this.emptySuggestion()&&(!text||text.length===0))){this._suggestionPopup&&this._suggestionPopup.close();return}if(this._suggestionText===text){return}var max=this.maxSuggestions();var suggestions=[];for(var i=0;i<this._data.length();i++){var val=this._data.cell(i,"value");var m=-1;if(typeof val!==tui.undef&&val!==null){m=val.toLowerCase().indexOf(text.toLowerCase())}var sug="";if(m>=0){sug+=val.substring(0,m);sug+="<b style='color:#000'>"+val.substr(m,text.length)+"</b>";sug+=val.substring(m+text.length);suggestions.push({key:val,value:sug})}else{var k=this._data.cell(i,"key");if(typeof k!==tui.undef&&k!==null){m=(k+"").toLowerCase().indexOf(text.toLowerCase());if(m>=0){suggestions.push({key:val,value:val})}}}if(max&&suggestions.length>=max){break}}if(suggestions.length===0){this._suggestionPopup&&this._suggestionPopup.close();return}this._suggestionText=text;suggestions.sort(function(a,b){return a.key.localeCompare(b.key)});var self=this;var pop=this._suggestionPopup;var list=this._suggestionList;if(this._suggestionPopup===null){pop=this._suggestionPopup=tui.ctrl.popup();list=this._suggestionList=tui.ctrl.list();this._suggestionPopup.owner(self._textbox);list.consumeMouseWheelEvent(true);list.rowcheckable(false);list.on("rowmousedown",function(data){if(self.readonly()){pop.close();self._textbox.focus();return false}self.value(list.activeItem().key);pop.close();self._textbox.focus();self.fire("change",{ctrl:self[0],event:data.event,text:self.text()});return;self.doSubmit()});pop.on("close",function(){self._suggestionPopup=null;self._suggestionList=null;self._suggestionText=null});pop.show(list[0],self[0],"Rb")}list[0].style.width=self[0].offsetWidth-2+"px";list.data(suggestions);list.activerow(null);var items=suggestions.length;if(items<1){items=1}else{if(items>8){items=8}}list[0].style.height=items*list.lineHeight()+4+"px";list.refresh();pop.refresh()};Input.prototype.useLabelClick=function(val){if(typeof val==="boolean"){this.is("data-label-click",val);return this}else{return this.is("data-label-click")}};Input.prototype.fileId=function(){return this._fileId};Input.prototype.type=function(txt){var type;if(typeof txt==="string"){txt=txt.toLowerCase();if(Input._supportType.indexOf(txt)>=0){this.attr("data-type",txt)}else{this.attr("data-type","text")}type=this.type();if(type==="text"||type==="password"||type==="custom-text"){this.removeAttr("tabIndex")}else{this.attr("tabIndex","0")}this.createTextbox();this._initialized=false;this.refresh();return this}else{type=this.attr("data-type");if(!type){return"text"}else{type=type.toLowerCase()}if(Input._supportType.indexOf(type)>=0){return type}else{return"text"}}};Input.prototype.validator=function(val){if(typeof val==="object"&&val){this.attr("data-validator",JSON.stringify(val));this._invalid=false;this._initialized=false;this.refresh();return this}else{if(val===null){this.removeAttr("data-validator");this._invalid=false;this._initialized=false;this.refresh();return this}else{val=this.attr("data-validator");if(val===null){return null}else{try{val=eval("("+val+")");if(typeof val!=="object"){return null}else{return val}}catch(err){return null}}}}};Input.prototype.emptySuggestion=function(val){if(typeof val==="boolean"){this.is("data-empty-suggestion",val);return this}else{return this.is("data-empty-suggestion")}};Input.prototype.maxSuggestions=function(val){if(typeof val==="number"){this.attr("data-max-suggestions",Math.floor(val));return this}else{val=parseInt(this.attr("data-max-suggestions"));if(isNaN(val)){return null}else{return val}}};Input.prototype.validate=function(txt){var finalText=typeof txt==="string"?txt:this.text();if(finalText===null){finalText=""}this._invalid=false;var validator=this.validator();if(validator){for(var k in validator){if(k&&validator.hasOwnProperty(k)){if(k==="*password"){if(!/[a-z]/.test(finalText)||!/[A-Z]/.test(finalText)||!/[0-9]/.test(finalText)||!/[\~\`\!\@\#\$\%\^\&\*\(\)\_\-\+\=\\\]\[\{\}\:\;\"\'\/\?\,\.\<\>\|]/.test(finalText)||finalText.length<6){this._invalid=true}}else{if(k.substr(0,8)==="*maxlen:"){var imaxLen=parseFloat(k.substr(8));if(isNaN(imaxLen)){throw new Error("Invalid validator: '*maxlen:...' must follow a number")}var ival=finalText.length;if(ival>imaxLen){this._invalid=true}}else{if(k.substr(0,8)==="*minlen:"){var iminLen=parseFloat(k.substr(8));if(isNaN(iminLen)){throw new Error("Invalid validator: '*iminLen:...' must follow a number")}var ival=finalText.length;if(ival<iminLen){this._invalid=true}}else{if(k.substr(0,5)==="*max:"){var imax=parseFloat(k.substr(5));if(isNaN(imax)){throw new Error("Invalid validator: '*max:...' must follow a number")}var ival=parseFloat(finalText);if(isNaN(ival)||ival>imax){this._invalid=true}}else{if(k.substr(0,5)==="*min:"){var imin=parseFloat(k.substr(5));if(isNaN(imin)){throw new Error("Invalid validator: '*min:...' must follow a number")}var ival=parseFloat(finalText);if(isNaN(ival)||ival<imin){this._invalid=true}}else{if(k.substr(0,6)==="*same:"){var other=k.substr(6);other=input(other);if(other){var otherText=other.text();if(otherText===null){otherText=""}if(finalText!==otherText){this._invalid=true}}else{this._invalid=true}}else{var regexp;if(k.substr(0,1)==="*"){var v=Input.VALIDATORS[k];if(v){regexp=new RegExp(v)}else{throw new Error("Invalid validator: "+k+" is not a valid validator")}}else{regexp=new RegExp(k)}this._invalid=!regexp.test(finalText)}}}}}}if(this._invalid){this._message=validator[k];break}}}}if(this._invalid&&!this._message){this._message=tui.str("Invalid input.")}this._initialized=false;this.refresh();return !this._invalid};Input.prototype.uploadUrl=function(url){if(typeof url==="string"){this.attr("data-upload-url",url);this.unmakeFileUpload();this._initialized=false;this.refresh();return this}else{return this.attr("data-upload-url")}};Input.prototype.text=function(txt){var type=this.type();if(typeof txt==="string"){if(type==="text"||type==="password"||type==="custom-text"){this.attr("data-text",txt);this.attr("data-value",txt);this._invalid=false;this._initialized=false;this.refresh()}return this}else{return this.attr("data-text")}};Input.prototype.accept=function(txt){var type=this.type();if(typeof txt==="string"){this.attr("data-accept",txt);this.unmakeFileUpload();this._initialized=false;this.refresh();return this}else{return this.attr("data-accept")}};Input.prototype.clearable=function(val){if(typeof val==="boolean"){this.is("data-clearable",val);return this}else{return this.is("data-clearable")}};Input.prototype.timepart=function(val){if(typeof val==="boolean"){this.is("data-timepart",val);this.refresh();return this}else{return this.is("data-timepart")}};Input.prototype.data=function(data){if(data){var self=this;if(data instanceof Array||data.data&&data.data instanceof Array){data=new tui.ArrayProvider(data)}if(typeof data.length!=="function"||typeof data.sort!=="function"||typeof data.at!=="function"||typeof data.columnKeyMap!=="function"){throw new Error("TUI Input: need a data provider.")}this._data=data;if(data){this._columnKeyMap=data.columnKeyMap()}else{this._columnKeyMap={}}this._keyColumKey=this.columnKey("key");this._valueColumnKey=this.columnKey("value");this._childrenColumKey=this.columnKey("children");return this}else{return this._data}};Input.prototype.valueHasText=function(val){if(typeof val==="boolean"){this.is("data-value-has-text",val);return this}else{return this.is("data-value-has-text")}};Input.prototype.valueToSelect=function(val){if(this.valueHasText()){return val}else{if(this.type()==="select"){val=[val]}var newval=[];if(val&&val.length>0){for(var i=0;i<val.length;i++){newval.push({key:val[i]})}}return newval}};Input.prototype.selectToValue=function(val){if(this.valueHasText()){return val}else{if(this.type()==="select"){if(val&&val.length>0){return val[0].key}else{return null}}else{var newval=[];if(val&&val.length>0){for(var i=0;i<val.length;i++){newval.push(val[i].key)}}return newval}}};Input.prototype.selectValue=function(val){var type=this.type();if(typeof val!==tui.undef){if(type==="select"||type==="multi-select"){if(val&&typeof val.length==="number"){this.attr("data-value",JSON.stringify(val));this.attr("data-text",this.formatSelectTextByData(val))}else{if(val===null){this.attr("data-value","[]");this.attr("data-text","")}}this._invalid=false;this._initialized=false;this.refresh()}return this}else{val=this.attr("data-value");if(type==="select"||type==="multi-select"){if(val===null){return[]}return eval("("+val+")")}else{return null}}};Input.prototype.readonly=function(val){if(typeof val==="boolean"){this.is("data-readonly",val);this._initialized=false;this._invalid=false;this.refresh();return this}else{return this.is("data-readonly")}};Input.prototype.dateFormat=function(format){if(typeof format==="string"){this.attr("data-date-format",format);return this}else{return this.attr("data-date-format")}};Input.prototype.textFormat=function(format){if(typeof format==="string"){this.attr("data-text-format",format);return this}else{return this.attr("data-text-format")}};Input.prototype.allKeys=function(){var type=this.type();if(type==="select"||type==="multi-select"){var list=tui.ctrl.list();list.data(this._data);return list.allKeys(type==="multi-select")}else{return null}};Input.prototype.value=function(val){var type=this.type();if(typeof val!==tui.undef){if(val==null){this.removeAttr("data-value");this.attr("data-text","");this._invalid=false;this._initialized=false;this.refresh()}else{if(type==="calendar"){if(typeof val==="string"){try{val=tui.parseDate(val)}catch(e){val=null}}if(val instanceof Date){this.attr("data-value",tui.formatDate(val,"yyyy-MM-ddTHH:mm:ss.SSSZ"));var fmt=this.textFormat();if(fmt===null){if(this.timepart()){fmt=tui.str("yyyy-MM-dd HH:mm:ss")}else{fmt=tui.str("yyyy-MM-dd")}}this.attr("data-text",tui.formatDate(val,fmt));this._invalid=false}this._initialized=false;this.refresh()}else{if(type==="file"){if(val===null){this.attr("data-value",JSON.stringify(val));this.attr("data-text","")}else{if(val.file&&val.fileId){this.attr("data-value",JSON.stringify(val));this.attr("data-text",val.file)}}this._invalid=false;this._initialized=false;this.refresh()}else{if(type==="text"||type==="password"||type==="custom-text"){this.attr("data-text",val);this.attr("data-value",val);this._invalid=false;this._initialized=false;this.refresh()}else{if(type==="custom-select"){if(val.key&&val.value){this.attr("data-value",val.key);this.attr("data-text",val.value)}else{if(val.key){this.attr("data-value",val.key);this.attr("data-text",val.key)}else{if(val.value){this.attr("data-value",val.value);this.attr("data-text",val.value)}else{this.attr("data-value",val);this.attr("data-text",val)}}}this._invalid=false;this._initialized=false;this.refresh()}else{if(type==="select"||type==="multi-select"){this.selectValue(this.valueToSelect(val))}}}}}}return this}else{val=this.attr("data-value");if(type==="calendar"){if(val===null){return null}var dateVal=tui.parseDate(val);if(this.dateFormat()!==null){return tui.formatDate(dateVal,this.dateFormat())}else{return dateVal}}else{if(type==="file"){if(val===null){return null}return eval("("+val+")")}else{if(type==="select"||type==="multi-select"){return this.selectToValue(this.selectValue())}else{return val}}}}};Input.prototype.textAlign=function(align){if(typeof align==="string"){if(align==="left"||align==="center"||align==="right"){this.attr("data-text-algin",align);this._initialized=false;this.refresh()}return this}else{align=this.attr("data-text-algin");if(align===null){align="left"}return align}};Input.prototype.icon=function(txt){if(typeof txt==="string"){this.attr("data-icon",txt);this._initialized=false;this.refresh();return this}else{return this.attr("data-icon")}};Input.prototype.placeholder=function(txt){if(typeof txt==="string"){this.attr("data-placeholder",txt);this._initialized=false;this.refresh();return this}else{return this.attr("data-placeholder")}};Input.prototype.getSelectRow=function(){if(this.type()==="select"){var list=tui.ctrl.list();list.data(this._data);list.activeRowByKey(this.value());return list.activeItem()}else{if(this.type()==="multi-select"){var list=tui.ctrl.list();list.data(this._data);list.checkItems(this.value());return list.checkedItems()}else{return null}}};Input.prototype.getSelectRowColumn=function(columnKey){if(this._data==null){return null}var row=this.getSelectRow();if(this.type()==="select"){return row[this._data.mapKey(columnKey)]}else{if(this.type()==="multi-select"){var result=[];var k=this._data.mapKey(columnKey);for(var i=0;i<row.length;i++){result.push(row[i][k])}return result}else{return null}}};Input.prototype.submitForm=function(formId){if(typeof formId==="string"){this.attr("data-submit-form",formId);return this}else{return this.attr("data-submit-form")}};Input.prototype.autoRefresh=function(){return !this._initialized};Input.prototype.focus=function(){var _this=this;if(this.type()==="text"||this.type()==="password"||this.type()==="custom-text"){setTimeout(function(){_this._textbox.focus()},0)}else{if(this[0]){setTimeout(function(){_this[0].focus()},0)}}};Input.prototype.refresh=function(){if(!this[0]||this._initialized){return}this[0].offsetWidth||this[0].offsetHeight;if(this[0].offsetWidth<=0||this[0].offsetHeight<=0){return}this._initialized=true;var type=this.type().toLowerCase();if(type==="file"&&!this.readonly()){this.makeFileUpload()}else{this.unmakeFileUpload()}var placeholder=this.placeholder();if(placeholder===null){placeholder=""}var text=this.text();if(text===null){text=""}var hasBtn=false;if(type!=="text"&&type!=="password"){if($(this[0]).width()<this._button.offsetWidth){hasBtn=false}else{hasBtn=true}}else{hasBtn=false}if(hasBtn){this._button.style.height="";this._button.style.height=($(this[0]).innerHeight()-($(this._button).outerHeight()-$(this._button).height()))+"px";this._button.style.lineHeight=this._button.style.height;this._button.style.display=""}else{this._button.style.display="none"}if(this.icon()){$(this._button).addClass(this.icon())}else{this._button.className=""}var align=this.textAlign();var hasLabel=false;var hasTextbox=false;if(type==="text"||type==="password"||type==="custom-text"){hasTextbox=true;if(!text){hasLabel=true}else{hasLabel=false}}else{hasLabel=true;hasTextbox=false}if(hasLabel){if(placeholder&&!text){this._label.innerHTML=placeholder;$(this._label).addClass("tui-placeholder")}else{this._label.innerHTML=text;$(this._label).removeClass("tui-placeholder")}this._label.style.textAlign=align;this._label.style.display="";if(hasBtn){this._label.style.width="";this._label.style.width=($(this[0]).innerWidth()-($(this._label).outerWidth()-$(this._label).width())-$(this._button).outerWidth())+"px"}else{this._label.style.width="";this._label.style.width=($(this[0]).innerWidth()-($(this._label).outerWidth()-$(this._label).width()))+"px"}this._label.style.height="";this._label.style.height=($(this[0]).innerHeight()-($(this._label).outerHeight()-$(this._label).height()))+"px";this._label.style.lineHeight=this._label.style.height}else{this._label.style.display="none"}if(hasTextbox){if(this.readonly()){this._textbox.readOnly=true}else{this._textbox.readOnly=false}if(this._textbox.value!==text){this._textbox.value=text}this.removeAttr("tabIndex");this._textbox.style.textAlign=align;this._textbox.style.display="";if(hasBtn){this._textbox.style.width="";this._textbox.style.width=($(this[0]).innerWidth()-($(this._textbox).outerWidth()-$(this._textbox).width())-$(this._button).outerWidth())+"px"}else{this._textbox.style.width="";this._textbox.style.width=($(this[0]).innerWidth()-($(this._textbox).outerWidth()-$(this._textbox).width()))+"px"}this._textbox.style.height="";this._textbox.style.height=($(this[0]).innerHeight()-($(this._textbox).outerHeight()-$(this._textbox).height()))+"px";this._textbox.style.lineHeight=this._textbox.style.height}else{this._textbox.style.display="none"}if(this._invalid){$(this._notify).attr("data-tooltip",this._message);$(this._notify).css({display:"",right:(hasBtn?this._button.offsetWidth:0)+"px"});$(this._notify).css({"line-height":this._notify.offsetHeight+"px"})}else{$(this._notify).css("display","none")}};Input.CLASS="tui-input";Input.VALIDATORS={"*email":"^\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$","*chinese":"^[\\u4e00-\\u9fa5]+$","*url":"^http://([\\w-]+\\.)+[\\w-]+(/[\\w-./?%&=]*)?$","*digital":"^\\d+$","*integer":"^[+\\-]?\\d+$","*float":"^[+\\-]?\\d*\\.\\d+$","*number":"^[+\\-]?\\d+|(\\d*\\.\\d+)$","*currency":"^-?\\d{1,3}(,\\d{3})*\\.\\d{2,3}$","*date":"^[0-9]{4}-1[0-2]|0?[1-9]-0?[1-9]|[12][0-9]|3[01]$","*key":"^[_a-zA-Z][a-zA-Z0-9_]*$","*any":"\\S+"};Input._supportType=["text","password","select","multi-select","calendar","file","custom-select","custom-text"];return Input})(ctrl.Control);ctrl.Input=Input;function input(param,type){return tui.ctrl.control(param,Input,type)}ctrl.input=input;tui.ctrl.registerInitCallback(Input.CLASS,input)})(ctrl=tui.ctrl||(tui.ctrl={}))})(tui||(tui={}));var tui;(function(tui){var ctrl;(function(ctrl){var TextArea=(function(_super){__extends(TextArea,_super);function TextArea(el){var _this=this;_super.call(this,"div",TextArea.CLASS,el);this._invalid=false;this._message="";var self=this;this._label=document.createElement("label");this._notify=document.createElement("div");this[0].innerHTML="";this[0].appendChild(this._label);this[0].appendChild(this._notify);this.createTextbox();$(this._label).on("mousedown",function(){if(!_this.disabled()){setTimeout(function(){_this._textbox.focus()},0)}});this.value(this.value())}TextArea.prototype.createTextbox=function(){var _this=this;var self=this;if(this._textbox){this[0].removeChild(this._textbox)}this._textbox=document.createElement("textarea");this[0].insertBefore(this._textbox,this._notify);$(this._textbox).on("focus",function(){$(_this[0]).addClass("tui-focus")});$(this._textbox).on("blur",function(){$(_this[0]).removeClass("tui-focus")});$(this._textbox).on("propertychange",function(e){if(e.originalEvent.propertyName!=="value"){return}setTimeout(function(){if(_this.text()!==_this._textbox.value){_this.text(_this._textbox.value);self.fire("change",{ctrl:_this[0],event:e,text:_this.text()});_this.refresh()}},0)});$(this._textbox).on("change",function(e){if(_this.text()!==_this._textbox.value){_this.text(_this._textbox.value);_this.fire("change",{ctrl:_this[0],event:e,text:_this.text()});_this.refresh()}});$(this._textbox).on("input",function(e){setTimeout(function(){if(_this.text()!==_this._textbox.value){_this.text(_this._textbox.value);self.fire("change",{ctrl:self[0],event:e,text:self.text()});_this.refresh()}},0)})};TextArea.prototype.validator=function(val){if(typeof val==="object"&&val){this.attr("data-validator",JSON.stringify(val));this._invalid=false;this.refresh();return this}else{if(val===null){this.removeAttr("data-validator");this._invalid=false;this.refresh();return this}else{val=this.attr("data-validator");if(val===null){return null}else{try{val=eval("("+val+")");if(typeof val!=="object"){return null}else{return val}}catch(err){return null}}}}};TextArea.prototype.validate=function(txt){var finalText=typeof txt==="string"?txt:this.text();if(finalText===null){finalText=""}this._invalid=false;var validator=this.validator();if(validator){for(var k in validator){if(k&&validator.hasOwnProperty(k)){if(k==="*password"){if(!/[a-z]/.test(finalText)||!/[A-Z]/.test(finalText)||!/[0-9]/.test(finalText)||!/[\~\`\!\@\#\$\%\^\&\*\(\)\_\-\+\=\\\]\[\{\}\:\;\"\'\/\?\,\.\<\>\|]/.test(finalText)||finalText.length<6){this._invalid=true}}else{if(k.substr(0,5)==="*max:"){var imax=parseFloat(k.substr(5));if(isNaN(imax)){throw new Error("Invalid validator: '*max:...' must follow a number")}var ival=parseFloat(finalText);if(isNaN(ival)||ival>imax){this._invalid=true}}else{if(k.substr(0,4)==="*min:"){var imin=parseFloat(k.substr(5));if(isNaN(imin)){throw new Error("Invalid validator: '*min:...' must follow a number")}var ival=parseFloat(finalText);if(isNaN(ival)||ival<imin){this._invalid=true}}else{var regexp;if(k.substr(0,1)==="*"){var v=ctrl.Input.VALIDATORS[k];if(v){regexp=new RegExp(v)}else{throw new Error("Invalid validator: "+k+" is not a valid validator")}}else{regexp=new RegExp(k)}this._invalid=!regexp.test(finalText)}}}if(this._invalid){this._message=validator[k];break}}}}if(this._invalid&&!this._message){this._message=tui.str("Invalid input.")}this.refresh();return !this._invalid};TextArea.prototype.text=function(txt){if(typeof txt!==tui.undef){this.attr("data-text",txt);this.attr("data-value",txt);this._invalid=false;this.refresh();return this}else{return this.attr("data-text")}};TextArea.prototype.readonly=function(val){if(typeof val==="boolean"){this.is("data-readonly",val);this.refresh();return this}else{return this.is("data-readonly")}};TextArea.prototype.value=function(val){if(typeof val!==tui.undef){if(val===null){this.attr("data-text","");this.attr("data-value","")}else{this.attr("data-text",val);this.attr("data-value",val)}this._invalid=false;this.refresh();return this}else{val=this.attr("data-value");return val}};TextArea.prototype.autoResize=function(val){if(typeof val==="boolean"){this.is("data-auto-resize",val);this.refresh();return this}else{return this.is("data-auto-resize")}};TextArea.prototype.placeholder=function(txt){if(typeof txt==="string"){this.attr("data-placeholder",txt);this.refresh();return this}else{return this.attr("data-placeholder")}};TextArea.prototype.refresh=function(){var placeholder=this.placeholder();if(placeholder===null){placeholder=""}var text=this.text();if(text===null){text=""}var withBtn=false;if(this._textbox.value!==text){this._textbox.value=text}if(this.readonly()){this._textbox.readOnly=true}else{this._textbox.readOnly=false}this._textbox.style.display="";this._label.style.display="none";this._textbox.style.width="";this._textbox.style.width=($(this[0]).innerWidth()-($(this._textbox).outerWidth()-$(this._textbox).width()))+"px";this._textbox.style.height="";var maxHeight=parseInt($(this[0]).css("max-height"),10);if(this._textbox.scrollHeight<maxHeight||isNaN(maxHeight)){this._textbox.style.overflow="hidden";$(this[0]).css("height",this._textbox.scrollHeight+"px")}else{this._textbox.style.overflow="auto";$(this[0]).css("height",maxHeight+"px")}this._textbox.style.height=($(this[0]).innerHeight()-($(this._textbox).outerHeight()-$(this._textbox).height()))+"px";this._label.style.width=this._textbox.style.width;if(placeholder&&!text){this._label.innerHTML=placeholder;this._label.style.display="";$(this._label).addClass("tui-placeholder");this._label.style.lineHeight=$(this._label).height()+"px"}else{$(this._label).removeClass("tui-placeholder")}if(this._invalid){$(this._notify).attr("data-tooltip",this._message);$(this._notify).css({display:"",right:"0px"});$(this._notify).css({"line-height":this._notify.offsetHeight+"px"})}else{$(this._notify).css("display","none")}};TextArea.CLASS="tui-textarea";return TextArea})(ctrl.Control);ctrl.TextArea=TextArea;function textarea(param){return tui.ctrl.control(param,TextArea)}ctrl.textarea=textarea;tui.ctrl.registerInitCallback(TextArea.CLASS,textarea)})(ctrl=tui.ctrl||(tui.ctrl={}))})(tui||(tui={}));var tui;(function(a){var b;(function(e){var c=(function(g){__extends(f,g);function f(m){g.call(this,"div",f.CLASS,m);this._tabId="tab-"+a.uuid();this._buttons=[];var j=this;var o=[];var h=0;for(var l=0;l<this[0].childNodes.length;l++){var n=this[0].childNodes[l];if(n.nodeName.toLowerCase()==="span"||n.nodeName.toLowerCase()==="a"){$(n).addClass("tui-radiobox");var k=a.ctrl.radiobox(n);k.group(this._tabId);this._buttons.push(k);if(k.checked()){h=this._buttons.length-1}k.on("check",function(i){j.checkPage(i.ctrl)})}else{o.push(n)}}this.at(h).checked(true)}f.prototype.checkPage=function(i){var h=i.attr("data-tab");h="#"+h;if(i.checked()){$(h).removeClass("tui-hidden");a.ctrl.initCtrls($(h)[0])}else{$(h).addClass("tui-hidden")}this.fire("active",{index:this._buttons.indexOf(i),text:i.text()})};f.prototype.at=function(h){if(h>=0&&h<this._buttons.length){return this._buttons[h]}else{return null}};f.prototype.count=function(){return this._buttons.length};f.prototype.add=function(j,i){var h=this;if(typeof i==="number"){if(i>=this._buttons.length){return null}}var k;if(typeof j==="string"){k=a.ctrl.radiobox();k.text(j)}else{if(typeof j==="object"){k=j}}k.group(this._tabId);k.on("check",function(l){h.checkPage(l.ctrl)});if(typeof i===a.undef){this[0].appendChild(k[0]);this._buttons.push(k)}else{this[0].insertBefore(k[0],this.at(i)[0]);this._buttons.splice(i,0,k)}return k};f.prototype.remove=function(i){if(typeof i==="object"){i=this._buttons.indexOf(i)}var j=this.at(i);if(j){var h=-1;if(j.checked()){h=i}this._buttons.splice(i,1);a.removeNode(j[0]);if(h>=0){if(h<this._buttons.length){this.active(h)}else{if(this._buttons.length>0){this.active(this._buttons.length-1)}}}return j}return null};f.prototype.active=function(h){if(typeof h!==a.undef){if(typeof h==="object"){h=this._buttons.indexOf(h)}var k=this.at(h);if(k){k.checked(true);this.checkPage(k)}return this}else{for(var j=0;j<this._buttons.length;j++){if(this._buttons[j].checked()){return j}}return -1}};f.CLASS="tui-tab";return f})(e.Control);e.Tab=c;function d(f){return a.ctrl.control(f,c)}e.tab=d;a.ctrl.registerInitCallback(c.CLASS,d)})(b=a.ctrl||(a.ctrl={}))})(tui||(tui={}));var tui;(function(a){var b;(function(c){var e=(function(f){__extends(g,f);function g(h){f.call(this,"div",g.CLASS,h);if(!this.hasAttr("data-max-buttons")){this.maxButtons(3)}if(!this.hasAttr("data-value")){this.value(1)}if(!this.hasAttr("data-page-size")){this.pageSize(10)}if(!this.hasAttr("data-total-size")){this.totalSize(0)}this.refresh()}g.prototype.value=function(h){if(typeof h!==a.undef){if(typeof h==="number"){if(h>this.totalPages()){h=this.totalPages()}if(h<1){h=1}this.attr("data-value",h);this.refresh()}return this}else{return Math.round(parseInt(this.attr("data-value")))}};g.prototype.totalPages=function(){var h=Math.ceil(this.totalSize()/this.pageSize());if(h<1){h=1}return h};g.prototype.pageSize=function(h){if(typeof h!==a.undef){if(typeof h==="number"){if(h<=0){h=1}this.attr("data-page-size",h);this.refresh()}return this}else{return Math.round(parseInt(this.attr("data-page-size")))}};g.prototype.totalSize=function(h){if(typeof h!==a.undef){if(typeof h==="number"){this.attr("data-total-size",h);this.refresh()}return this}else{return Math.round(parseInt(this.attr("data-total-size")))}};g.prototype.submitForm=function(h){if(typeof h==="string"){this.attr("data-submit-form",h);return this}else{return this.attr("data-submit-form")}};g.prototype.maxButtons=function(h){if(typeof h!==a.undef){if(typeof h==="number"){if(h<=0){h=1}this.attr("data-max-buttons",h);this.refresh()}return this}else{return Math.round(parseInt(this.attr("data-max-buttons")))}};g.prototype.changeValue=function(j){this.value(j);if(this.fire("change",{ctrl:this[0],value:this.value()})===false){return}var i=this.submitForm();if(i){var h=a.ctrl.form(i);h&&h.submit()}};g.prototype.refresh=function(){if(!this[0]){return}var q=this;this[0].innerHTML="";var n=c.button();n.text(a.str("Previous"));this[0].appendChild(n[0]);if(this.value()===1){n.disabled(true)}else{n.on("click",function(){q.changeValue(q.value()-1)})}var k=this.maxButtons();var o=this.totalPages();var p=this.value()-Math.floor(k/2)+(k%2===0?1:0);if(p<=1){p=1}var j=(p===1?p+k:p+k-1);if(j>=o){j=o;p=j-k;if(p<1){p=1}}if(p>1){var h=c.button();h.html(1+(p>2?" <i class='fa fa-ellipsis-h'></i>":""));this[0].appendChild(h[0]);h.on("click",function(){q.changeValue(1)})}for(var l=p;l<=j;l++){var h=c.button();h.text(l+"");h.on("click",function(){q.changeValue(parseInt(this.text()))});this[0].appendChild(h[0]);if(l===this.value()){h.addClass("tui-primary")}}if(j<o){var h=c.button();h.html((j<o-1?"<i class='fa fa-ellipsis-h'></i> ":"")+o);this[0].appendChild(h[0]);h.on("click",function(){q.changeValue(o)})}var m=c.button();m.text(a.str("Next"));this[0].appendChild(m[0]);if(this.value()===this.totalPages()){m.disabled(true)}else{m.on("click",function(){q.changeValue(q.value()+1)})}};g.CLASS="tui-paginator";return g})(c.Control);c.Paginator=e;function d(f){return a.ctrl.control(f,e)}c.paginator=d;a.ctrl.registerInitCallback(e.CLASS,d)})(b=a.ctrl||(a.ctrl={}))})(tui||(tui={}));var tui;(function(a){var b;(function(d){var e=(function(f){__extends(g,f);function g(i){var j=this;f.call(this,"div",g.CLASS,i);this._closeButton=null;var h=document.createElement("span");this._closeButton=h;h.className="tui-tips-close";this[0].appendChild(h);$(h).click(function(k){j.close()})}g.prototype.useVisible=function(h){if(typeof h!==a.undef){this.is("data-use-visible",!!h);return this}else{return this.is("data-use-visible")}};g.prototype.autoCloseTime=function(h){if(typeof h==="number"){if(isNaN(h)||h<=0){this.removeAttr("data-auto-close-time")}else{this.attr("data-auto-close-time",Math.floor(h))}return this}else{h=parseInt(this.attr("data-auto-close-time"));if(isNaN(h)){return null}else{if(h<=0){return null}else{return h}}}};g.prototype.show=function(h){var i=this;if(typeof h!==a.undef){a.removeNode(this._closeButton);this[0].innerHTML=h;this[0].appendChild(this._closeButton)}this.removeClass("tui-invisible");this.removeClass("tui-hidden");this[0].style.opacity="0";$(this[0]).animate({opacity:1},100,function(){var j=i.autoCloseTime();if(j!==null){setTimeout(function(){i.close()},j)}})};g.prototype.close=function(){var h=this;this.fire("close",{ctrl:this[0]});$(this[0]).animate({opacity:0},300,function(){if(h.useVisible()){h.addClass("tui-invisible")}else{h.addClass("tui-hidden")}})};g.CLASS="tui-tips";return g})(d.Control);d.Tips=e;function c(f){return a.ctrl.control(f,e)}d.tips=c;a.ctrl.registerInitCallback(e.CLASS,c)})(b=a.ctrl||(a.ctrl={}))})(tui||(tui={}));var tui;(function(a){var b;(function(g){function e(h){if(h&&h.window&&h.document||h.nodeName.toLowerCase()==="#document"||h.nodeName.toLowerCase()==="body"||h.nodeName.toLowerCase()==="html"){if(h.window&&h.document){return h}else{if(h.nodeName.toLowerCase()==="#document"){return h.defaultView||h.parentWindow}else{return a.getWindow(h)}}}else{return h}}function d(h){if(h&&h.document){if(a.ieVer>0||a.ffVer>0){return h.document.documentElement}else{return h.document.body}}else{return h}}var c=(function(i){__extends(h,i);function h(j){var k=this;i.call(this,"div",h.CLASS,j);this._accordions=[];this._anchors=[];this._monitoredParent=null;this._inScrolling=false;this._onScroll=(function(){var l=k;var m=null;return function(q){if(l._monitoredParent===null){return}if(l._inScrolling){return}var o=d(l._monitoredParent);for(var n=0;n<l._anchors.length;n++){var r=l._anchors[n];var p=document.getElementById(r);if(!p){continue}var s=a.relativePosition(p,o);if(Math.abs(s.y-o.scrollTop-l.distance())<=100){if(m!=null){clearTimeout(m);m=null}m=setTimeout(function(){l.value("#"+p.id)},50);break}}}})();this._onSelect=(function(){var l=k;return function(o){if(l.fire("select",o)!==false){if(l.keyIsLink()){if(o.key&&o.key.slice(0,1)==="#"){var p=o.key.substr(1);var n=document.getElementById(p);if(n){var m=d(l._monitoredParent);var q=a.relativePosition(n,m);l._inScrolling=true;$(m).stop().animate({scrollTop:q.y-l.distance()},200,function(){window.location.href=o.key;m.scrollTop=q.y-l.distance();l._inScrolling=false})}else{window.location.href=o.key}}else{window.location.href=o.key}}}}})();if(this.hasAttr("data-max-height")){this.maxHeight(this.maxHeight())}this.bindChildEvents()}h.prototype.distance=function(k){if(typeof k==="number"){this.attr("data-distance",k);return this}else{var j=this.attr("data-distance");j=parseInt(this.attr("data-distance"));if(isNaN(j)){return 50}else{return j}}};h.prototype.maxHeight=function(m){if(typeof m==="number"){this.attr("data-max-height",m);var l=0;for(var j=0;j<this[0].childNodes.length;j++){var k=this[0].childNodes[j];if($(k).hasClass("tui-accordion")){var n=g.accordion(k);l+=n.captionHeight()}else{if(k.tagName){l+=$(k).outerHeight()}}}$(this[0]).find(".tui-accordion").each(function(o,p){if(p._ctrl){p._ctrl.maxHeight(m-l+p._ctrl.captionHeight());p._ctrl.refresh()}});return this}else{return parseInt(this.attr("data-max-height"))}};h.prototype.value=function(j){if(typeof j!==a.undef){$(this[0]).find(".tui-accordion").each(function(l,m){if(m._ctrl){m._ctrl.value(j);if(m._ctrl.value()!==null){return false}}})}else{var k=null;$(this[0]).find(".tui-accordion").each(function(l,m){if(m._ctrl){k=m._ctrl.value();if(k!==null){return false}}});return k}};h.prototype.installMonitor=function(j){if(typeof j==="string"){j=document.getElementById(j)}this._monitoredParent=e(j);if(this._monitoredParent){$(this._monitoredParent).scroll(this._onScroll)}};h.prototype.uninstallMonitor=function(){if(this._monitoredParent){$(this._monitoredParent).off("scroll",this._onScroll)}this._monitoredParent=null};h.prototype.keyIsLink=function(j){if(typeof j!==a.undef){this.is("data-key-is-link",!!j);return this}else{return this.is("data-key-is-link")}};h.prototype.addAccordion=function(j){this[0].appendChild(j[0]);this.bindChildEvents()};h.prototype.clear=function(){this[0].innerHTML="";this.bindChildEvents()};h.prototype.bindChildEvents=function(){for(var k in this._accordions){if(this._accordions.hasOwnProperty(k)){this._accordions[k].off("select",this._onSelect)}}this._accordions=[];this._anchors=[];var j=this;$(this[0]).find(".tui-accordion").each(function(l,m){if(typeof m._ctrl===a.undef){g.accordion(m)}if(m._ctrl){j._accordions.push(m._ctrl);m._ctrl.on("select",j._onSelect);if(j.keyIsLink()){m._ctrl.enumerate(function(n){if(n.key&&n.key.slice(0,1)==="#"){j._anchors.push(n.key.substr(1))}})}}})};h.prototype.refresh=function(){for(var j in this._accordions){if(this._accordions.hasOwnProperty(j)){this._accordions[j].refresh()}}};h.CLASS="tui-accordion-group";return h})(g.Control);g.AccordionGroup=c;function f(h){return a.ctrl.control(h,c)}g.accordionGroup=f;a.ctrl.registerInitCallback(c.CLASS,f)})(b=a.ctrl||(a.ctrl={}))})(tui||(tui={}));var tui;(function(tui){var ctrl;(function(_ctrl){var Accordion=(function(_super){__extends(Accordion,_super);function Accordion(el){var _this=this;_super.call(this,"div",Accordion.CLASS,el);this._caption=null;this._list=null;this._initialized=false;this[0].innerHTML="";this._caption=document.createElement("div");this._caption.className="tui-accordion-caption";this._caption.setAttribute("unselectable","on");this[0].appendChild(this._caption);this._list=tui.ctrl.list();this[0].appendChild(this._list[0]);var predefined=this.attr("data-data");if(predefined){predefined=eval("("+predefined+")")}$(this._caption).click(function(){_this.expanded(!_this.expanded())});$(this._caption).keydown(function(e){if(e.keyCode===13){_this.expanded(!_this.expanded())}});var self=this;this._list.on("rowclick keydown",function(data){if(data.name==="rowclick"){self.value(self._list.data().at(data.index)["key"]);var k=self.value();if(k){self.fire("select",{ctrl:self[0],key:k,caption:self.caption()})}}else{if(data.event.keyCode===13){self.value(self._list.activeItem().key);var k=self.value();if(k){self.fire("select",{ctrl:self[0],key:k,caption:self.caption()})}}}});this._list.on("rowexpand rowfold",function(data){self._list.activerow(null);data.event.stopPropagation();self.refresh()});var originFormator=this._list.columns()[0].format;this._list.columns()[0].format=function(data){originFormator(data);if(typeof data.row.checked===tui.undef){return}var contentSpan=data.cell.firstChild;var checkSpan=contentSpan.childNodes[2];contentSpan.removeChild(checkSpan);if(data.row.checked){$(data.cell.parentElement).addClass("tui-accordion-row-checked")}else{$(data.cell.parentElement).removeClass("tui-accordion-row-checked")}};var animation=this.useAnimation();this.useAnimation(false);if(predefined){this.data(predefined);var checkedItems=this._list.checkedItems();if(checkedItems&&checkedItems.length>0){var k=this._list.data().mapKey("key");this.value(checkedItems[0][k]);k=self.value();if(k){self.fire("select",{ctrl:self[0],key:k,caption:self.caption()})}}else{this.expanded(this.expanded())}}else{this.expanded(this.expanded())}this.useAnimation(animation)}Accordion.prototype.data=function(data){if(typeof data!==tui.undef){this._list.data(data);this.refresh();return this}else{return this._list.data(data)}};Accordion.prototype.caption=function(val){if(typeof val==="string"){this.attr("data-caption",val);this._caption.innerHTML=val||"";this.refresh();return this}else{return this.attr("data-caption")}};Accordion.prototype.captionHeight=function(){return $(this._caption).outerHeight()};Accordion.prototype.expanded=function(val){if(typeof val==="boolean"){this.is("data-expanded",val);if(this.expanded()){var groupName=this.group();if(groupName){var self=this;$("."+Accordion.CLASS+"[data-group='"+groupName+"']").each(function(index,elem){var ctrl=elem._ctrl;if(ctrl&&ctrl!==self&&typeof ctrl.expanded==="function"){ctrl.expanded(false)}})}}this.refresh();return this}else{return this.is("data-expanded")}};Accordion.prototype.maxHeight=function(maxHeight){if(typeof maxHeight==="number"){this.attr("data-max-height",maxHeight);return this}else{return parseInt(this.attr("data-max-height"))}};Accordion.prototype.group=function(val){if(typeof val!==tui.undef){this.attr("data-group",val);return this}else{return this.attr("data-group")}};Accordion.prototype.value=function(key){if(typeof key!==tui.undef){this._list.value([key]);this._list.activerow(null);if(this._list.value().length>0){this._list.activeRowByKey(key);this.expanded(true);this._list.scrollTo(this._list.activerow());var groupName=this.group();if(groupName){var self=this;$("."+Accordion.CLASS+"[data-group='"+groupName+"']").each(function(index,elem){var ctrl=elem._ctrl;if(ctrl&&ctrl!==self&&typeof ctrl.value==="function"){ctrl.value(null)}})}}return this}else{var val=this._list.value();if(val===null){return val}else{if(val.length>0){return val[0]}else{return null}}}};Accordion.prototype.autoRefresh=function(){return !this._initialized};Accordion.prototype.enumerate=function(func){if(this._list){this._list.enumerate(func)}};Accordion.prototype.consumeMouseWheelEvent=function(val){return this._list.consumeMouseWheelEvent(val)};Accordion.prototype.useAnimation=function(val){if(typeof val==="boolean"){this.is("data-anmimation",val);return this}else{return this.is("data-anmimation")}};Accordion.prototype.refresh=function(){var _this=this;if(!this[0]||this[0].offsetWidth===0||this[0].offsetHeight===0){return}this._initialized=true;var captionHeight;if(!this.expanded()){this._caption.setAttribute("tabIndex","0");$(this._caption).removeClass("tui-expanded");captionHeight=this._caption.offsetHeight;$(this._caption).addClass("tui-expanded");if(this.useAnimation()){$(this[0]).stop().animate({height:captionHeight+"px"},Accordion.ANIMATION_DURATION,"linear",function(){$(_this._caption).removeClass("tui-expanded");_this._list[0].style.display="none"})}else{$(this[0]).stop();this[0].style.height=captionHeight+"px";$(this._caption).removeClass("tui-expanded");this._list[0].style.display="none"}}else{this._caption.removeAttribute("tabIndex");$(this._caption).addClass("tui-expanded");this._list[0].style.display="";captionHeight=this._caption.offsetHeight;var maxHeight=this.maxHeight();var lines=1;if(this._list.data()){lines=this._list.data().length()}if(lines<1){lines=1}var height=this._list.lineHeight()*lines+4;if(!isNaN(maxHeight)&&height>maxHeight-captionHeight){height=maxHeight-captionHeight}this._list[0].style.height=height+"px";this._list[0].style.width=$(this[0]).width()+"px";this._list.refresh();if(this.useAnimation()){$(this[0]).stop().animate({height:height+captionHeight+"px"},Accordion.ANIMATION_DURATION,"linear",function(){$(_this._caption).addClass("tui-expanded");_this._list[0].style.display="";_this._list.focus()})}else{$(this[0]).stop();this[0].style.height=height+captionHeight+"px";$(this._caption).addClass("tui-expanded");this._list[0].style.display="";this._list.focus()}}};Accordion.CLASS="tui-accordion";Accordion.ANIMATION_DURATION=200;return Accordion})(_ctrl.Control);_ctrl.Accordion=Accordion;function accordion(param){return tui.ctrl.control(param,Accordion)}_ctrl.accordion=accordion;tui.ctrl.registerInitCallback(Accordion.CLASS,accordion)})(ctrl=tui.ctrl||(tui.ctrl={}))})(tui||(tui={}));var tui;(function(a){var b;(function(d){var c=(function(g){__extends(f,g);function f(i){g.call(this);this._items=[];this._menuDiv=null;this._parentMenu=null;if(i instanceof Array||i.data&&i.data instanceof Array){i=new a.ArrayProvider(i)}else{if(typeof i==="function"||typeof i.length!=="function"||typeof i.sort!=="function"||typeof i.at!=="function"||typeof i.columnKeyMap!=="function"){throw new Error("TUI Menu: need a data provider.")}}this._data=i;var h=this;this.on("close",function(){h._items=[];delete h._activedItem})}f.prototype.fireClick=function(h,i){if(h._showChildTimer){clearTimeout(h._showChildTimer)}if(h._childMenu&&(typeof i.key===a.undef||i.key===null)){h._childMenu.show(h.firstChild,"rT")}else{this.closeAll();if(this.fire("select",{ctrl:self[0],item:i})===false){return}if(typeof i.key!==a.undef&&i.key!==null){if(a.fire(i.key,i)===false){return}}if(i.link){window.location.href=i.link}}};f.prototype.bindMouseEvent=function(i,j){var h=this;$(i).mousemove(function(k){if(i._menuIndex!==h._activedItem){h.deactiveItem(h._activedItem);$(i).addClass("tui-actived");h._activedItem=i._menuIndex;if(i._childMenu){i._showChildTimer=setTimeout(function(){i._childMenu.show(i.firstChild,"rT")},400)}}});$(i).mouseleave(function(k){if(!a.isAncestry(document.activeElement,h._menuDiv)){return}if(i._showChildTimer){clearTimeout(i._showChildTimer)}$(i).removeClass("tui-actived");delete h._activedItem});$(i).click(function(k){h.fireClick(i,j)})};f.prototype.deactiveItem=function(h){if(h>=0&&h<this._items.length){var i=this._items[h];$(i).removeClass("tui-actived");if(i._childMenu){i._childMenu.close()}if(i._showChildTimer){clearTimeout(i._showChildTimer)}}};f.prototype.setParentMenu=function(h){this._parentMenu=h};f.prototype.closeAll=function(){if(this._parentMenu){this._parentMenu.closeAll()}else{this.close()}};f.prototype.focus=function(){this._menuDiv.focus()};f.prototype.show=function(j,m){if(this.isShowing()){return}if(!this._data){return}var r=this;var k;if(typeof this._data==="function"){k=this._data();if(typeof k.length!=="function"||typeof k.sort!=="function"||typeof k.at!=="function"||typeof k.columnKeyMap!=="function"){return}}else{k=this._data}var h=document.createElement("div");this._menuDiv=h;h.className=f.CLASS;$(h).attr("unselectable","on");$(h).attr("tabIndex","-1");for(var l=0;l<k.length();l++){var s=k.at(l);var q=document.createElement("div");if(s.value==="-"){q.className="tui-menu-line"}else{var n=document.createElement("div");q.appendChild(n);n.innerHTML=s.value;var o=document.createElement("i");o.className="tui-menu-icon";n.insertBefore(o,n.firstChild);if(s.checked){$(o).addClass("tui-menu-icon-checked")}else{if(s.icon){$(o).addClass(s.icon)}}if(s.children){$(q).addClass("tui-menu-has-children");var p=e(s.children);p.on("select",function(i){r.fire("select",i)});p.setParentMenu(this);q._childMenu=p}this.bindMouseEvent(q,s);q._menuIndex=this._items.length;this._items.push(q)}h.appendChild(q)}$(h).keydown(function(t){var v=t.keyCode;if(v===a.KEY_DOWN||v===a.KEY_TAB){if(typeof r._activedItem!=="number"&&r._items.length>0){r._activedItem=0}else{$(r._items[r._activedItem]).removeClass("tui-actived");r._activedItem++;if(r._activedItem>r._items.length-1){r._activedItem=0}}if(typeof r._activedItem==="number"&&r._activedItem>=0&&r._activedItem<r._items.length){$(r._items[r._activedItem]).addClass("tui-actived")}t.stopPropagation();t.preventDefault()}else{if(v===a.KEY_UP){if(typeof r._activedItem!=="number"&&r._items.length>0){r._activedItem=r._items.length-1}else{$(r._items[r._activedItem]).removeClass("tui-actived");r._activedItem--;if(r._activedItem<0){r._activedItem=r._items.length-1}}if(typeof r._activedItem==="number"&&r._activedItem>=0&&r._activedItem<r._items.length){$(r._items[r._activedItem]).addClass("tui-actived")}t.stopPropagation();t.preventDefault()}else{if(v===a.KEY_ESC){r.close();t.stopPropagation();t.preventDefault()}else{if(v===a.KEY_LEFT){if(r._parentMenu){r.close();r._parentMenu.focus()}}else{if(v===a.KEY_RIGHT){if(typeof r._activedItem==="number"&&r._activedItem>=0&&r._activedItem<r._items.length){var i=r._items[r._activedItem];if(i._childMenu){i._childMenu.show(i.firstChild,"rT")}}}else{if(v===a.KEY_ENTER){if(typeof r._activedItem==="number"&&r._activedItem>=0&&r._activedItem<r._items.length){var i=r._items[r._activedItem];var u=k.at(r._activedItem);r.fireClick(i,u)}}}}}}}});g.prototype.show.call(this,h,j,m);h.focus()};f.CLASS="tui-menu";return f})(d.Popup);d.Menu=c;function e(f){return new c(f)}d.menu=e})(b=a.ctrl||(a.ctrl={}))})(tui||(tui={}));var tui;(function(a){var b;(function(e){var c=(function(g){__extends(f,g);function f(h){var i=this;g.call(this,"div",f.CLASS,h);this._float=false;this._onScroll=(function(){var j=i;return function(k){var l;if(j._float===false){l=a.fixedPosition(j[0]);j[0].style.left=""}else{l=a.fixedPosition(j[1]);j[0].style.left=(-a.windowScrollElement().scrollLeft)+"px"}if(l.y<j.top()&&j._float===false){j._float=true;j[1].style.height=j[0].offsetHeight+"px";j[0].style.position="fixed";j[0].style.left=(-a.windowScrollElement().scrollLeft)+"px";j[0].style.right="0px";j[0].style.top=j.top()+"px";document.body.insertBefore(j[1],j[0])}else{if(l.y>=j.top()&&j._float===true){j._float=false;j[0].style.position="";j[0].style.top="";j[0].style.left="";j[1].style.height="";a.removeNode(j[1])}}}})();this[1]=document.createElement("div");this.installMonitor();this._onScroll(null)}f.prototype.installMonitor=function(){$(window).scroll(this._onScroll)};f.prototype.uninstallMonitor=function(){$(window).off("scroll",this._onScroll)};f.prototype.top=function(h){if(typeof h==="string"){this.attr("data-top",h);return this}else{h=parseInt(this.attr("data-top"));if(isNaN(h)){return 0}else{return h}}};f.CLASS="tui-navbar";return f})(e.Control);e.Navbar=c;function d(f){return a.ctrl.control(f,c)}e.navbar=d;a.ctrl.registerInitCallback(c.CLASS,d)})(b=a.ctrl||(a.ctrl={}))})(tui||(tui={}));